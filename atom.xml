<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>wzmyyj</title>
  
  <subtitle>Let life be beautiful like summer flowers.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://wzmyyj.top/"/>
  <updated>2020-07-21T05:00:26.681Z</updated>
  <id>https://wzmyyj.top/</id>
  
  <author>
    <name>wzmyyj</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>IMä¸­ç¾¤æ¶ˆæ¯å‘é€è€…ä¿¡æ¯åˆ·æ–°æ–¹æ¡ˆ</title>
    <link href="https://wzmyyj.top/2020/07/21/android_10/"/>
    <id>https://wzmyyj.top/2020/07/21/android_10/</id>
    <published>2020-07-21T11:20:30.000Z</published>
    <updated>2020-07-21T05:00:26.681Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>åœ¨IMé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼ŒèŠå¤©é¡µé¢ï¼Œè¿›å…¥ä¼šå±•ç¤ºå†å²æ¶ˆæ¯ï¼Œè€Œå†å²æ¶ˆæ¯å­˜ä¸‹æ¥çš„å‘é€è€…ä¿¡æ¯å¯èƒ½å¹¶ä¸æ˜¯æœ€æ–°çš„ï¼Œæ‰€ä»¥éœ€è¦å»åˆ·æ–°æ•°æ®ã€‚å•èŠåœºæ™¯åªéœ€è¦åˆ·æ–°å¯¹æ–¹ä¸€ä¸ªäººä¿¡æ¯ï¼Œå®ç°è¾ƒä¸ºç®€å•ã€‚ä½†æ˜¯åˆ°ç¾¤èŠï¼Œå‘é€è€…ä¼—å¤šï¼Œä¸å¯èƒ½æ¯æ¬¡è¿›å…¥é¡µé¢éƒ½å»è·å–å…¨éƒ¨æˆå‘˜çš„ä¿¡æ¯ï¼ˆæ•°é‡å¤§ï¼Œè·å–ç¼“æ…¢ï¼‰ï¼Œæ‰€ä»¥éœ€è¦åˆ¶å®šç­–ç•¥å»å®ç°å¥½çš„æ•ˆæœã€‚</p><a id="more"></a><h3 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h3><p><strong>æœŸæœ›ï¼š</strong></p><ol><li>åªå»åˆ·æ–°æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å‘é€è€…ä¿¡æ¯ã€‚</li><li>æ¯ä¸ªå‘é€è€…åªéœ€è¦åˆ·æ–°ä¸€æ¬¡ã€‚ï¼ˆåšä¸ªç¼“å­˜ï¼‰</li><li>å±å¹•æ»šåŠ¨å¾ˆå¿«ï¼Œä¸­é€”æ˜¾ç¤ºçš„ä¸å»åˆ·æ–°ã€‚</li><li>å¦‚æœå…¶ä»–åœ°æ–¹ç¼“å­˜è¿‡äº†è¿™ä¸ªæˆå‘˜ï¼Œå°±ä¸å†å»è·å–ã€‚</li><li>ç¾¤æˆå‘˜ä¿¡æ¯ä¿®æ”¹ï¼ŒåŠæ—¶åˆ·æ–°ç¼“å­˜æ•°æ®ã€‚</li></ol><h3 id="æ–¹æ¡ˆè®¾è®¡"><a href="#æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="æ–¹æ¡ˆè®¾è®¡"></a>æ–¹æ¡ˆè®¾è®¡</h3><p><strong>è®¾è®¡ï¼š</strong></p><ol><li>åœ¨recyclerçš„onBindVHé‡Œæ”¶é›†æ¶ˆæ¯åˆ—è¡¨é‡Œçš„å‘é€è€…çš„IDï¼ˆimAccount)ã€‚</li><li>æ”¶é›†åˆ°æ•°æ®æ± ï¼ˆåªæ”¶é›†ä¸æ˜¯æœ€æ–°æ•°æ®çš„ï¼Œé˜²æ­¢åå¤æ”¶é›†ï¼‰ï¼Œå¯¹imAccountå»é‡ï¼Œå¤§å°ä¸º10ã€‚åˆ©ç”¨LRUçš„ç¼“å­˜æ·˜æ±°imAccountã€‚</li><li>é™ç½®0.5ç§’åå¼€å§‹å°†ç¼“å­˜æ± å†…å®¹å‘å°„è¯·æ±‚ã€‚ï¼ˆå³å±å¹•åœæ­¢äº†æ»‘åŠ¨ï¼Œæˆ–æ»‘åŠ¨æ²¡æ—¶æ–°çš„itemæ·»åŠ åˆ°å±å¹•ï¼‰ã€‚</li><li>æ¯ä¸ªimAccountå¯¹åº”ä¸€ä¸ªé”å¯¹è±¡ï¼Œä¿è¯å¼‚æ­¥ä¸‹åŒä¸€ä¸ªimAccountåªä¼šè¯·æ±‚ä¸€æ¬¡ã€‚</li><li>ç»“åˆç¾¤æˆå‘˜ä¿¡æ¯åšç¼“å­˜ã€‚ï¼ˆç¾¤æˆå‘˜ç¼“å­˜è·å–è¿‡äº†ï¼Œå¦‚è¿›è¿‡ç¾¤æˆå‘˜é¡µç­‰ï¼Œ å°±ä¸å†å»è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜é‡Œçš„æ•°æ®ï¼‰</li><li>åˆ·æ–°æˆåŠŸä¸€ä¸ªimAccountåˆ™ä¼šæŠŠæ•´ä¸ªåˆ—è¡¨é‡ŒåŒä¸€ä¸ªå‘é€è€…çš„ä¿¡æ¯éƒ½åˆ·æ–°æ‰ã€‚</li><li>æ•°æ®åˆ·æ–°æˆåŠŸï¼Œå›è°ƒåˆ·æ–°UIåˆ—è¡¨ã€‚éœ€è¦ç»‘å®šèŠå¤©é¡µé¢ç”Ÿå‘½å‘¨æœŸã€‚</li><li>æ”¶åˆ°ç¾¤æˆå‘˜ä¿¡æ¯ä¿®æ”¹é€šçŸ¥æ¶ˆæ¯ï¼Œä¿®æ”¹ç¼“å­˜æ•°æ®ã€‚</li></ol><p><strong>æµç¨‹å›¾ï¼š</strong><br><img src="https://upload-images.jianshu.io/upload_images/3262738-a0012923f3cec79f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240/format/webp" alt="Sanderæµç¨‹å›¾.jpg"></p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>è¯¥éƒ¨åˆ†åŠŸèƒ½éœ€è¦ç»“åˆæˆå‘˜ç¼“å­˜åŠŸèƒ½ã€‚è¯·çœ‹ï¼š<a href="https://www.jianshu.com/p/4571d9b01b95" target="_blank" rel="noopener">IMé¡¹ç›®ä¸­ç¾¤æˆå‘˜è·å–ä¸ç¼“å­˜ç­–ç•¥</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SenderHelper</span> <span class="keyword">private</span> <span class="keyword">constructor</span></span>() : DefaultLifecycleObserver &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> const <span class="keyword">val</span> CACHE_MAX_SIZE = <span class="number">10</span></span><br><span class="line">        <span class="keyword">private</span> const <span class="keyword">val</span> COUNT_DOWN_DELAY = <span class="number">500</span>L</span><br><span class="line">        <span class="comment">// ä¿è¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> map = WeakHashMap&lt;LifecycleOwner, SenderHelper&gt;()</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">with</span><span class="params">(owner: <span class="type">LifecycleOwner</span>, observer: <span class="type">Observer</span>&lt;<span class="type">List</span>&lt;<span class="type">String</span>&gt;&gt;)</span></span>: SenderHelper &#123;</span><br><span class="line">            <span class="keyword">return</span> map[owner] ?: SenderHelper().apply &#123;</span><br><span class="line">                map[owner] = <span class="keyword">this</span></span><br><span class="line">                with(owner, observer)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(owner: <span class="type">LifecycleOwner</span>)</span></span>: SenderHelper? &#123;</span><br><span class="line">            <span class="keyword">return</span> map[owner]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(sessionId: <span class="type">String</span>)</span></span>: SenderHelper? &#123;</span><br><span class="line">            <span class="keyword">return</span> map.values.find &#123; it.sessionId == sessionId &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›è°ƒçš„ liveDataã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> liveData = MutableLiveData&lt;List&lt;String&gt;&gt;()</span><br><span class="line">    <span class="comment">// rxã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> compositeDisposable = CompositeDisposable()</span><br><span class="line">    <span class="comment">// å…¥å‚ç¼“å­˜æ± ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> cache = LruCache&lt;String, <span class="built_in">Unit</span>&gt;(CACHE_MAX_SIZE)</span><br><span class="line">    <span class="comment">// ç»“æœåˆ—è¡¨ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> resultList = CopyOnWriteArrayList&lt;String&gt;()</span><br><span class="line">    <span class="comment">// é”å¯¹è±¡ mapã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> lockMap = ConcurrentHashMap&lt;String, Lock&gt;()</span><br><span class="line">    <span class="comment">// dataã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> groupCode: String = <span class="string">""</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> sessionId: String = <span class="string">""</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> dataList: (<span class="built_in">Unit</span>) -&gt; List&lt;SenderModel&gt;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> memberSet <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        MemberHelper.getIfAbsent(groupCode)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> handler = Handler()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> runnable = Runnable &#123;</span><br><span class="line">        cache.snapshot().keys.apply &#123;</span><br><span class="line">            forEach &#123; k -&gt; cache.remove(k) &#125;</span><br><span class="line">            task(<span class="keyword">this</span>.toList())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">init</span><span class="params">(sessionId: <span class="type">String</span>, groupCode: <span class="type">String</span>, dataList: (<span class="type">Unit</span>)</span></span> -&gt; List&lt;SenderModel&gt;) &#123;</span><br><span class="line">        <span class="keyword">this</span>.sessionId = sessionId</span><br><span class="line">        <span class="keyword">this</span>.groupCode = groupCode</span><br><span class="line">        <span class="keyword">this</span>.dataList = dataList</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æœ€æ–°æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">bind</span><span class="params">(sender: <span class="type">SenderModel</span>)</span></span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯è‡ªå·±ï¼Œç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (sender.isSelf || sender.imAccount.isEmpty()) <span class="keyword">return</span></span><br><span class="line">        <span class="comment">// å¦‚æœæœ€æ–°ï¼Œç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">        memberSet.<span class="keyword">get</span>(sender.imAccount)?.let &#123;</span><br><span class="line">            <span class="keyword">if</span> (compare(sender, it).falseRun &#123; changeListAndPost(it) &#125;) <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å­˜å…¥ç¼“å­˜æ± ã€‚</span></span><br><span class="line">        cache.<span class="keyword">get</span>(sender.imAccount) ?: cache.put(sender.imAccount, <span class="built_in">Unit</span>)</span><br><span class="line">        countDown()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»åŠ¨åˆ·æ–°åç§°ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">updateNickname</span><span class="params">(imAccount: <span class="type">String</span>, nickname: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        memberSet.<span class="keyword">get</span>(imAccount)?.let &#123;</span><br><span class="line">            it.nickName = nickname</span><br><span class="line">            changeListAndPost(it)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»åŠ¨åˆ·æ–°èº«ä»½ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">updateGroupRole</span><span class="params">(imAccount: <span class="type">String</span>, groupRole: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        memberSet.<span class="keyword">get</span>(imAccount)?.let &#123;</span><br><span class="line">            it.groupRole = groupRole</span><br><span class="line">            changeListAndPost(it)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">(owner: <span class="type">LifecycleOwner</span>)</span></span> &#123;</span><br><span class="line">        compositeDisposable.clear()</span><br><span class="line">        handler.removeCallbacksAndMessages(<span class="literal">null</span>)</span><br><span class="line">        map.remove(owner)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//---------private method-----------//</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šç”Ÿå‘½å‘¨æœŸå’Œè§‚å¯Ÿã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">with</span><span class="params">(owner: <span class="type">LifecycleOwner</span>, observer: <span class="type">Observer</span>&lt;<span class="type">List</span>&lt;<span class="type">String</span>&gt;&gt;)</span></span> &#123;</span><br><span class="line">        owner.lifecycle.addObserver(<span class="keyword">this</span>)</span><br><span class="line">        liveData.observe(owner, observer)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å»¶æ—¶è®¡æ—¶ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">countDown</span><span class="params">()</span></span> &#123;</span><br><span class="line">        handler.removeCallbacksAndMessages(<span class="literal">null</span>)</span><br><span class="line">        handler.postDelayed(runnable, COUNT_DOWN_DELAY)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">task</span><span class="params">(imAccountList: <span class="type">List</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">        Observable</span><br><span class="line">                .fromIterable(imAccountList)</span><br><span class="line">                .flatMap &#123; work(it) &#125;</span><br><span class="line">                .doFinally &#123;</span><br><span class="line">                    <span class="keyword">if</span> (resultList.isNotEmpty()) &#123;</span><br><span class="line">                        liveData.postValue(ArrayList(resultList))</span><br><span class="line">                        resultList.clear()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .subscribe(&#123;&#125;, &#123;&#125;)</span><br><span class="line">                .addToComposite()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å·¥ä½œã€‚å„è‡ªå¼€è¾Ÿå­çº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">work</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: Observable&lt;*&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> Observable.just(imAccount)</span><br><span class="line">                .subscribeOn(Schedulers.io())</span><br><span class="line">                .flatMap &#123;</span><br><span class="line">                    synchronized(getLock(it).lock) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (memberSet.<span class="keyword">get</span>(it) == <span class="literal">null</span>) &#123;</span><br><span class="line">                            netWork(it)</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            Observable.just(it)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç½‘ç»œæ“ä½œã€‚ä¸å·¥ä½œåŒä¸€ä¸ªçº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">netWork</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: Observable&lt;*&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> MemberHelper</span><br><span class="line">                .loadMember(sessionId, imAccount)</span><br><span class="line">                .filter &#123; it.status &amp;&amp; it.entry != <span class="literal">null</span> &#125;</span><br><span class="line">                .map &#123; it.entry!! &#125;</span><br><span class="line">                .doOnNext &#123;</span><br><span class="line">                    resultList.add(it.imAccount.orEmpty())</span><br><span class="line">                    memberSet.put(it)</span><br><span class="line">                    updateDb(it)</span><br><span class="line">                    changeList(it)</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ•°æ®åº“æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">updateDb</span><span class="params">(bean: <span class="type">MemberBean</span>)</span></span> &#123;</span><br><span class="line">        ...ä¿®æ”¹æ•°æ®åº“å®ç°ä¸é‡è¦...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ·æ´—æ•°æ®åŠå‘é€æ•°æ®å˜åŒ–ä¿¡å·ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">changeListAndPost</span><span class="params">(bean: <span class="type">MemberBean</span>)</span></span> &#123;</span><br><span class="line">        changeList(bean).trueRun &#123; liveData.postValue(arrayListOf(bean.imAccount.orEmpty())) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ·æ–°åˆ—è¡¨æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">changeList</span><span class="params">(bean: <span class="type">MemberBean</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> isChange: <span class="built_in">Boolean</span></span><br><span class="line">        dataList()</span><br><span class="line">                .filter &#123; it.imAccount == bean.imAccount &amp;&amp; compare(it, bean).not() &#125;</span><br><span class="line">                .apply &#123; isChange = <span class="keyword">this</span>.isNotEmpty() &#125;</span><br><span class="line">                .forEach &#123;</span><br><span class="line">                    it.nickName = bean.nickName.orEmpty()</span><br><span class="line">                    it.avatar = bean.avatar?.toLoadUrl().orEmpty()</span><br><span class="line">                    it.setGroupRole(bean.groupRole)</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="keyword">return</span> isChange</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯”è¾ƒæ˜¯å¦æœ€æ–°äº†ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">compare</span><span class="params">(sender: <span class="type">SenderModel</span>, bean: <span class="type">MemberBean</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (bean.groupRole == sender.groupRole</span><br><span class="line">                &amp;&amp; bean.nickName == sender.nickName</span><br><span class="line">                &amp;&amp; bean.avatar?.toLoadUrl() == sender.avatar)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Lock</span></span>(<span class="keyword">val</span> lock: Any = Any())</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é”å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getLock</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: Lock &#123;</span><br><span class="line">        <span class="keyword">return</span> lockMap[imAccount] ?: Lock().apply &#123; lockMap[imAccount] = <span class="keyword">this</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * add åˆ°å¤åˆä½“ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> Disposable.<span class="title">addToComposite</span><span class="params">()</span></span> &#123;</span><br><span class="line">        compositeDisposable.add(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ï¼š</strong></p><p>åˆå§‹åŒ–ï¼š<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">SenderHelper</span></span><br><span class="line">                <span class="selector-class">.with</span>(lifecyclerOwner, Observer &#123; <span class="selector-tag">updateList</span>() &#125;)</span><br><span class="line">                <span class="selector-class">.init</span>(sessionId, groupCode) &#123; <span class="selector-tag">getSenderList</span>() &#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨recyclerViewé€‚é…å™¨çš„onBindVHå¤„ï¼š<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">SenderHelper</span><span class="selector-class">.get</span>(<span class="selector-tag">lifecyclerOwner</span>)?<span class="selector-class">.bind</span>(<span class="selector-tag">sender</span>)</span><br></pre></td></tr></table></figure></p><p>æ”¶åˆ°æ¶ˆæ¯ä¸»åŠ¨åˆ·æ–°ç¼“å­˜ï¼š<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°åç§°ã€‚</span></span><br><span class="line">SenderHelper.<span class="built_in">get</span>(sessionId)?.updateNickname(imAccount,nickNameï¼‰</span><br><span class="line"><span class="comment">// æ›´æ–°èº«ä»½ã€‚</span></span><br><span class="line">SenderHelper.<span class="built_in">get</span>(sessionId)?.updateGroupRole(imAccount,groupRoleï¼‰</span><br></pre></td></tr></table></figure></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¦ç‚¹ï¼š</p><ol><li>æ”¶é›†æœ€æ–°è¿›å…¥çš„ imAccountï¼Œæœ€å¤š10ä¸ªã€‚</li><li>é™ç½® 0.5 ç§’ï¼Œå°†æ”¶é›†çš„æ•°æ®åˆ†åˆ«è¯·æ±‚ã€‚</li><li>åŒä¸€ä¸ª imAccount åªèƒ½è¯·æ±‚ä¸€æ¬¡ã€‚</li><li>ç»‘å®šç”Ÿå‘½å‘¨æœŸï¼Œä¸€å¯¹ä¸€å…³ç³»ã€‚</li><li>ä¸ç¾¤æˆå‘˜ç¼“å­˜ç»“åˆã€‚</li></ol><p><strong>PS</strong>ï¼šä»è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œå¯ä»¥æ‰©å±•åˆ°åˆ—è¡¨å†…å®¹å±€éƒ¨æ•°æ®è¯·æ±‚æ¥å£åˆ·æ–°çš„åœºæ™¯ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3262738-889937b6d17e2893.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h4&gt;&lt;p&gt;åœ¨IMé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼ŒèŠå¤©é¡µé¢ï¼Œè¿›å…¥ä¼šå±•ç¤ºå†å²æ¶ˆæ¯ï¼Œè€Œå†å²æ¶ˆæ¯å­˜ä¸‹æ¥çš„å‘é€è€…ä¿¡æ¯å¯èƒ½å¹¶ä¸æ˜¯æœ€æ–°çš„ï¼Œæ‰€ä»¥éœ€è¦å»åˆ·æ–°æ•°æ®ã€‚å•èŠåœºæ™¯åªéœ€è¦åˆ·æ–°å¯¹æ–¹ä¸€ä¸ªäººä¿¡æ¯ï¼Œå®ç°è¾ƒä¸ºç®€å•ã€‚ä½†æ˜¯åˆ°ç¾¤èŠï¼Œå‘é€è€…ä¼—å¤šï¼Œä¸å¯èƒ½æ¯æ¬¡è¿›å…¥é¡µé¢éƒ½å»è·å–å…¨éƒ¨æˆå‘˜çš„ä¿¡æ¯ï¼ˆæ•°é‡å¤§ï¼Œè·å–ç¼“æ…¢ï¼‰ï¼Œæ‰€ä»¥éœ€è¦åˆ¶å®šç­–ç•¥å»å®ç°å¥½çš„æ•ˆæœã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>IMä¸­æŒ‰åç§°æ‹¼éŸ³å­—æ¯åˆ†ç»„æ’åº</title>
    <link href="https://wzmyyj.top/2020/07/21/android_9/"/>
    <id>https://wzmyyj.top/2020/07/21/android_9/</id>
    <published>2020-07-21T02:20:30.000Z</published>
    <updated>2020-07-21T04:33:54.130Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><p>åœ¨IMé¡¹ç›®ï¼ˆAndroidé¡¹ç›®ï¼‰ä¸­ï¼Œä¾‹å¦‚ç¾¤æˆå‘˜åˆ—è¡¨ï¼Œé€šè®¯å½•ï¼ˆä»¿å¾®ä¿¡ï¼‰ç­‰ç­‰ã€‚å¾€å¾€ä¼šæŒ‰åç§°é¦–å­—æ¯åˆ†ç»„å¹¶æ’åºã€‚ä»è€Œæ–¹ä¾¿ç”¨æˆ·æ£€ç´¢ã€‚</p><a id="more"></a><h4 id="éœ€æ±‚ï¼š"><a href="#éœ€æ±‚ï¼š" class="headerlink" title="éœ€æ±‚ï¼š"></a>éœ€æ±‚ï¼š</h4><p>å…ˆä¸Šä¸€å¼ UIæ•ˆæœå›¾ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-e908a560c36504f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ•ˆæœt"></p><h3 id="åˆ†æéœ€æ±‚"><a href="#åˆ†æéœ€æ±‚" class="headerlink" title="åˆ†æéœ€æ±‚"></a>åˆ†æéœ€æ±‚</h3><ol><li>æ¯ä¸ªiteméœ€è¦æŒ‰é¦–å­—æ¯åˆ†ç»„ï¼Œç¾¤ä¸»å’Œç®¡ç†å‘˜å•ç‹¬ä¸€ç»„ã€‚Aï½Zä»¥å¤–çš„å­—ç¬¦æ”¾å…¥â€˜#â€™è¿™ç»„ã€‚</li><li>æ¯ç»„å†…æŒ‰æ–‡å­—æ‹¼éŸ³æ’åºã€‚</li><li>æ¯ç»„ä¹‹é—´æœ‰åˆ†éš”æ ‡é¢˜ã€‚</li><li>å³ä¾§ SideBar ï¼ˆè‡ªå®šä¹‰Viewï¼‰å¿«é€Ÿæ£€ç´¢ã€‚</li></ol><p><strong>æ³¨</strong>ï¼šSideBarè‡ªå®šä¹‰Viewå¹¶éæœ¬æ–‡é‡ç‚¹ã€‚å½“ä½œæœ‰è¿™ä¸ªViewå°±æ˜¯äº†ï¼Œæ–‡æœ«ä¼šç»™ä»£ç ï¼Œè‡ªå·±å»å®ç°æ›´å¥½å“ˆğŸ˜Šã€‚</p><h3 id="æ–¹æ¡ˆè®¾è®¡"><a href="#æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="æ–¹æ¡ˆè®¾è®¡"></a>æ–¹æ¡ˆè®¾è®¡</h3><h4 id="æŒ‰å­—æ¯åˆ†ç»„ï¼š"><a href="#æŒ‰å­—æ¯åˆ†ç»„ï¼š" class="headerlink" title="æŒ‰å­—æ¯åˆ†ç»„ï¼š"></a>æŒ‰å­—æ¯åˆ†ç»„ï¼š</h4><p>é’ˆå¯¹éœ€æ±‚1ï¼Œ2ã€‚å†™ä¸€ä¸ªé€šç”¨çš„ç±»å»åšè¿™ä¸ªæ—¶ã€‚ï¼ˆå°½é‡ä¸å…·ä½“ä¸šåŠ¡è§£è€¦ï¼Œä¹Ÿæ–¹ä¾¿æ—¥åæ€»ç»“ã€‚ï¼‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> LatterSetUtil &#123;</span><br><span class="line">    <span class="comment">// "â˜…" ä»£è¡¨ç‰¹æ®Šåˆ†ç±»ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> LETTERS = arrayOf(<span class="string">"â˜…"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="string">"I"</span>,</span><br><span class="line">            <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"R"</span>, <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>,</span><br><span class="line">            <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>, <span class="string">"#"</span>)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¹å™¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Container</span>&lt;<span class="type">T : ILetter</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">internal</span> <span class="keyword">val</span> map: HashMap&lt;String, ArrayList&lt;T&gt;&gt; = HashMap()</span><br><span class="line">        init &#123;</span><br><span class="line">            <span class="comment">// å»ºç«‹å­—æ¯åˆ†ç»„mapã€‚</span></span><br><span class="line">            <span class="keyword">for</span> (s <span class="keyword">in</span> LETTERS) &#123;</span><br><span class="line">                map[s] = ArrayList()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ’åºåçš„åˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">getSortList</span><span class="params">(sort: (<span class="type">ArrayList</span>&lt;<span class="type">T</span>&gt;)</span></span> -&gt; <span class="built_in">Unit</span>, addLetter: <span class="built_in">Boolean</span> = <span class="literal">true</span>): List&lt;Any&gt; &#123;</span><br><span class="line">            <span class="keyword">val</span> resultList = ArrayList&lt;Any&gt;()</span><br><span class="line">            <span class="comment">// å°†åˆ†ç»„ç»“æœæ’æˆåˆ—è¡¨ã€‚</span></span><br><span class="line">            <span class="keyword">for</span> (s <span class="keyword">in</span> LETTERS) &#123;</span><br><span class="line">                <span class="keyword">val</span> list = map[s]</span><br><span class="line">                <span class="comment">// é›†åˆéç©ºæ‰èƒ½åŠ å…¥ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (list.isNullOrEmpty()) <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> (addLetter) &#123;</span><br><span class="line">                    resultList.add(Letter(s, list.size))</span><br><span class="line">                &#125;</span><br><span class="line">                sort(list)</span><br><span class="line">                resultList.addAll(list)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> resultList</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Letter</span></span>(<span class="keyword">val</span> letter: String, <span class="keyword">val</span> size: <span class="built_in">Int</span>)</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">ILetter</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è·å–é¦–å­—æ¯ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">getFirstLetter</span><span class="params">()</span></span>: String = <span class="string">"#"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰å­—æ¯åˆ†ç»„ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList æ•°æ®æºã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : ILetter&gt;</span> <span class="title">getContainer</span><span class="params">(dataList: <span class="type">List</span>&lt;<span class="type">T</span>&gt;)</span></span>: Container&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> c = Container&lt;T&gt;()</span><br><span class="line">        <span class="comment">// é»˜è®¤æ”¾å…¥"#"é›†åˆã€‚</span></span><br><span class="line">        <span class="keyword">val</span> defList = c.map[<span class="string">"#"</span>] ?: <span class="keyword">return</span> c</span><br><span class="line">        <span class="comment">// å°†åŸæ•°æ®åˆ†ç»„ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (ifl <span class="keyword">in</span> dataList) &#123;</span><br><span class="line">            <span class="comment">// è·å–é¦–å­—æ¯ã€‚</span></span><br><span class="line">            <span class="keyword">val</span> s = ifl.getFirstLetter()</span><br><span class="line">            <span class="keyword">val</span> list = c.map[s] ?: defList</span><br><span class="line">            <span class="comment">// åŠ å…¥å¯¹åº”å­—æ¯çš„å°ç»„ã€‚</span></span><br><span class="line">            list.add(ifl)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ï¼š</strong></p><ol><li>æ•°æ®æºéœ€è¦å®ç°LatterSetUtil.ILetteræ¥å£ã€‚</li><li>æ”¾å…¥æ•°æ®æºï¼ˆlistï¼‰è¿”å›ä¸€ä¸ªå®¹å™¨å¯¹è±¡ã€‚é‡Œé¢æ˜¯å·²ç»æŒ‰å­—æ¯åˆ†å¥½ç»„çš„é›†åˆã€‚</li><li>è°ƒç”¨getSortListæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªlistã€‚å¤–éƒ¨æŒ‡å®šç»„å†…æ’åºè§„åˆ™ï¼Œæ¯ç»„ä¹‹å‰ä¼šæ’ä¸€ä¸ªLetterè®°å½•é¦–å­—æ¯å’Œè¿™ç»„å…ƒç´ çš„æ•°é‡ã€‚</li></ol><h4 id="è·å–é¦–å­—æ¯"><a href="#è·å–é¦–å­—æ¯" class="headerlink" title="è·å–é¦–å­—æ¯"></a>è·å–é¦–å­—æ¯</h4><p> æ ¹æ®ä¸­æ–‡è·å–é¦–å­—æ¯ï¼ŒåŸå…ˆï¼Œè‡ªå·±å†™äº†ä¸ªæ ¹æ®æ±‰å­—ç¼–ç è§„å¾‹ï¼ŒæŒ‰å­—ç¬¦åŒºé—´å»åˆ¤æ–­é¦–å­—æ¯çš„æ–¹æ³•ã€‚èƒ½è¦†ç›–å¤§å¤šåœºæ™¯ï¼Œä½†æ˜¯å¾ˆå¿«å°±è¢«æµ‹è¯•æ‰¾å‡ºäº†åä¾‹ğŸ˜“ã€‚äºæ˜¯é‡‡ç”¨ç°æœ‰çš„â€œæ±‰è¯­æ‹¼éŸ³â€åº“ï¼špinyin4jã€‚<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">implementation</span> <span class="string">'com.belerweb:pinyin4j:2.5.1'</span></span><br></pre></td></tr></table></figure></p><p>ä»£ç ï¼š</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class FirstLetterUtil &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®ä¸€ä¸ªåŒ…å«æ±‰å­—çš„å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªæ±‰å­—æ‹¼éŸ³é¦–å­—æ¯çš„å­—ç¬¦ä¸² æœ€é‡è¦çš„ä¸€ä¸ªæ–¹æ³•.</span></span><br><span class="line">    @NonNull</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> first(@Nullable <span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">str</span> == <span class="keyword">null</span> || <span class="built_in">str</span>.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"#"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">char</span> ch = <span class="built_in">str</span>.charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (ch &gt;= <span class="string">'a'</span> &amp;&amp; ch &lt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="built_in">char</span>) (ch - <span class="string">'a'</span> + <span class="string">'A'</span>) + <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ch &gt;= <span class="string">'A'</span> &amp;&amp; ch &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ch + <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            HanyuPinyinOutputFormat defaultFormat = <span class="keyword">new</span> HanyuPinyinOutputFormat();</span><br><span class="line">            <span class="comment">// è®¾ç½®å¤§å°å†™æ ¼å¼</span></span><br><span class="line">            defaultFormat.setCaseType(HanyuPinyinCaseType.UPPERCASE);</span><br><span class="line">            <span class="comment">// è®¾ç½®å£°è°ƒæ ¼å¼ï¼š</span></span><br><span class="line">            defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);</span><br><span class="line">            <span class="keyword">if</span> (Character.toString(ch).matches(<span class="string">"[\\u4E00-\\u9FA5]+"</span>)) &#123;</span><br><span class="line">                <span class="keyword">String</span>[] array = PinyinHelper.toHanyuPinyinStringArray(ch, defaultFormat);</span><br><span class="line">                <span class="keyword">if</span> (array != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> array[<span class="number">0</span>].charAt(<span class="number">0</span>) + <span class="string">""</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"#"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PS</strong>ï¼šHanyuPinyinï¼šæ±‰è¯­æ‹¼éŸ³ã€‚ã€‚ã€‚ã€‚æ±—ğŸ˜“ã€‚ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3262738-d968108c115ff330.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p><p><strong>ä½¿ç”¨ï¼š</strong></p><p>è®©MemberVhModelå®ç°<code>LatterSetUtil.ILetter</code>æ¥å£ï¼Œ<code>getFirstLetter()</code>å®ç°ä¸ºè¿”å›<code>this.latter</code>ã€‚latterå±æ€§åœ¨è®¾ç½®åç§°æ—¶èµ‹å€¼ï¼ˆåˆ©ç”¨FirstLetterUtilï¼‰ã€‚</p><p><strong>æ³¨</strong>ï¼šä¸ç›´æ¥åœ¨getFirstLetter()æ–¹æ³•è¿”å›<code>FirstLetterUtil.first(name)</code>ã€‚æ˜¯å› ä¸ºFirstLetterUtilçš„è¿™ä¸ªæ–¹æ³•æ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼Œè€Œ<code>getFirstLetter()</code>è°ƒç”¨å¯èƒ½è¾ƒä¸ºé¢‘ç¹ã€‚å…¶æ¬¡ï¼ŒMemberVhModelå°½é‡å†™æ•°æ®ï¼Œä¸šåŠ¡é€»è¾‘æœ€å¥½è§£è€¦ã€‚</p><h4 id="ç»„åˆåˆ—è¡¨"><a href="#ç»„åˆåˆ—è¡¨" class="headerlink" title="ç»„åˆåˆ—è¡¨"></a>ç»„åˆåˆ—è¡¨</h4><p>å°†ä¸Šè¿°å†…å®¹ç»„åˆèµ·æ¥ã€‚<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—è¡¨å˜åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    private fun sortMemberAndLetterList(dataList: List&lt;MemberVhModel&gt;, memberSet: MemberSetModel) &#123;</span><br><span class="line">        memberSet.clearMembers()</span><br><span class="line">        val container = LatterSetUtil.getContainer(dataList)</span><br><span class="line">        val lsList = container.getSortList(&#123; sortMemberList(it) &#125;)</span><br><span class="line">        <span class="keyword">for</span> (ls <span class="keyword">in</span> lsList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ls is LatterSetUtil.Letter) &#123;</span><br><span class="line">                val model = MemberTitleVhModel(title = ls<span class="selector-class">.letter</span>, letter = ls<span class="selector-class">.letter</span>, size = ls.size)</span><br><span class="line">                <span class="keyword">if</span> (ls<span class="selector-class">.letter</span> == ADMIN_LETTER) &#123;<span class="comment">// ç®¡ç†å‘˜ã€‚</span></span><br><span class="line">                    model<span class="selector-class">.title</span> = String.format(getString(R<span class="selector-class">.string</span><span class="selector-class">.im_group_admin_count</span>), ls.size)</span><br><span class="line">                &#125;</span><br><span class="line">                memberSet<span class="selector-class">.letterList</span><span class="selector-class">.add</span>(ls.letter)</span><br><span class="line">                memberSet<span class="selector-class">.itemList</span><span class="selector-class">.add</span>(model)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ls is MemberVhModel) &#123;</span><br><span class="line">                memberSet<span class="selector-class">.itemList</span><span class="selector-class">.add</span>(ls)</span><br><span class="line">                memberSet<span class="selector-class">.userList</span><span class="selector-class">.add</span>(ls)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>ç»„å†…æ’åºï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> cmp = Collator.getInstance(Locale.CHINA)!!</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’åºã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sortMemberList</span><span class="params">(list: <span class="type">ArrayList</span>&lt;<span class="type">MemberVhModel</span>&gt;)</span></span> &#123;</span><br><span class="line">        list.sortWith(Comparator &#123; l, r -&gt;cmp.compare(l.name, r.name)&#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="UIæ–¹æ¡ˆ"><a href="#UIæ–¹æ¡ˆ" class="headerlink" title="UIæ–¹æ¡ˆ"></a>UIæ–¹æ¡ˆ</h3><p><strong>xmlå¸ƒå±€ï¼š</strong>æŠŠè¿™ä¸ªå¸ƒå±€includeåˆ°å…·ä½“çš„å¤§é¡µé¢ä¸­ã€‚<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;androidx.constraintlayout.widget.ConstraintLayout</span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">        android:background=<span class="string">"@color/color_EEEEEE"</span>&gt;</span><br><span class="line">        &lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">            android:id=<span class="string">"@+id/rv_member"</span></span><br><span class="line">            binding_rv_data=<span class="string">"<span class="subst">@&#123;item.syncList&#125;</span>"</span></span><br><span class="line">            binding_rv_noAnim=<span class="string">"<span class="subst">@&#123;true&#125;</span>"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">            android:background=<span class="string">"@color/color_EEEEEE"</span></span><br><span class="line">            android:orientation=<span class="string">"vertical"</span></span><br><span class="line">            android:scrollbars=<span class="string">"none"</span></span><br><span class="line">            app:layoutManager=<span class="string">"androidx.recyclerview.widget.LinearLayoutManager"</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/androidx.recyclerview.widget.RecyclerView&gt;</span></span><br><span class="line"><span class="regexp">        &lt;--è¿™æ˜¯å¸é¡¶çš„titleã€‚--&gt;</span></span><br><span class="line"><span class="regexp">        &lt;TextView </span></span><br><span class="line"><span class="regexp">            android:id="@+id/tv</span>_title<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_width="</span>match_parent<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_height="</span>@dimen/pt_36<span class="string">"</span></span><br><span class="line"><span class="string">            android:background="</span>@color/white<span class="string">"</span></span><br><span class="line"><span class="string">            android:gravity="</span>center_vertical<span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingStart="</span>@dimen/pt_15<span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingEnd="</span>@dimen/pt_15<span class="string">"</span></span><br><span class="line"><span class="string">            android:textColor="</span>@color/color_3CC55D<span class="string">"</span></span><br><span class="line"><span class="string">            android:textSize="</span>@dimen/pt_17<span class="string">"</span></span><br><span class="line"><span class="string">            app:layout_constraintStart_toStartOf="</span>parent<span class="string">"</span></span><br><span class="line"><span class="string">            app:layout_constraintTop_toTopOf="</span>parent<span class="string">"</span></span><br><span class="line"><span class="string">            tools:text="</span>A<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">        &lt;è‡ªå®šä¹‰çš„.SideBar</span></span><br><span class="line"><span class="string">            android:id="</span>@+id/sb_letter<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_width="</span>@dimen/pt_4<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_height="</span>match_parent<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_marginTop="</span>@dimen/pt_2<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_marginBottom="</span>@dimen/pt_3<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:focusable="</span>true<span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingStart="</span>@dimen/pt_2<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingEnd="</span><span class="number">10</span>dp<span class="string">"</span></span><br><span class="line"><span class="string">            android:textColorHighlight="</span>@color/color_3CC55D<span class="string">"</span></span><br><span class="line"><span class="string">            android:textSize="</span>@dimen/pt_12_5<span class="string">"</span></span><br><span class="line"><span class="string">            app:layout_constraintEnd_toEndOf="</span>parent<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">        &lt;--è¿™æ˜¯æŒ‰ä½SideBarå±•ç¤ºçš„å­—æ¯ã€‚--&gt;</span></span><br><span class="line"><span class="string">        &lt;TextView </span></span><br><span class="line"><span class="string">            android:id="</span>@+id/tv_letter<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_width="</span>@dimen/pt_54<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_height="</span>@dimen/pt_45<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_marginEnd="</span>@dimen/pt_4<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:background="</span>@drawable/im_bg_side_bar_txt<span class="string">"</span></span><br><span class="line"><span class="string">            android:gravity="</span>center<span class="string">"</span></span><br><span class="line"><span class="string">            android:includeFontPadding="</span>false<span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingStart="</span>@dimen/pt_1<span class="string">"</span></span><br><span class="line"><span class="string">            android:paddingEnd="</span>@dimen/pt_1<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:textColor="</span>@color/color_3CC55D<span class="string">"</span></span><br><span class="line"><span class="string">            android:textSize="</span>@dimen/pt_2<span class="number">0</span><span class="string">"</span></span><br><span class="line"><span class="string">            android:visibility="</span>gone<span class="string">"</span></span><br><span class="line"><span class="string">            app:layout_constraintEnd_toEndOf="</span>parent<span class="string">"</span></span><br><span class="line"><span class="string">            app:layout_constraintTop_toTopOf="</span>@id/sb_letter<span class="string">"</span></span><br><span class="line"><span class="string">            tools:text="</span>â˜…<span class="string">"</span></span><br><span class="line"><span class="string">            tools:visibility="</span>visible<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span></span><br></pre></td></tr></table></figure></p><p>RecyclerViewä¸SideBaræœ‰è”åŠ¨æ•ˆæœã€‚å¹¶ä¸”ä¸å…·ä½“æ•°æ®ä¸šåŠ¡æ— å…³ã€‚æ‰€ä»¥æŠŠè¿™éƒ¨åˆ†ä»£ç è§£è€¦å‡ºæ¥ã€‚ä¸å•æˆå‘˜åˆ—è¡¨ä¸€ä¸ªé¡µé¢ç”¨ã€‚æ·»åŠ ï¼Œåˆ é™¤ç¾¤æˆå‘˜ï¼ŒATæˆå‘˜é¡µé¢éƒ½æœ‰ä¸€æ ·çš„é€»è¾‘ã€‚è¦å­¦ä¼šæŠ½ç¦»å…¬å…±é€»è¾‘ğŸ‘Œã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> MemberListUI &#123;</span><br><span class="line">    <span class="comment">// æ•°æ®è®°å½•ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Data</span></span>(<span class="keyword">var</span> lastPosition: <span class="built_in">Int</span> = <span class="number">-1</span>)</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">init</span><span class="params">(binding: <span class="type">ImCommonMemberListBinding</span>, rvAdapter: <span class="type">RecyclerView</span>.<span class="type">Adapter</span>&lt;*&gt;)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> <span class="keyword">data</span> = Data()</span><br><span class="line">        <span class="comment">// è¿™æ˜¯RecyclerViewã€‚</span></span><br><span class="line">        binding.rvMember.run &#123;</span><br><span class="line">            adapter = rvAdapter</span><br><span class="line">            addOnScrollListener(<span class="keyword">object</span> : RecyclerView.OnScrollListener() &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onScrolled</span><span class="params">(v: <span class="type">RecyclerView</span>, dx: <span class="type">Int</span>, dy: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">                    <span class="keyword">super</span>.onScrolled(v, dx, dy)</span><br><span class="line">                    <span class="keyword">val</span> item = binding.item ?: <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">val</span> headerCount = MemberUtil.getHeaderCount(item)</span><br><span class="line">                    <span class="comment">// v.getChildAt(0)ä¸ä¼šè¶Šç•Œå¼‚å¸¸ï¼Œè¶…å‡ºç´¢å¼•ä¼šè¿”å›nullã€‚</span></span><br><span class="line">                    <span class="keyword">val</span> position = v.getChildAt(<span class="number">0</span>)?.let &#123; v.getChildLayoutPosition(it) &#125; ?: <span class="number">0</span></span><br><span class="line">                    <span class="comment">// å¸é¡¶æ•ˆæœã€‚</span></span><br><span class="line">                    binding.tvTitle.setVisible(position &gt; headerCount)</span><br><span class="line">                    <span class="comment">// positionå‘ç”Ÿå˜åŒ–æ—¶ã€‚</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">data</span>.lastPosition != position) &#123;</span><br><span class="line">                        binding.tvTitle.text = MemberUtil.getTitleByIndex(item, position - headerCount)</span><br><span class="line">                        <span class="keyword">data</span>.lastPosition = position</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿™æ˜¯SlideBarã€‚</span></span><br><span class="line">        binding.sbLetter.run &#123;</span><br><span class="line">            setTextView(binding.tvLetter)</span><br><span class="line">            setOnTouchingLetterChangedListener &#123; letter -&gt;</span><br><span class="line">                <span class="comment">// è”åŠ¨æˆå‘˜åˆ—è¡¨ã€‚</span></span><br><span class="line">                <span class="keyword">val</span> item = binding.item ?: <span class="keyword">return</span><span class="symbol">@setOnTouchingLetterChangedListener</span></span><br><span class="line">                <span class="keyword">val</span> index = MemberUtil.getIndexByLetter(item, letter)</span><br><span class="line">                <span class="keyword">if</span> (index &lt; <span class="number">0</span>) <span class="keyword">return</span><span class="symbol">@setOnTouchingLetterChangedListener</span></span><br><span class="line">                <span class="comment">// åˆ—è¡¨å‰å¯èƒ½æœ‰headerã€‚</span></span><br><span class="line">                <span class="keyword">val</span> headerCount = MemberUtil.getHeaderCount(item)</span><br><span class="line">                <span class="keyword">val</span> position = index + headerCount</span><br><span class="line">                <span class="keyword">if</span> (position <span class="keyword">in</span> <span class="number">0</span> until rvAdapter.itemCount) &#123;</span><br><span class="line">                    <span class="keyword">val</span> layoutManager = binding.rvMember.layoutManager</span><br><span class="line">                    <span class="keyword">if</span> (layoutManager <span class="keyword">is</span> LinearLayoutManager) &#123;</span><br><span class="line">                        layoutManager.scrollToPositionWithOffset(position, <span class="number">0</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">data</span>.lastPosition != position) &#123;</span><br><span class="line">                        binding.tvTitle.text = MemberUtil.getTitleByIndex(item, position - headerCount)</span><br><span class="line">                        <span class="keyword">data</span>.lastPosition = position</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ä½¿ç”¨ï¼š</strong></p><p>åªéœ€è¦ä¸€å¥è¯ã€‚å†™åœ¨Viewçš„åˆå§‹åŒ–å¤„ã€‚ï¼ˆvListæ˜¯includeçš„å¸ƒå±€IDè½¬è¿‡æ¥çš„bindingã€‚ï¼‰<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">MemberListUI</span><span class="selector-class">.init</span>(<span class="selector-tag">binding</span><span class="selector-class">.vList</span>, <span class="selector-tag">memberAdapter</span>)</span><br></pre></td></tr></table></figure></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ç¯‡çš„å€Ÿç€ç¾¤æˆå‘˜åˆ—è¡¨çš„ä¸šåŠ¡ï¼Œä¸»è¦æƒ³è®²è¿°ä¸€ä¸‹å‡ ç‚¹ã€‚</p><p><strong>è¦ç‚¹ï¼š</strong></p><ol><li>æ•°æ®ç»“æ„ç›¸å…³ï¼Œå°½é‡ä»ä¸šåŠ¡ä¸­æŠ½ç¦»ã€‚è¾¾åˆ°å¯å¤ç”¨æ•ˆæœã€‚</li><li>æ•°æ®ç±»å°½é‡ä¸å†™å…·ä½“é€»è¾‘ã€‚é™¤äº†å®ç°æ¥å£ï¼Œå°½å¯èƒ½ç®€å•ã€‚å¤æ‚é€»è¾‘å¤–é¢å»åšã€‚</li><li>å…¬å…±UIè¯•ç€æŠ½ç¦»ä¸šåŠ¡ã€‚</li></ol><p><strong>ä½“ä¼šï¼š</strong></p><ol><li>æŠŠä»£ç å®ç°æœ‰æ¡ç†ä¸€ç‚¹ï¼Œæ€»ç»“èµ·æ¥æ„‰å¿«ä¸€äº›ğŸ˜Šã€‚</li></ol><h4 id="é™„ä»¶"><a href="#é™„ä»¶" class="headerlink" title="é™„ä»¶"></a>é™„ä»¶</h4><p><a href="https://github.com/wzmyyj/FeHome/blob/master/lib_kit/src/main/java/top/wzmyyj/kit/weight/SideBar.java" target="_blank" rel="noopener">SideBar.java</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h4&gt;&lt;p&gt;åœ¨IMé¡¹ç›®ï¼ˆAndroidé¡¹ç›®ï¼‰ä¸­ï¼Œä¾‹å¦‚ç¾¤æˆå‘˜åˆ—è¡¨ï¼Œé€šè®¯å½•ï¼ˆä»¿å¾®ä¿¡ï¼‰ç­‰ç­‰ã€‚å¾€å¾€ä¼šæŒ‰åç§°é¦–å­—æ¯åˆ†ç»„å¹¶æ’åºã€‚ä»è€Œæ–¹ä¾¿ç”¨æˆ·æ£€ç´¢ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>IMé¡¹ç›®ä¸­ç¾¤æˆå‘˜è·å–ä¸ç¼“å­˜ç­–ç•¥</title>
    <link href="https://wzmyyj.top/2020/07/21/android_8/"/>
    <id>https://wzmyyj.top/2020/07/21/android_8/</id>
    <published>2020-07-21T02:00:30.000Z</published>
    <updated>2020-07-21T04:27:52.863Z</updated>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>åœ¨IMé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è·å–ç¾¤æˆå‘˜ï¼Œå¾€å¾€æ•°æ®è¾ƒå¤§ï¼Œè·å–ç¼“æ…¢ï¼Œæ‰€ä»¥éœ€è¦åšä¸ªç¼“å­˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p><a id="more"></a><h4 id="ç­–ç•¥"><a href="#ç­–ç•¥" class="headerlink" title="ç­–ç•¥"></a>ç­–ç•¥</h4><ol><li>å¦‚æœæœ¬åœ°ï¼ˆç¼“å­˜é‡Œï¼‰æœ‰å®Œæ•´æ•°æ®ï¼Œåˆ™å–ç¼“å­˜é‡Œæ•°æ®ï¼Œå¦åˆ™ä»ç½‘è·¯è·å–ã€‚ï¼ˆå¯èƒ½å¤šä¸ªåœ°æ–¹éœ€è¦åŠ è½½æˆå‘˜åˆ—è¡¨ï¼Œä½†æ— æ³•ä¿è¯é‚£å¤„å…ˆåŠ è½½ã€‚æ¯”å¦‚æŸ¥çœ‹ç¾¤æˆå‘˜ï¼Œé€‰æ‹©ATç¾¤å†…æŸäººï¼Œç®¡ç†å‘˜åˆ—è¡¨ç­‰ç­‰ã€‚ï¼‰</li><li>ä»ç½‘ç»œè·å–å…¨éƒ¨æˆå‘˜æ—¶ï¼Œåˆ†é¡µè·å–ã€‚é‡‡ç”¨é€’å½’è¯·æ±‚ï¼Œç›´åˆ°æ²¡æœ‰ä¸‹ä¸€é¡µã€‚</li><li>æœ€å¤šç¼“å­˜15ä¸ªç¾¤çš„æˆå‘˜ï¼Œå¦‚æœè¶…è¿‡15ä¸ªï¼Œæ·˜æ±°æ‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é‚£ä¸ªç¾¤çš„æˆå‘˜ã€‚</li><li>å•ä¸ªæˆå‘˜ä¿¡æ¯è·å–ï¼Œä¼šå­˜åœ¨ä¸´æ—¶æˆå‘˜é‡Œã€‚ï¼ˆç”¨é€”æ˜¯ï¼Œåœ¨ç¾¤èŠå¤©é¡µï¼Œå®æ—¶åˆ·æ–°è°ƒå¤©å‘é€è€…ä¿¡æ¯ã€‚ï¼‰å¦‚æœè¿™ä¸ªç¾¤å·²ç»æœ‰å®Œæˆçš„ç¾¤æˆå‘˜åˆ—è¡¨ï¼Œåˆ™åˆ é™¤ä¸´æ—¶æˆå‘˜ã€‚ï¼ˆèŠå¤©é¡µå‘é€è€…ä¿¡æ¯ç›´æ¥ä»å®Œæ•´çš„ç¾¤æˆå‘˜è¡¨é‡Œå–å‡ºå¯¹æ¯”ï¼‰ã€‚</li><li>æ”¯æŒä¿®æ”¹ç¼“å­˜æ•°æ®ã€‚åŒ…æ‹¬å¢åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹æˆå‘˜ã€‚</li></ol><h4 id="æ–¹æ¡ˆè®¾è®¡"><a href="#æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="æ–¹æ¡ˆè®¾è®¡"></a>æ–¹æ¡ˆè®¾è®¡</h4><p><strong>ç¼“å­˜ï¼š</strong><br>å®šä¹‰æˆå‘˜é›†åˆæ¥å£ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆå‘˜é›†åˆæ¥å£ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IMemberSet</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¾å…¥å•ä¸ªæˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(member: <span class="type">MemberBean</span>)</span></span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: MemberBean?</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¾å…¥å…¨éƒ¨æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">putAll</span><span class="params">(memberList: <span class="type">ArrayList</span>&lt;<span class="type">MemberBean</span>&gt;)</span></span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å…¨éƒ¨æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getAll</span><span class="params">()</span></span>: ArrayList&lt;MemberBean&gt;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤§å°ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">size</span><span class="params">()</span></span>: <span class="built_in">Int</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å…¨éƒ¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isAll</span><span class="params">()</span></span>: <span class="built_in">Boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®šä¹‰ç¼“å­˜å™¨æ¥å£ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¼“å­˜å™¨æ¥å£ã€‚å¯è‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMemberCache</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(groupCode: <span class="type">String</span>, memberSet: <span class="type">IMemberSet</span>)</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(groupCode: <span class="type">String</span>)</span></span>: IMemberSet?</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">remove</span><span class="params">(groupCode: <span class="type">String</span>)</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>è·å–ï¼š</strong><br>å…ˆåˆ¤æ–­ç¼“å­˜ï¼Œå†é€’å½’è·å–å…¨éƒ¨ç¾¤æˆå‘˜ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> repository <span class="keyword">by</span> lazy &#123;</span><br><span class="line">    MemberRepository(RetrofitHelper.instance.createApiService(MemberApi::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>))</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠ è½½ç¾¤æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> groupCode ç¾¤å·ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> justByNet åªé€šè¿‡ç½‘ç»œè·å–ã€‚ä¼šæŠŠç»“æœç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">loadMemberList</span><span class="params">(groupCode: <span class="type">String</span>, justByNet: <span class="type">Boolean</span> = <span class="literal">false</span>)</span></span>: Observable&lt;ArrayList&lt;MemberBean&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> cacheSet = cache.<span class="keyword">get</span>(groupCode)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (cacheSet != <span class="literal">null</span> &amp;&amp; cacheSet.isAll() &amp;&amp; justByNet.not()) &#123;</span><br><span class="line">        <span class="comment">// ä»ç¼“å­˜ä¸­è·å–ã€‚</span></span><br><span class="line">        Observable.just(cacheSet.getAll())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä»ç½‘ç»œè·å–ã€‚</span></span><br><span class="line">        <span class="keyword">val</span> list = ArrayList&lt;MemberBean&gt;()</span><br><span class="line">        getMemberListFromNet(groupCode, <span class="number">1</span>, list)</span><br><span class="line">                .doOnNext &#123;</span><br><span class="line">                    <span class="keyword">val</span> <span class="keyword">set</span> = cacheSet ?: MemberSet()</span><br><span class="line">                    <span class="keyword">set</span>.putAll(it)</span><br><span class="line">                    cache.put(groupCode, <span class="keyword">set</span>)</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//---------private method-----------//</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€’å½’è·å–ç¾¤æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getMemberListFromNet</span><span class="params">(groupCode: <span class="type">String</span>, pageNo: <span class="type">Int</span>, beanList: <span class="type">ArrayList</span>&lt;<span class="type">MemberBean</span>&gt;)</span></span></span><br><span class="line">        : Observable&lt;ArrayList&lt;MemberBean&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> repository</span><br><span class="line">            .postGroupMembers(groupCode, pageNo, pageSize)</span><br><span class="line">            .filter &#123; it.status.falseRun &#123; <span class="keyword">throw</span> RuntimeException(it.message.orEmpty()) &#125; &#125;</span><br><span class="line">            .flatMap &#123;</span><br><span class="line">                it.entry?.groupMemberList?.let &#123; l -&gt; beanList.addAll(l) &#125;</span><br><span class="line">                <span class="keyword">return</span><span class="symbol">@flatMap</span> <span class="keyword">if</span> (it.entry?.hasNextPage == <span class="literal">true</span>) &#123;</span><br><span class="line">                    getMemberListFromNet(groupCode, pageNo + <span class="number">1</span>, beanList)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Observable.just(beanList)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å®Œæ•´ä»£ç ï¼š"><a href="#å®Œæ•´ä»£ç ï¼š" class="headerlink" title="å®Œæ•´ä»£ç ï¼š"></a>å®Œæ•´ä»£ç ï¼š</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> MemberHelper &#123;</span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> pageSize: <span class="built_in">Int</span> = <span class="number">500</span></span><br><span class="line">    <span class="comment">// ç¼“å­˜15ä¸ªç¾¤ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> maxCount: <span class="built_in">Int</span> = <span class="number">15</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜å™¨æ¥å£ã€‚å¯è‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMemberCache</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(groupCode: <span class="type">String</span>, memberSet: <span class="type">IMemberSet</span>)</span></span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(groupCode: <span class="type">String</span>)</span></span>: IMemberSet?</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">remove</span><span class="params">(groupCode: <span class="type">String</span>)</span></span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆå‘˜é›†åˆæ¥å£ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">IMemberSet</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ”¾å…¥å•ä¸ªæˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(member: <span class="type">MemberBean</span>)</span></span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è·å–æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: MemberBean?</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ”¾å…¥å…¨éƒ¨æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">putAll</span><span class="params">(memberList: <span class="type">ArrayList</span>&lt;<span class="type">MemberBean</span>&gt;)</span></span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è·å–å…¨éƒ¨æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">getAll</span><span class="params">()</span></span>: ArrayList&lt;MemberBean&gt;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å¤§å°ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">size</span><span class="params">()</span></span>: <span class="built_in">Int</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ˜¯å¦å…¨éƒ¨ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">isAll</span><span class="params">()</span></span>: <span class="built_in">Boolean</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤ç”¨ LRU ç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> cache: IMemberCache = LruMemberCache(maxCount)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> repository <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        MemberRepository(RetrofitHelper.instance.createApiService(MemberApi::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>))</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤ä¸€ä¸ªç¾¤æˆå‘˜çš„ç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">remove</span><span class="params">(groupCode: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        cache.remove(groupCode)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç¼“å­˜é‡Œçš„é›†åˆã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(groupCode: <span class="type">String</span>)</span></span>: IMemberSet? &#123;</span><br><span class="line">        <span class="keyword">return</span> cache.<span class="keyword">get</span>(groupCode)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å– IMemberSet å¦‚æœæ²¡æœ‰ï¼Œå°±å­˜ä¸€ä¸ªè¿›å»ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getIfAbsent</span><span class="params">(groupCode: <span class="type">String</span>)</span></span>: IMemberSet &#123;</span><br><span class="line">        <span class="keyword">return</span> cache.<span class="keyword">get</span>(groupCode) ?: MemberSet().apply &#123;</span><br><span class="line">            cache.put(groupCode, <span class="keyword">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¸…ç©ºã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">clear</span><span class="params">()</span></span> &#123;</span><br><span class="line">        cache.clear()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½å•ä¸ªæˆå‘˜åœ¨è¿™ä¸ªç¾¤çš„ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sessionId ä¼šè¯ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> imAccount IMå·ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">loadMember</span><span class="params">(sessionId: <span class="type">String</span>, imAccount: <span class="type">String</span>)</span></span>: Observable&lt;HttpResponse&lt;MemberBean&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> repository.getUserInfoBySession(sessionId, imAccount)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½ç¾¤æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> groupCode ç¾¤å·ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> justByNet åªé€šè¿‡ç½‘ç»œè·å–ã€‚ä¼šæŠŠç»“æœç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">loadMemberList</span><span class="params">(groupCode: <span class="type">String</span>, justByNet: <span class="type">Boolean</span> = <span class="literal">false</span>)</span></span>: Observable&lt;ArrayList&lt;MemberBean&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> cacheSet = cache.<span class="keyword">get</span>(groupCode)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span> (cacheSet != <span class="literal">null</span> &amp;&amp; cacheSet.isAll() &amp;&amp; justByNet.not()) &#123;</span><br><span class="line">            <span class="comment">// ä»ç¼“å­˜ä¸­è·å–ã€‚</span></span><br><span class="line">            Observable.just(cacheSet.getAll())</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ä»ç½‘ç»œè·å–ã€‚</span></span><br><span class="line">            <span class="keyword">val</span> list = ArrayList&lt;MemberBean&gt;()</span><br><span class="line">            getMemberListFromNet(groupCode, <span class="number">1</span>, list)</span><br><span class="line">                    .doOnNext &#123;</span><br><span class="line">                        <span class="keyword">val</span> <span class="keyword">set</span> = cacheSet ?: MemberSet()</span><br><span class="line">                        <span class="keyword">set</span>.putAll(it)</span><br><span class="line">                        cache.put(groupCode, <span class="keyword">set</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//---------private method-----------//</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å½’è·å–ç¾¤æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getMemberListFromNet</span><span class="params">(groupCode: <span class="type">String</span>, pageNo: <span class="type">Int</span>, beanList: <span class="type">ArrayList</span>&lt;<span class="type">MemberBean</span>&gt;)</span></span></span><br><span class="line">            : Observable&lt;ArrayList&lt;MemberBean&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> repository</span><br><span class="line">                .postGroupMembers(groupCode, pageNo, pageSize)</span><br><span class="line">                .filter &#123; it.status.falseRun &#123; <span class="keyword">throw</span> RuntimeException(it.message.orEmpty()) &#125; &#125;</span><br><span class="line">                .flatMap &#123;</span><br><span class="line">                    it.entry?.groupMemberList?.let &#123; l -&gt; beanList.addAll(l) &#125;</span><br><span class="line">                    <span class="keyword">return</span><span class="symbol">@flatMap</span> <span class="keyword">if</span> (it.entry?.hasNextPage == <span class="literal">true</span>) &#123;</span><br><span class="line">                        getMemberListFromNet(groupCode, pageNo + <span class="number">1</span>, beanList)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        Observable.just(beanList)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * LRUç¼“å­˜å™¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">LruMemberCache</span></span>(maxSize: <span class="built_in">Int</span>) : IMemberCache &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> lruCache = LruCache&lt;String, IMemberSet&gt;(maxSize)</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(groupCode: <span class="type">String</span>, memberSet: <span class="type">IMemberSet</span>)</span></span> &#123;</span><br><span class="line">            lruCache.put(groupCode, memberSet)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(groupCode: <span class="type">String</span>)</span></span>: IMemberSet? &#123;</span><br><span class="line">            <span class="keyword">return</span> lruCache.<span class="keyword">get</span>(groupCode)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">remove</span><span class="params">(groupCode: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">            lruCache.remove(groupCode)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">clear</span><span class="params">()</span></span> &#123;</span><br><span class="line">            lruCache.evictAll()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆå‘˜é›†åˆã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberSet</span> : <span class="type">IMemberSet &#123;</span></span></span><br><span class="line">        <span class="comment">// å…¨éƒ¨æˆå‘˜åˆ—è¡¨ã€‚</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> list = ArrayList&lt;MemberBean&gt;()</span><br><span class="line">        <span class="comment">// æ˜¯å¦å…¨éƒ¨æˆå‘˜ã€‚</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> all: <span class="built_in">Boolean</span> = <span class="literal">false</span></span><br><span class="line">        <span class="comment">// ä¸´æ—¶å­˜æ”¾çš„æˆå‘˜ã€‚ä¿¡æ¯ä¸å…¨çš„beanã€‚</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> map = HashMap&lt;String, MemberBean&gt;()</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">putAll</span><span class="params">(memberList: <span class="type">ArrayList</span>&lt;<span class="type">MemberBean</span>&gt;)</span></span> &#123;</span><br><span class="line">            list.clear()</span><br><span class="line">            list.addAll(memberList)</span><br><span class="line">            all = <span class="literal">true</span></span><br><span class="line">            map.clear()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getAll</span><span class="params">()</span></span>: ArrayList&lt;MemberBean&gt; = list</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">size</span><span class="params">()</span></span>: <span class="built_in">Int</span> = list.size + map.size</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">isAll</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> = all</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">put</span><span class="params">(member: <span class="type">MemberBean</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">val</span> have = all &amp;&amp; list.find &#123;</span><br><span class="line">                it.imAccount == member.imAccount</span><br><span class="line">            &#125;?.apply &#123;</span><br><span class="line">                nickName = member.nickName</span><br><span class="line">                groupRole = member.groupRole</span><br><span class="line">                avatar = member.avatar</span><br><span class="line">            &#125; != <span class="literal">null</span></span><br><span class="line">            <span class="keyword">if</span> (!have) &#123;</span><br><span class="line">                map[member.imAccount.orEmpty()] = member</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(imAccount: <span class="type">String</span>)</span></span>: MemberBean? &#123;</span><br><span class="line">            <span class="keyword">return</span> list.find &#123; it.imAccount == imAccount &#125; ?: map[imAccount]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šlruCache è®¡ç®—sizeï¼Œä¸èƒ½ç”¨æˆå‘˜ä¸ªæ•°ï¼ˆå³<code>list.size()</code>ï¼‰æ¥è®¡ç®—ï¼Œå› ä¸ºä¸€ä¸ªç¾¤çš„æˆå‘˜åœ¨å­˜å…¥åä¸­é€”æ˜¯å¤§å°ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¼šå¯¼è‡´lruCacheå†…éƒ¨ç»´æŠ¤çš„sizeè®¡ç®—å°äº0 ï¼Œ<code>trimToSize</code> æ–¹æ³• æŠ›å‡ºIllegalStateException å¼‚å¸¸ã€‚<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">if</span> (<span class="built_in">size</span> &lt; <span class="number">0</span> || (<span class="built_in">map</span>.isEmpty() &amp;&amp; <span class="built_in">size</span> != <span class="number">0</span>)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(getClass().getName()</span><br><span class="line">                            + <span class="string">".sizeOf() is reporting inconsistent results!"</span>);</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><ol><li>è·å–æ•°æ®ï¼šloadMemberList()ã€‚å¯ä»¥æŒ‡å®šå¼ºåˆ¶ä»ç½‘ç»œè·å–ã€‚</li><li>ç¾¤æˆå‘˜æ–°å¢æ—¶ï¼Œä¸€èˆ¬æ˜¯æ¸…ç©ºè¿™ä¸ªç¾¤çš„ç¼“å­˜æ•°æ®ã€‚è®©ä¸‹æ¬¡é‡æ–°è·å–ï¼Œå› ä¸ºæ–°å¢ç¾¤æˆå‘˜æ—¶ï¼Œå¹¶ä¸èƒ½æ‹¿åˆ°è¿™ä¸ªæˆå‘˜åœ¨è¿™ä¸ªç¾¤çš„è¯¦æƒ…ã€‚</li><li>åˆ é™¤å’Œä¿®æ”¹ç›´æ¥ä¿®æ”¹ç¼“å­˜é‡Œçš„æ•°æ®ã€‚</li><li>ç»“åˆèŠå¤©é¡µé¢å•ä¸ªæ¶ˆæ¯å‘é€è€…å»åˆ·æ–°æ•°æ®ã€‚ï¼ˆè¿™ä¸ªä¸‹ä¸€ç¯‡ä¼šè®²ï¼‰ã€‚</li></ol><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ol><li>è®¾è®¡å¥½ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œèƒ½ä½¿å¼€å‘å®ç°æ›´æœ‰æ¡ç†ã€‚</li><li>lruCacheï¼Œè®¡ç®—sizeï¼Œå¯¹åŒä¸€ä¸ªå…ƒç´ ï¼Œsizeåº”å½“ä¸å¯å˜ã€‚</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-53ad2dbb5c80eb66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h4&gt;&lt;p&gt;åœ¨IMé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è·å–ç¾¤æˆå‘˜ï¼Œå¾€å¾€æ•°æ®è¾ƒå¤§ï¼Œè·å–ç¼“æ…¢ï¼Œæ‰€ä»¥éœ€è¦åšä¸ªç¼“å­˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>å°æ•…äº‹ï¼šæœªç†Ÿçš„æœå®</title>
    <link href="https://wzmyyj.top/2020/07/20/story_2/"/>
    <id>https://wzmyyj.top/2020/07/20/story_2/</id>
    <published>2020-07-20T01:50:00.000Z</published>
    <updated>2020-07-21T04:36:42.622Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ•…äº‹"><a href="#æ•…äº‹" class="headerlink" title="æ•…äº‹"></a>æ•…äº‹</h4><p>æŸä¸ªåœºæ™¯ã€‚ </p><a id="more"></a><p>   å¤©åè¦å¸¦å¥¹å›å¤©ç•Œï¼Œå¥¹ä¸æ„¿æ„å‘ç”Ÿäº†äº‰æ‰§ã€‚æˆ‘æ­£èº²åœ¨å¢™åæ¸…æ¥šåœ°å¬ç€ä¸€åˆ‡ã€‚<br>åˆ°åé¢ï¼Œå¥¹ä¸æƒ³å†è¯´ä»€ä¹ˆä»»æ€§åœ°è·‘äº†ã€‚æˆ‘ä¸»åŠ¨èµ°äº†å‡ºæ¥ï¼Œé¢è§å¤©åï¼Œè¯´äº†äº›â€œæ¯ä¸ªäººå¯ä»¥è¿½æ±‚è‡ªç”±â€çš„è¯ã€‚å¤©åå…ˆä¸è¿½ç©¶ï¼Œæš‚æ—¶æ”¾æ‰‹ã€‚<br>   æˆ‘çŸ¥é“ï¼Œå¹¶ä¸æ˜¯æˆ‘çš„è¯æ‰“åŠ¨å¤©åï¼Œè€Œæ˜¯å¤©åçˆ±è‡ªå·±çš„å¥³å„¿ï¼Œå‡¡äººçš„ç†å¿µåœ¨å¥¹çœ‹æ¥åªæ˜¯ä¸€äº›å¹¼ç¨šçš„å„¿è¯ã€‚<br>   æˆ‘æ¥åˆ°ä¸€ä¸ªä»“åº“é—´ï¼Œæˆ‘çŸ¥é“å¥¹ä¸€å®šè—åœ¨è¿™ä¼‘æ¯ã€‚æˆ‘æŠŠä¸€å¼ çº¸ç‰‡å¯¹æŠ˜æ”¾åœ¨æ¡Œå­ä¸Šçš„å‰ªåˆ€æ—è¾¹ã€‚æˆ‘æ‰¾åˆ°äº†å¥¹ï¼Œå¥¹æ­£è£¹ç€éº»è¢‹å°ç¡ã€‚å¥¹åŠçå¼€çœ¼ä¹åŠ›åœ°å¯¹æˆ‘è¯´ï¼Œå¥¹éœ€è¦ç¦»å¼€è¿™é‡Œã€‚<br>   æˆ‘èƒŒç€å¥¹èµ°åœ¨å±±é—´çš„é©¬è·¯ä¸Šï¼Œä¸¤è¾¹èŒ‚ç››çš„æ ‘ä¸›é‡Œå¼€ç€æœé¹ƒèŠ±ã€‚å¥¹ä¸‹å·´æ­åœ¨æˆ‘å·¦è‚©ä¸Šï¼Œä¾§è„¸å¶å¶è§¦ç¢°åˆ°æˆ‘çš„è€³æ ¹ã€‚<br>   æˆ‘é—®å¥¹ï¼šâ€œä¸ºä»€ä¹ˆç»™æˆ‘å’ŒæŸäº›äººä¸€å¼ çº¸ï¼Ÿâ€<br>   å¥¹ç›´ç‡å›ç­”é“ï¼šâ€œä¸ºäº†æ¯”è¾ƒã€‚â€<br>   æˆ‘å†…å¿ƒå¹äº†å£æ°”ï¼Œç‚¹äº†ç‚¹å¤´ã€‚è¯´é“ï¼šâ€œä¹Ÿæ˜¯ï¼Œäººæ´»ç€å°±æ˜¯ç«äº‰ï¼Œæœ‰ç«äº‰å°±æœ‰æ¯”è¾ƒã€‚â€<br>   ä¸ä¹…ï¼Œæˆ‘ä»¬åˆ°äº†ç›®çš„åœ°ï¼Œä¸€æ‰€å¤§åˆ«å¢…ã€‚å¥¹ä¸‹æ¥æˆ‘æ‰¶ç€å¥¹èµ°ã€‚å¥¹è¦èµ°é•¿æ»¡èŠ±çš„å°é“ã€‚æˆ‘åœ¨åœ°ä¸Šæ¡èµ·ä¸€é¢—æ¾æœå¤§å°çš„æœå®ã€‚å¥¹é—®è¿™æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘è¯´è¿™æ˜¯ä¸€ç§æ— åæ ‘çš„æœå­ï¼Œæˆç†Ÿåæ˜¯èƒ½å¤Ÿåƒçš„ã€‚æˆ‘æ‰“å¼€æœå®ï¼Œé‡Œé¢çš„æœè‚‰è¿˜æ˜¯é€æ˜é‡Œå¸¦é’ï¼Œæ˜¾ç„¶æœå®è¿˜æ²¡æœ‰æˆç†Ÿã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-91af9691e455df19.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="abc"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;æ•…äº‹&quot;&gt;&lt;a href=&quot;#æ•…äº‹&quot; class=&quot;headerlink&quot; title=&quot;æ•…äº‹&quot;&gt;&lt;/a&gt;æ•…äº‹&lt;/h4&gt;&lt;p&gt;æŸä¸ªåœºæ™¯ã€‚ &lt;/p&gt;
    
    </summary>
    
    
      <category term="æ•…äº‹" scheme="https://wzmyyj.top/tags/%E6%95%85%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>IMé¡¹ç›®ä¸­çš„è‡ªå®šä¹‰å°è¡¨æƒ…å®ç°</title>
    <link href="https://wzmyyj.top/2020/07/19/android_7/"/>
    <id>https://wzmyyj.top/2020/07/19/android_7/</id>
    <published>2020-07-19T02:10:30.000Z</published>
    <updated>2020-07-21T04:28:25.627Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨imé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼Œç”¨æˆ·å‘æ¶ˆæ¯ï¼Œå–œæ¬¢åœ¨æ–‡å­—ä¸­åµŒå…¥ä¸€äº›å°è¡¨æƒ…ï¼Œä»¥è¡¨è¾¾å‘é€è€…å½“æ—¶çš„æƒ…æ„Ÿã€‚é™¤äº†ç³»ç»Ÿè¾“å…¥æ³•è‡ªå¸¦çš„emojiè¡¨æƒ…ï¼ˆemojiå…¶å®æ˜¯ç‰¹æ®Šçš„æ–‡å­—ï¼‰å¤–ã€‚é¡¹ç›®å¸Œæœ›å¸¦ä¸€äº›æ›´æ¼‚äº®ï¼Œå¸¦äº§å“ç‰¹è‰²æ–‡åŒ–çš„è‡ªå®šä¹‰å°è¡¨æƒ…ï¼ˆå°å›¾ç‰‡ï¼‰ã€‚</p><a id="more"></a><p>å›¾ç‰‡åµŒå…¥åœ¨æ–‡å­—ä¸­æ˜¾ç¤ºï¼Œå¾ˆæ˜æ˜¾å¯ä»¥ä½¿ç”¨ImageSpanå»å®ç°è¯¥æ•ˆæœã€‚</p><p>æ•ˆæœå¦‚å›¾ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-8535c1eebf78d319.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ•ˆæœå›¾" title="WechatIMG74.jpeg"> </p><h3 id="å®ç°ï¼š"><a href="#å®ç°ï¼š" class="headerlink" title="å®ç°ï¼š"></a>å®ç°ï¼š</h3><p>å®ç°ä¸Šï¼Œä¸»è¦é—®é¢˜æ˜¯ï¼Œå®ç°æ–‡å­—ä¸è¡¨æƒ…çš„è½¬æ¢ã€‚å› æ­¤éœ€è¦å®šä¹‰ä¸€å¥—å¯¹åº”å…³ç³»ã€‚</p><p>è¿™é‡Œé‡‡ç”¨ç±»ä¼¼å¾®ä¿¡çš„å®ç°ï¼Œ[key]å¯¹åº”è¡¨æƒ…ã€‚æ¯”å¦‚ï¼š [å¾®ç¬‘] å¯¹åº” ğŸ˜Šã€‚</p><p><strong>å·¥å…·ç±»ï¼š</strong><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> EmoticonHelper &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> SIGN_LEFT = <span class="string">'['</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> SIGN_RIGHT = <span class="string">']'</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> ZOOM_SIZE = <span class="number">1.3</span>F</span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CACHE_SIZE = <span class="number">60</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> def = R.drawable.im_emoticon_def</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> keyList = ArrayList&lt;String&gt;()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> cache = LruCache&lt;String, Drawable&gt;(CACHE_SIZE)</span><br><span class="line">    <span class="comment">// è¡¨æƒ…ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> map = hashMapOf(</span><br><span class="line">            <span class="string">"å¾®ç¬‘"</span> kto R.drawable.im_emoticon_wx,</span><br><span class="line">            <span class="string">"æ’‡å˜´"</span> kto R.drawable.im_emoticon_pz,</span><br><span class="line">            <span class="string">"è‰²"</span> kto R.drawable.im_emoticon_se,</span><br><span class="line">            <span class="string">"å¾—æ„"</span> kto R.drawable.im_emoticon_dy,</span><br><span class="line">            <span class="string">"å¤§å“­"</span> kto R.drawable.im_emoticon_dk,</span><br><span class="line">            <span class="string">"å‘å‘†"</span> kto R.drawable.im_emoticon_fd,</span><br><span class="line"></span><br><span class="line">            <span class="string">"é—­å˜´"</span> kto R.drawable.im_emoticon_bz,</span><br><span class="line">            <span class="string">"ç¡"</span> kto R.drawable.im_emoticon_shui,</span><br><span class="line">            <span class="string">"æµæ³ª"</span> kto R.drawable.im_emoticon_ll,</span><br><span class="line">            <span class="string">"å°´å°¬"</span> kto R.drawable.im_emoticon_gg,</span><br><span class="line">            <span class="string">"å‘æ€’"</span> kto R.drawable.im_emoticon_fn,</span><br><span class="line">            <span class="string">"è°ƒçš®"</span> kto R.drawable.im_emoticon_tb,</span><br><span class="line"></span><br><span class="line">            <span class="string">"æƒŠè®¶"</span> kto R.drawable.im_emoticon_jy,</span><br><span class="line">            <span class="string">"å›§"</span> kto R.drawable.im_emoticon_jiong,</span><br><span class="line">            <span class="string">"å"</span> kto R.drawable.im_emoticon_tu,</span><br><span class="line">            <span class="string">"å“‡"</span> kto R.drawable.im_emoticon_wa,</span><br><span class="line">            <span class="string">"å·ç¬‘"</span> kto R.drawable.im_emoticon_tx,</span><br><span class="line">            <span class="string">"æ„‰å¿«"</span> kto R.drawable.im_emoticon_yk,</span><br><span class="line"></span><br><span class="line">            <span class="string">"ç™½çœ¼"</span> kto R.drawable.im_emoticon_by,</span><br><span class="line">            <span class="string">"ææƒ§"</span> kto R.drawable.im_emoticon_kj,</span><br><span class="line">            <span class="string">"è¡°"</span> kto R.drawable.im_emoticon_shuai,</span><br><span class="line">            <span class="string">"ç¬‘å“­"</span> kto R.drawable.im_emoticon_kx,</span><br><span class="line">            <span class="string">"æ— è¯­"</span> kto R.drawable.im_emoticon_ww,</span><br><span class="line">            <span class="string">"æ™•"</span> kto R.drawable.im_emoticon_yun,</span><br><span class="line"></span><br><span class="line">            <span class="string">"å›°"</span> kto R.drawable.im_emoticon_kun,</span><br><span class="line">            <span class="string">"äº²äº²"</span> kto R.drawable.im_emoticon_qq,</span><br><span class="line">            <span class="string">"åº†ç¥"</span> kto R.drawable.im_emoticon_qz,</span><br><span class="line">            <span class="string">"æ±—"</span> kto R.drawable.im_emoticon_han,</span><br><span class="line">            <span class="string">"å’’éª‚"</span> kto R.drawable.im_emoticon_zm,</span><br><span class="line">            <span class="string">"å˜˜"</span> kto R.drawable.im_emoticon_xu,</span><br><span class="line"></span><br><span class="line">            <span class="string">"å¯æ€œ"</span> kto R.drawable.im_emoticon_kl,</span><br><span class="line">            <span class="string">"å¤±æœ›"</span> kto R.drawable.im_emoticon_sw,</span><br><span class="line">            <span class="string">"æ†¨ç¬‘"</span> kto R.drawable.im_emoticon_hx,</span><br><span class="line">            <span class="string">"å‘²ç‰™"</span> kto R.drawable.im_emoticon_cy,</span><br><span class="line">            <span class="string">"æ‹¥æŠ±"</span> kto R.drawable.im_emoticon_yb,</span><br><span class="line">            <span class="string">"æ€è€ƒ"</span> kto R.drawable.im_emoticon_sk,</span><br><span class="line"></span><br><span class="line">            <span class="string">"å£ç½©"</span> kto R.drawable.im_emoticon_kz,</span><br><span class="line">            <span class="string">"æ‚ é—²"</span> kto R.drawable.im_emoticon_yxi,</span><br><span class="line">            <span class="string">"å§”å±ˆ"</span> kto R.drawable.im_emoticon_wq,</span><br><span class="line">            <span class="string">"åèˆŒå¤´"</span> kto R.drawable.im_emoticon_tst,</span><br><span class="line">            <span class="string">"é¬¼è„¸"</span> kto R.drawable.im_emoticon_gl,</span><br><span class="line">            <span class="string">"é˜´é™©"</span> kto R.drawable.im_emoticon_yx,</span><br><span class="line"></span><br><span class="line">            <span class="string">"å•¤é…’"</span> kto R.drawable.im_emoticon_pj,</span><br><span class="line">            <span class="string">"ç«ç‘°"</span> kto R.drawable.im_emoticon_mg,</span><br><span class="line">            <span class="string">"å‡‹è°¢"</span> kto R.drawable.im_emoticon_dx,</span><br><span class="line">            <span class="string">"å¤ªé˜³"</span> kto R.drawable.im_emoticon_ty,</span><br><span class="line">            <span class="string">"ç«"</span> kto R.drawable.im_emoticon_huo,</span><br><span class="line">            <span class="string">"ç¤¼ç‰©"</span> kto R.drawable.im_emoticon_lw,</span><br><span class="line"></span><br><span class="line">            <span class="string">"çˆ±å¿ƒ"</span> kto R.drawable.im_emoticon_ax,</span><br><span class="line">            <span class="string">"å¿ƒç¢"</span> kto R.drawable.im_emoticon_xs,</span><br><span class="line">            <span class="string">"å¼º"</span> kto R.drawable.im_emoticon_qiang,</span><br><span class="line">            <span class="string">"å¼±"</span> kto R.drawable.im_emoticon_ruo,</span><br><span class="line">            <span class="string">"é¼“æŒ"</span> kto R.drawable.im_emoticon_gz,</span><br><span class="line">            <span class="string">"OK"</span> kto R.drawable.im_emoticon_ok,</span><br><span class="line"></span><br><span class="line">            <span class="string">"è›‹ç³•"</span> kto R.drawable.im_emoticon_dg,</span><br><span class="line">            <span class="string">"åˆå"</span> kto R.drawable.im_emoticon_h10,</span><br><span class="line">            <span class="string">"èƒœåˆ©"</span> kto R.drawable.im_emoticon_sl,</span><br><span class="line">            <span class="string">"æ¡æ‰‹"</span> kto R.drawable.im_emoticon_ws,</span><br><span class="line">            <span class="string">"çº¢åŒ…"</span> kto R.drawable.im_emoticon_hb,</span><br><span class="line">            <span class="string">"é’±"</span> kto R.drawable.im_emoticon_qian</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬æ¢è¡¨æƒ…ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">transEmoticon</span><span class="params">(context: <span class="type">Context</span>, text: <span class="type">CharSequence</span>, size: <span class="type">Float</span>)</span></span>: Spannable &#123;</span><br><span class="line">        <span class="keyword">val</span> ss = SpannableString.valueOf(text)!!</span><br><span class="line">        spanEmoticon(context, ss, <span class="number">0</span>, ss.length, size)</span><br><span class="line">        <span class="keyword">return</span> ss</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * span è¡¨æƒ…ã€‚è¿”å›æœ€åä¸€ä¸ªspançš„æœ«å°¾ä½ç½®ï¼ˆä¸åŒ…å«ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">spanEmoticon</span><span class="params">(context: <span class="type">Context</span>, sp: <span class="type">Spannable</span>, startSp: <span class="type">Int</span>, endSp: <span class="type">Int</span>, size: <span class="type">Float</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (endSp - startSp &lt;= <span class="number">2</span>) <span class="keyword">return</span> startSp</span><br><span class="line">        <span class="keyword">var</span> last = startSp</span><br><span class="line">        <span class="keyword">val</span> wh = size.toZoom()</span><br><span class="line">        <span class="keyword">var</span> start = sp.indexOf(SIGN_LEFT, startSp)</span><br><span class="line">        <span class="keyword">while</span> (start &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> end = sp.indexOf(SIGN_RIGHT, start)</span><br><span class="line">            <span class="keyword">if</span> (end &lt;= start || end &gt;= endSp) <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">val</span> key = sp.substring(start + <span class="number">1</span>, end)</span><br><span class="line">            <span class="keyword">if</span> (key <span class="keyword">in</span> map.keys) &#123;</span><br><span class="line">                <span class="keyword">val</span> drawable = getDrawable(context, key, wh) ?: <span class="keyword">continue</span></span><br><span class="line">                sp.setSpan(ImageSpan(drawable), start, end + <span class="number">1</span>, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE)</span><br><span class="line">                last = end + <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            start = sp.indexOf(SIGN_LEFT, start + <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> last</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–è¡¨æƒ…åˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getEmoticonList</span><span class="params">()</span></span>: List&lt;Emoticon&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> keyList.map &#123; Emoticon(it, it.toCode(), map[it] ?: def) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Emoticon</span></span>(<span class="keyword">val</span> key: String, <span class="keyword">val</span> code: String, <span class="meta">@DrawableRes</span> <span class="keyword">val</span> resId: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//---------private method-----------//</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å– Drawable å¹¶æ ¹æ® key å’Œ å¤§å° ç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getDrawable</span><span class="params">(context: <span class="type">Context</span>, key: <span class="type">String</span>, size: <span class="type">Int</span>)</span></span>: Drawable? &#123;</span><br><span class="line">        <span class="keyword">return</span> cache[key + size] ?: ContextCompat.getDrawable(context, map[key] ?: def)?.apply &#123;</span><br><span class="line">            cache.put(key + size, <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">this</span>.setBounds(<span class="number">0</span>, <span class="number">0</span>, size, size)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬æ¢æˆ codeã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">toCode</span><span class="params">()</span></span> = SIGN_LEFT + <span class="keyword">this</span> + SIGN_RIGHT</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼©æ”¾å¤§å°ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="built_in">Float</span>.<span class="title">toZoom</span><span class="params">()</span></span> = (<span class="keyword">this</span> * ZOOM_SIZE).toInt()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * K-V å¯¹ï¼ŒåŒæ—¶ä¿å­˜ keyã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">kto</span><span class="params">(that: <span class="type">Int</span>)</span></span>: Pair&lt;String, <span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">        keyList.add(<span class="keyword">this</span>)</span><br><span class="line">        <span class="keyword">return</span> Pair(<span class="keyword">this</span>, that)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸»è¦å°±æ˜¯åšä¸€ä¸ªè½¬æ¢åŠŸèƒ½ã€‚åŒæ—¶éœ€è¦è€ƒè™‘ä¸€ä¸‹æ€§èƒ½ä¼˜åŒ–ï¼Œå¦åˆ™æ•ˆç‡ä½å°±ä¼šå¡é¡¿ã€‚</p><p>PSï¼šè¿™é‡Œä¼˜åŒ–äº† æŸ¥è¯¢è½¬æ¢ç­–ç•¥ å’Œ Drawableå¤ç”¨ç­–ç•¥ï¼Œä¾›å‚è€ƒã€‚</p><p><strong>æ³¨</strong>ï¼šSpannableæœ‰å…³çš„æ“ä½œï¼Œå°‘ç”¨Stringã€‚ä½¿ç”¨CharSequenceï¼Œå› ä¸ºä¸ä¸€å®šæ˜¯Stringã€‚ç”¨<code>SpannableString.valueOf(text)</code>  ä»£æ›¿<code>new SpannableString(text)</code></p><h3 id="ä½¿ç”¨ï¼š"><a href="#ä½¿ç”¨ï¼š" class="headerlink" title="ä½¿ç”¨ï¼š"></a>ä½¿ç”¨ï¼š</h3><p>åœ¨TextViewä¸Šä½¿ç”¨ï¼Œä¹Ÿå†™ä¸ªBindingAdapteræ–¹æ³•ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(value = [<span class="meta-string">"binding_text_emoticon"</span>], requireAll = true)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> TextView.<span class="title">setEmoticonText</span><span class="params">(text: <span class="type">CharSequence</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.text?.toString() != text) &#123;</span><br><span class="line">        <span class="keyword">this</span>.text = <span class="keyword">if</span> (text != <span class="literal">null</span>) &#123;</span><br><span class="line">            EmoticonHelper.transEmoticon(context, text, textSize)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BindingAdapter(value = [<span class="meta-string">"binding_text_emoticon"</span>, <span class="meta-string">"binding_text_emoticon_ellipsize"</span>], requireAll = true)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> TextView.<span class="title">setEmoticonText</span><span class="params">(text: <span class="type">CharSequence</span>?, avail: <span class="type">Float</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.text?.toString() != text) &#123;</span><br><span class="line">        <span class="keyword">this</span>.text = <span class="keyword">if</span> (text != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> emo = EmoticonHelper.transEmoticon(context, text, textSize)</span><br><span class="line">            TextUtils.ellipsize(emo, paint, avail, TextUtils.TruncateAt.END)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå…¶ä¸­<code>TextUtils.ellipsize(emo, paint, avail, TextUtils.TruncateAt.END)</code> æ˜¯ä¸ºäº†è§£å†³è¡¨æƒ…åœ¨å•è¡ŒtextViewæ˜¾ç¤ºä¸ä¸‹æ—¶æ˜¾â€œâ€¦â€.çš„é—®é¢˜ã€‚ç›´æ¥é»˜è®¤ç”¨TextViewçš„<code>ellipsize</code>å±æ€§ï¼Œå¯¹è¡¨æƒ…ï¼ˆImageSpanï¼‰æ— æ•ˆï¼Œä¼šæˆªæˆåŠä¸ªã€‚</p><h3 id="è¾“å…¥æ¡†ï¼š"><a href="#è¾“å…¥æ¡†ï¼š" class="headerlink" title="è¾“å…¥æ¡†ï¼š"></a>è¾“å…¥æ¡†ï¼š</h3><p>è¡¨æƒ…è¦åœ¨è¾“å…¥æ¡†ä¸­æ˜¾ç¤ºã€‚æ ¹æ®è¾“å…¥codeï¼Œè‡ªåŠ¨è½¬æ¢æˆè¡¨æƒ…ï¼ˆImageSpanï¼‰ã€‚</p><p>æ–¹æ¡ˆ1ï¼šç»™EditViewè®¾ç½®ç›‘å¬ï¼Œåœ¨æ–‡å­—å˜åŒ–åå°†æ–‡å­—åšä¸ªè½¬æ¢ã€‚è¿™æ ·æ•ˆç‡è¶…ä½ï¼Œè¾“å…¥è¶Šå¤šè¶Šå¡ã€‚å¦å†³ï¼</p><p>æ–¹æ¡ˆ2ï¼šæ ¹æ®å…·ä½“å˜åŒ–çš„æ–‡æœ¬è®¾ç½®è½¬æ¢ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">editText.addTextChangedListener(<span class="keyword">object</span> : TextWatcher &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">afterTextChanged</span><span class="params">(s: <span class="type">Editable</span>?)</span></span> &#123;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">beforeTextChanged</span><span class="params">(s: <span class="type">CharSequence</span>?, start: <span class="type">Int</span>, count: <span class="type">Int</span>, after: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onTextChanged</span><span class="params">(s: <span class="type">CharSequence</span>?, start: <span class="type">Int</span>, before: <span class="type">Int</span>, count: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (s !<span class="keyword">is</span> Spannable) <span class="keyword">return</span></span><br><span class="line">                <span class="comment">// è¾“å…¥ä¼šèƒ½å½±å“åˆ°çš„åŒ…å«å‰åå‡ æ ¼ã€‚</span></span><br><span class="line">                <span class="keyword">val</span> end = start + count</span><br><span class="line">                <span class="keyword">val</span> sl = s.lastIndexOf(<span class="string">'['</span>, start)</span><br><span class="line">                <span class="keyword">val</span> st = <span class="keyword">if</span> (sl &gt; <span class="number">-1</span> &amp;&amp; start &lt;= s.indexOf(<span class="string">']'</span>, sl)) &#123;</span><br><span class="line">                    sl</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    start</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">val</span> er = s.indexOf(<span class="string">']'</span>, end)</span><br><span class="line">                <span class="keyword">val</span> en = <span class="keyword">if</span> (er &gt; <span class="number">-1</span> &amp;&amp; s.lastIndexOf(<span class="string">'['</span>, er) <span class="keyword">in</span> <span class="number">0</span> until end) &#123;</span><br><span class="line">                    er + <span class="number">1</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    end</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">val</span> last = EmoticonHelper.spanEmoticon(editText.context, s, st, en, editText.textSize)</span><br><span class="line">                <span class="comment">// å¦‚æœè¾“å…¥å½±å“åå‡ æ ¼ï¼Œå³è¿åŒåå‡ æ ¼ä¸€èµ·å˜æˆè¡¨æƒ…ã€‚å°†å…‰æ ‡ç½®äºè¡¨æƒ…æœ«å°¾ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (last &gt; end &amp;&amp; last &lt;= s.length) &#123;</span><br><span class="line">                    Selection.setSelection(s, last)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šå½“å‰è¾“å…¥çš„ä¸œè¥¿ï¼ˆå¯èƒ½æ˜¯å¤åˆ¶è¿‡æ¥çš„å¤šä¸ªå­—ç¬¦ï¼‰ã€‚å¯èƒ½ä¼šå½±å“åˆ°å‰é¢æˆ–åé¢çš„å‡ ä¸ªå­—ç¬¦ã€‚</p><blockquote><p>ä¾‹å¦‚ï¼šåŸæœ¬æ–‡æœ¬ï¼šâ€œ[å¾®]â€ ,åœ¨â€œå¾®â€åé¢è¾“å…¥ä¸€ä¸ªâ€œç¬‘â€ï¼Œå®é™…æ–‡æœ¬æ˜¯â€œ[å¾®ç¬‘]â€æ»¡è¶³codeã€‚å°±ä¼šè‡ªåŠ¨è½¬å˜æˆğŸ˜Šè¡¨æƒ…ã€‚<br>æ­¤æ—¶ï¼Œå…‰æ ‡åœ¨â€œç¬‘â€åé¢ï¼Œéœ€è¦ä»£ç æ§åˆ¶æŠŠå…‰æ ‡æŒªåˆ°â€œ]â€çš„åé¢ã€‚æ‰ç¬¦åˆå®é™…è¾“å…¥æ•ˆæœã€‚</p></blockquote><p><strong>è¡¨æƒ…é€‰æ‹©æ¡†æ“ä½œ</strong>ï¼š</p><p>åˆ é™¤ï¼šæ¨¡æ‹Ÿé€€æ ¼ï¼Œè¡¨æƒ…éœ€è¦æ•´ä¸ªæ•´ä¸ªåˆ ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">editText</span><span class="selector-class">.dispatchKeyEvent</span>(<span class="selector-tag">KeyEvent</span>(<span class="selector-tag">KeyEvent</span><span class="selector-class">.ACTION_DOWN</span>, <span class="selector-tag">KeyEvent</span><span class="selector-class">.KEYCODE_DEL</span>))</span><br></pre></td></tr></table></figure></p><p>æ’å…¥ï¼šå°†codeæ’å…¥åˆ°å…‰æ ‡æœ«å°¾ã€‚<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">editText.<span class="built_in">run</span> &#123; <span class="built_in">text</span>.insert(selectionEnd, code) &#125;</span><br></pre></td></tr></table></figure></p><h3 id="å…¶ä»–ï¼š"><a href="#å…¶ä»–ï¼š" class="headerlink" title="å…¶ä»–ï¼š"></a>å…¶ä»–ï¼š</h3><p>è½¬å‘åˆ°å¾®ä¿¡ï¼Œæœ‰äº›è¡¨æƒ…å¾®ä¿¡é‡Œæ²¡æœ‰å¯¹åº”ã€‚è½¬æ¢æˆemojiä»£æ›¿ã€‚</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è½¬å‘å¾®ä¿¡éœ€è¦æ›¿æ¢æˆ emoji çš„è¡¨æƒ…ã€‚</span></span><br><span class="line"><span class="built_in">private</span> val emojiMap = hashMapOf(</span><br><span class="line">        <span class="string">"ææƒ§"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE31"</span>,</span><br><span class="line">        <span class="string">"ç¬‘å“­"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE02"</span>,</span><br><span class="line">        <span class="string">"æ— è¯­"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE12"</span>,</span><br><span class="line">        <span class="string">"åº†ç¥"</span> <span class="keyword">to</span> <span class="string">"\uD83C\uDF89"</span>,</span><br><span class="line">        <span class="string">"å¤±æœ›"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE14"</span>,</span><br><span class="line">        <span class="string">"æ€è€ƒ"</span> <span class="keyword">to</span> <span class="string">"\uD83E\uDD14"</span>,</span><br><span class="line">        <span class="string">"å£ç½©"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE37"</span>,</span><br><span class="line">        <span class="string">"åèˆŒå¤´"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE1D"</span>,</span><br><span class="line">        <span class="string">"é¬¼è„¸"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDC7B"</span>,</span><br><span class="line">        <span class="string">"ç«"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDD25"</span>,</span><br><span class="line">        <span class="string">"åˆå"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDE4F"</span>,</span><br><span class="line">        <span class="string">"é’±"</span> <span class="keyword">to</span> <span class="string">"\uD83D\uDCB0"</span>,</span><br><span class="line">        <span class="string">"ç¤¼ç‰©"</span> <span class="keyword">to</span> <span class="string">"\uD83C\uDF81"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è½¬å‘å¾®ä¿¡ã€‚ä¸æ”¯æŒçš„ code è½¬åŒ–ä¸º emoji ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">fun transCodeToEmoji(<span class="built_in">text</span>: String): String &#123;</span><br><span class="line">    var <span class="built_in">str</span> = <span class="built_in">text</span></span><br><span class="line">    <span class="keyword">for</span> (key <span class="built_in">in</span> emojiMap.keys) &#123;</span><br><span class="line">        val code = key.toCode()</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">str</span>.contains(code)) &#123;</span><br><span class="line">            <span class="built_in">str</span> = <span class="built_in">str</span>.replace(code, emojiMap[key].orEmpty())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return <span class="built_in">str</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>è¦ç‚¹ï¼š</p><ol><li>ImageSpanå®ç°è¡¨æƒ…çš„æ˜¾ç¤ºã€‚ğŸ˜Š</li><li>codeä¸Drawableçš„å¯¹åº”å…³ç³»ã€‚</li><li>Drawableæ€§èƒ½çš„è€ƒé‡ã€‚</li><li>è¡¨æƒ…åœ¨EditTexté‡Œè¾“å…¥çš„å‡ ä¸ªä¼˜åŒ–ç‚¹ã€‚</li><li>å¾®ä¿¡è½¬å‘æ—¶æ›¿æ¢codeã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h3&gt;&lt;p&gt;åœ¨imé¡¹ç›®ï¼ˆAndroidï¼‰ä¸­ï¼Œç”¨æˆ·å‘æ¶ˆæ¯ï¼Œå–œæ¬¢åœ¨æ–‡å­—ä¸­åµŒå…¥ä¸€äº›å°è¡¨æƒ…ï¼Œä»¥è¡¨è¾¾å‘é€è€…å½“æ—¶çš„æƒ…æ„Ÿã€‚é™¤äº†ç³»ç»Ÿè¾“å…¥æ³•è‡ªå¸¦çš„emojiè¡¨æƒ…ï¼ˆemojiå…¶å®æ˜¯ç‰¹æ®Šçš„æ–‡å­—ï¼‰å¤–ã€‚é¡¹ç›®å¸Œæœ›å¸¦ä¸€äº›æ›´æ¼‚äº®ï¼Œå¸¦äº§å“ç‰¹è‰²æ–‡åŒ–çš„è‡ªå®šä¹‰å°è¡¨æƒ…ï¼ˆå°å›¾ç‰‡ï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>TextViewè¯†åˆ«æ–‡æœ¬ä¸­çš„è¶…é“¾æ¥å¹¶èƒ½ç‚¹å‡»è·³è½¬</title>
    <link href="https://wzmyyj.top/2020/05/12/android_6/"/>
    <id>https://wzmyyj.top/2020/05/12/android_6/</id>
    <published>2020-05-12T02:20:30.000Z</published>
    <updated>2020-07-21T03:09:48.048Z</updated>
    
    <content type="html"><![CDATA[<h4 id="éœ€æ±‚ï¼š"><a href="#éœ€æ±‚ï¼š" class="headerlink" title="éœ€æ±‚ï¼š"></a>éœ€æ±‚ï¼š</h4><p>å¦‚é¢˜æ‰€è¯‰ã€‚éœ€è¦è¯†åˆ«å‡ºæ–‡æœ¬ä¸­çš„é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæˆè¶…é“¾æ¥çš„UIæ ·å¼ã€‚ç‚¹å‡»èƒ½å¤Ÿè·³è½¬æ‰“å¼€ç½‘é¡µï¼ˆæœ€å¥½æ˜¯è‡ªå·±appå†…éƒ¨çš„WebViewã€‚ï¼‰</p><a id="more"></a><h4 id="ç®€å•å®ç°ï¼š"><a href="#ç®€å•å®ç°ï¼š" class="headerlink" title="ç®€å•å®ç°ï¼š"></a>ç®€å•å®ç°ï¼š</h4><p>åœ¨ xml é‡Œç»™TextView è®¾ç½®:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView </span><br><span class="line">    android:<span class="attribute">autoLink</span>=<span class="string">"web"</span></span><br><span class="line">    android:<span class="attribute">linksClickable</span>=<span class="string">"true"</span></span><br><span class="line">    android:<span class="attribute">textColorLink</span>=<span class="string">"@color/color_017EBD"</span></span><br><span class="line"><span class="built_in">..</span>./&gt;</span><br></pre></td></tr></table></figure><p> ç®€å•ï¼Œä½†æ˜¯æœ‰å¾ˆå¤§çš„ç¼ºç‚¹ï¼š</p><ol><li>é“¾æ¥ä¸‹çš„ä¸‹åˆ’çº¿å»ä¸æ‰ã€‚</li><li>åªèƒ½è·³è½¬åˆ°ç³»ç»Ÿé»˜è®¤çš„æµè§ˆå™¨ã€‚</li><li>é“¾æ¥åé¢ä¸ä½³ç©ºæ ¼æœ‰ä¸­æ–‡å°±è¯†åˆ«ä¸å‡ºæ¥ã€‚</li></ol><p>è™½ç„¶å®ƒä¸å¥½ã€‚ä½†å®ƒæ˜¯ç³»ç»Ÿè‡ªå¸¦çš„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹çœ‹å®ƒçš„å®ç°åŸç†ï¼Œå¯ä»¥å…³é”®åœ°æ–¹æ”¹å†™å®ƒã€‚</p><h4 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h4><p>æ ¹æ®æ‰€å­¦çŸ¥è¯†ã€‚æƒ³å¿…ä¹Ÿæ˜¯ClickableSpançš„ä¸€ç§å®é™…ä½¿ç”¨ç½¢äº†ã€‚å¯ä»¥å…ˆçœ‹çœ‹ï¼š<a href="https://www.jianshu.com/p/c53e24b715e2" target="_blank" rel="noopener">ClickableSpançš„ä¸€ç‚¹ç‚¹æ‘¸ç´¢</a> ã€‚</p><p><strong>å…³é”®ç±»ï¼š</strong></p><ol><li>URLSpanï¼šClickableSpançš„å­ç±»ï¼Œå¸¦URLï¼Œä¸‹åˆ’çº¿å»ä¸æ‰ã€‚</li><li>LinkMovementMethodï¼šClickableSpanç”Ÿæ•ˆæ‰€éœ€ï¼Œä¹‹å‰è®²äº†ã€‚</li><li>Linkifyï¼šä¸€ä¸ªè¯†åˆ«æ–‡å­—ä¸­é“¾æ¥ï¼Œåœ°å€ï¼Œé‚®ç®±ä¹‹ç±»çš„å·¥å…·ç±»ã€‚</li></ol><p>å‰é¢ä¸¤ä¸ªçœ‹ClickableSpané‚£ç¯‡å°±ç†è§£äº†ã€‚é‡ç‚¹çœ‹Linkifyã€‚</p><h3 id="Linkifyï¼š"><a href="#Linkifyï¼š" class="headerlink" title="Linkifyï¼š"></a>Linkifyï¼š</h3><blockquote><p><em>Linkify take a piece of text and a regular expression and turns all of the regex matches in the text into clickable links.  This is particularly useful for matching things like email addresses, web URLs, etc. and making  them actionable.</em></p></blockquote><p>Linkifyæ˜¯ä¸€ä¸ªè¾…åŠ©ç±»ï¼Œé€šè¿‡RegExæ ·å¼åŒ¹é…ï¼Œè‡ªåŠ¨åœ°åœ¨TextViewç±»ï¼ˆå’Œç»§æ‰¿çš„ç±»ï¼‰ä¸­åˆ›å»ºè¶…é“¾æ¥ã€‚</p><p>å®ƒçš„æ–¹æ³•publicæ–¹æ³•æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ã€‚åªéœ€è¦äº†è§£å®ƒçš„ä¸»è¦åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨å®ƒå®ç°è¶…é“¾æ¥çš„è¯†åˆ«ã€‚å†™ä¸ªå·¥å…·ç±»ã€‚</p><h4 id="å·¥å…·ç±»ï¼š"><a href="#å·¥å…·ç±»ï¼š" class="headerlink" title="å·¥å…·ç±»ï¼š"></a>å·¥å…·ç±»ï¼š</h4><p>æˆ‘ä»¬åªéœ€è¦è‡ªå®šä¹‰RegExå°±å¯ä»¥å®ç°æˆ‘ä»¬è‡ªå·±çš„è¯†åˆ«è¶…é“¾æ¥è§„åˆ™ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> HyperLinkHelper &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> REGEX = <span class="string">"(((http[s]?|ftp?|file?)://)?[a-zA-Z0-9.\\-]+\\.([a-zA-Z]&#123;2,4&#125;)(:\\d+)?(/[a-zA-Z0-9.\\-~!@#$%^&amp;*+?:_/=&lt;&gt;]*)?)|(www.[a-zA-Z0-9.\\-]+\\.([a-zA-Z]&#123;2,4&#125;)(:\\d+)?(/[a-zA-Z0-9.\\-~!@#$%^&amp;*+?:_/=&lt;&gt;]*)?)"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è½¬æ¢æˆé“¾æ¥ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">transUrlSpan</span><span class="params">(text: <span class="type">CharSequence</span>, <span class="meta">@ColorInt</span> highColor: <span class="type">Int</span> = <span class="number">-0xa8946b</span>)</span></span>: Spannable &#123;</span><br><span class="line">        <span class="keyword">val</span> ss = SpannableString.valueOf(text)</span><br><span class="line">        Linkify.addLinks(ss, Pattern.compile(REGEX), <span class="string">""</span>)</span><br><span class="line">        <span class="keyword">val</span> urlSpans = ss.getSpans(<span class="number">0</span>, ss.length,</span><br><span class="line">                URLSpan::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>) ?: <span class="type">return ss</span></span></span><br><span class="line">        <span class="keyword">for</span> (sp <span class="keyword">in</span> urlSpans) &#123;</span><br><span class="line">            <span class="keyword">val</span> start = ss.getSpanStart(sp)</span><br><span class="line">            <span class="keyword">val</span> end = ss.getSpanEnd(sp)</span><br><span class="line">            ss.removeSpan(sp)</span><br><span class="line">            ss.setSpan(UrlLinkSpan(sp.url.formatUrl(), highColor), start, end, Spannable.SPAN_INCLUSIVE_EXCLUSIVE)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ss</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®ç‚¹å‡»äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setClickListener</span><span class="params">(spanned: <span class="type">Spanned</span>, listener: <span class="type">UrlLinkSpan</span>.<span class="type">OnClickListener</span>)</span></span> &#123;</span><br><span class="line">        spanned.getSpans(<span class="number">0</span>, spanned.length, UrlLinkSpan::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">                .forEach &#123; it.listener = listener &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">formatUrl</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span> (indexOf(<span class="string">"http"</span>) != <span class="number">0</span></span><br><span class="line">                &amp;&amp; indexOf(<span class="string">"ftp"</span>) != <span class="number">0</span></span><br><span class="line">                &amp;&amp; indexOf(<span class="string">"file"</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="string">"http://<span class="variable">$this</span>"</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¹¶æŠŠURLSpanæ›¿æ¢æˆæ ·å¼éœ€è¦çš„Spanã€‚</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">UrlLinkSpan</span></span>(<span class="keyword">val</span> url: String, <span class="meta">@ColorInt</span> <span class="keyword">val</span> highColor: <span class="built_in">Int</span>) : ClickableSpan() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> listener: OnClickListener? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">interface</span> <span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">fun</span> <span class="title">onUrlLinkClick</span><span class="params">(widget: <span class="type">View</span>, url: <span class="type">String</span>)</span></span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(widget: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">            listener?.onUrlLinkClick(widget, url)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">updateDrawState</span><span class="params">(ds: <span class="type">TextPaint</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">super</span>.updateDrawState(ds)</span><br><span class="line">            ds.color = highColor</span><br><span class="line">            ds.isUnderlineText = <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p> æ•´ä¸€ä¸ª BindingAdapter æ–¹æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(value = [<span class="meta-string">"binding_text_url_link"</span>, <span class="meta-string">"binding_url_link_listener"</span>], requireAll = true)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> TextView.<span class="title">setUrlLinkText</span><span class="params">(text: <span class="type">CharSequence</span>?, listener: <span class="type">HyperLinkHelper</span>.<span class="type">UrlLinkSpan</span>.<span class="type">OnClickListener</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.text?.toString() != text) &#123;</span><br><span class="line">        <span class="keyword">this</span>.text = <span class="keyword">if</span> (text != <span class="literal">null</span>) &#123;</span><br><span class="line">            HyperLinkHelper.transUrlSpan(text, getColor(R.color.color_017EBD)).apply &#123;</span><br><span class="line">                HyperLinkHelper.setClickListener(<span class="keyword">this</span>, listener)</span><br><span class="line">                movementMethod = ClickLinkMovementMethod</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ClickLinkMovementMethod æ˜¯ä¸ºäº†è§£å†³é•¿æŒ‰çš„é—®é¢˜ã€‚<a href="https://www.jianshu.com/p/c53e24b715e2" target="_blank" rel="noopener">ClickableSpançš„ä¸€ç‚¹ç‚¹æ‘¸ç´¢</a>é‚£ç¯‡æ–‡ç« æœ‰è®²ã€‚</p><h4 id="æ‰©å±•ï¼š"><a href="#æ‰©å±•ï¼š" class="headerlink" title="æ‰©å±•ï¼š"></a>æ‰©å±•ï¼š</h4><p>Linkifyè¿˜å¯ä»¥å®šä¹‰å¦‚ä¸‹æ¥å£ï¼š</p><ol><li><strong>Match Filterï¼š</strong>å®ç°acceptMatchæ–¹æ³•ï¼Œæ¥ä¸ºRegExæ ·å¼åŒ¹é…æ·»åŠ é¢å¤–çš„æ¡ä»¶ã€‚å½“ä¸€ä¸ªæ½œåœ¨çš„åŒ¹é…å‘ç°æ—¶ï¼ŒacceptMatchè¢«è§¦å‘ï¼ŒåŒ¹é…çš„å¼€å§‹ç‚¹å’Œç»“æŸç‚¹ï¼ˆåŒ…æ‹¬è¢«æŸ¥æ‰¾çš„æ•´ä¸ªæ–‡æœ¬ï¼‰ä»¥å‚æ•°çš„å½¢å¼ä¼ å…¥ã€‚</li><li><strong>Transform Filterï¼š</strong>ä¸ºæ ¼å¼åŒ–æ–‡æœ¬å­—ç¬¦ä¸²æä¾›æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå…è®¸ä½ ä¿®æ”¹ç”±é“¾æ¥æ–‡æœ¬è‡ªåŠ¨ç”Ÿæˆçš„éšå¼URIã€‚</li></ol><p>æœ‰å…´è¶£è‡ªå·±å»äº†è§£ã€‚</p><h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><p>è¦ç‚¹ï¼š</p><ol><li>æ­£åˆ™è¯†åˆ«é“¾æ¥</li><li>æ˜¾ç¤ºæ ·å¼è‡ªå®šä¹‰ï¼Œå»æ‰ä¸‹åˆ’çº¿ã€‚</li><li>ç‚¹å‡»é€»è¾‘è‡ªå®šä¹‰ï¼Œè·³è½¬åˆ°è‡ªå·±çš„WebViewã€‚</li><li>è§£å†³é•¿æŒ‰å†²çªé—®é¢˜ã€‚</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-e71299373be3b0e1.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;éœ€æ±‚ï¼š&quot;&gt;&lt;a href=&quot;#éœ€æ±‚ï¼š&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚ï¼š&quot;&gt;&lt;/a&gt;éœ€æ±‚ï¼š&lt;/h4&gt;&lt;p&gt;å¦‚é¢˜æ‰€è¯‰ã€‚éœ€è¦è¯†åˆ«å‡ºæ–‡æœ¬ä¸­çš„é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæˆè¶…é“¾æ¥çš„UIæ ·å¼ã€‚ç‚¹å‡»èƒ½å¤Ÿè·³è½¬æ‰“å¼€ç½‘é¡µï¼ˆæœ€å¥½æ˜¯è‡ªå·±appå†…éƒ¨çš„WebViewã€‚ï¼‰&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>ClickableSpançš„ä¸€ç‚¹ç‚¹æ‘¸ç´¢</title>
    <link href="https://wzmyyj.top/2020/05/12/android_5/"/>
    <id>https://wzmyyj.top/2020/05/12/android_5/</id>
    <published>2020-05-12T01:04:30.000Z</published>
    <updated>2020-07-21T03:07:51.484Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ClickableSpan"><a href="#ClickableSpan" class="headerlink" title="ClickableSpan"></a>ClickableSpan</h2><p>ClickableSpan ç”¨æ¥å®ç° TextViewé‡Œçš„æ–‡å­—å±€éƒ¨çš„é«˜äº®å’Œç‚¹å‡»äº‹ä»¶ã€‚</p><a id="more"></a><p>ä»‹ç»ï¼š</p><blockquote><p>If an object of this type is attached to the text of a TextView with a movement method of <strong>LinkMovementMethod</strong>, the affected spans of text can be selected. If selected and clicked, the {@link #<strong>onClick</strong>} method will* be called.</p></blockquote><p>æ„æ€æ˜¯è¿™ä¸œè¥¿åŠ åˆ°TextViewä¸Šï¼Œå¹¶è®¾ç½®LinkMovementMethodï¼Œå°±å¯ä»¥é€‰æ‹©æˆ–ç‚¹å‡»å¹¶å›è°ƒonClickæ–¹æ³•ã€‚<br>æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ClickableSpan</span> <span class="keyword">extends</span> <span class="title">CharacterStyle</span> <span class="keyword">implements</span> <span class="title">UpdateAppearance</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> sIdCounter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mId = sIdCounter++;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Performs the click action associated with this span.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(@NonNull View widget)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Makes the text underlined and in the link color.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateDrawState</span><span class="params">(@NonNull TextPaint ds)</span> </span>&#123;</span><br><span class="line">        ds.setColor(ds.linkColor);</span><br><span class="line">        ds.setUnderlineText(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the unique ID for this span.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The unique ID.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@hide</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æºç æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯èƒ½æ”¹å˜æ–‡å­—æ ·å¼çš„åŒæ—¶æœ‰ä¸ªonClickæŠ½è±¡æ–¹æ³•ã€‚</p><h4 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h4><p><strong>é—®é¢˜ï¼š</strong><br>ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸åœ¨vmå±‚ï¼ˆvmé‡Œæˆ–è€… vmçš„è¾…åŠ©é€»è¾‘ç±»é‡Œï¼‰è®¾ç½®æ•°æ®ï¼ˆæ¯”å¦‚SpannableStringï¼‰ï¼Œå¦‚æœè®¾ç½®çš„æ˜¯ClickableSpanã€‚è®¾ç½®æ ·å¼å¤–ï¼Œè¿˜éœ€è¦å®ç°onClickæ–¹æ³•ï¼Œå³ç‚¹å‡»äº‹ä»¶ã€‚ç„¶è€Œç‚¹å‡»äº‹ä»¶å¾€å¾€æ˜¯UIå±‚çš„é€»è¾‘ã€‚ä¸€èˆ¬ä¸å…è®¸åœ¨vmå±‚å†™ç‚¹å‡»äº‹ä»¶é€»è¾‘ã€‚å‘ vmé‡Œä¼ ç‚¹å‡»äº‹ä»¶ï¼ˆå¾€å¾€æ˜¯å†…éƒ¨ç±»ä¼šæŒæœ‰fragmentï¼‰ï¼Œä¸æ˜¯å¾ˆå¯å–ã€‚<br><strong>ç›®æ ‡ï¼š</strong><br>æˆ‘å¸Œæœ›vmå±‚åªå¯¹æ•°æ®çš„è®¾ç½®ï¼ŒUIå±‚è®¾ç½®ç‚¹å‡»äº‹ä»¶ã€‚</p><p><strong>æ–¹æ¡ˆï¼š</strong><br>å®šä¹‰ä¸€ä¸ªå¯ä»¥è®¾ç½®äº‹ä»¶ï¼Œå¹¶æºå¸¦æ•°æ®çš„ ClickableSpanã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataClickSpan</span></span>(<span class="meta">@ColorInt</span> <span class="keyword">val</span> color: <span class="built_in">Int</span>) : ClickableSpan() &#123;</span><br><span class="line">    <span class="keyword">val</span> map = HashMap&lt;String, Any?&gt;()</span><br><span class="line">    <span class="keyword">var</span> listener: OnClickListener? = <span class="literal">null</span></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">onSpanClick</span><span class="params">(widget: <span class="type">View</span>, map: <span class="type">HashMap</span>&lt;<span class="type">String</span>, Any?&gt;)</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(widget: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">        listener?.onSpanClick(widget, map)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">updateDrawState</span><span class="params">(ds: <span class="type">TextPaint</span>)</span></span> &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®é¢œè‰²</span></span><br><span class="line">        ds.color = color</span><br><span class="line">        <span class="comment">//å»æ‰ä¸‹åˆ’çº¿</span></span><br><span class="line">        ds.isUnderlineText = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¾ç½®ç‚¹å‡»äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Spanned.<span class="title">setDataClickListener</span><span class="params">(listener: <span class="type">DataClickSpan</span>.<span class="type">OnClickListener</span>?)</span></span> &#123;</span><br><span class="line">    getSpans(<span class="number">0</span>, <span class="keyword">this</span>.length - <span class="number">1</span>, DataClickSpan::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">            .forEach &#123; it.listener = listener &#125;</span><br><span class="line">&#125;</span><br><span class="line">å†æ•´ä¸€ä¸ªBindingAdapteræ–¹æ³•ï¼š</span><br><span class="line"><span class="meta">@BindingAdapter(value = [<span class="meta-string">"binding_spanned_data"</span>, <span class="meta-string">"binding_spanned_clickListener"</span>], requireAll = true)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> TextView.<span class="title">setSpannedClickListenerOfString</span><span class="params">(<span class="keyword">data</span>: <span class="type">Spanned</span>?, listener: <span class="type">DataClickSpan</span>.<span class="type">OnClickListener</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">data</span>?.setDataClickListener(listener)</span><br><span class="line">    movementMethod = ClickLinkMovementMethod<span class="comment">// è¿™ä¸ªæ˜¯è‡ªå®šä¹‰LinkMovementMethod</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ä½¿ç”¨ï¼š</strong><br>vm å±‚ä½¿ç”¨ï¼Œè®¾ç½®æºå¸¦æ•°æ®ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æºå¸¦ imAccount</span></span><br><span class="line"><span class="function"><span class="title">SpannableString</span><span class="params">(<span class="string">"è¿™æ˜¯å¯ä»¥ç‚¹å‡»çš„æ–‡å­—"</span>)</span></span><span class="selector-class">.apply</span> &#123;</span><br><span class="line">                setSpan(DataClickSpan(getColor(R<span class="selector-class">.color</span><span class="selector-class">.color_576B95</span>))</span><br><span class="line">                        <span class="selector-class">.apply</span> &#123; map[IM_ACCOUNT] = joinGroupMsg<span class="selector-class">.inviteImAccount</span> &#125;,</span><br><span class="line">                        <span class="number">1</span>, length - <span class="number">1</span>, Spanned.SPAN_INCLUSIVE_EXCLUSIVE)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></p><p>UI å±‚ä½¿ç”¨ï¼Œè®¾ç½®äº‹ä»¶ï¼Œæ¯”å¦‚è¿™ä¸ªSpannableStringæ˜¯è®¾ç½®å†æŸä¸ªitemçš„TextView ä¸Šã€‚</p><ol><li>è®©è¿™ä¸ªItemçš„ VHModel çš„OnItemEventListenerç»§æ‰¿DataClickSpan.OnClickListener</li><li><p>å†å¸ƒå±€é‡Œè®¾ç½®ï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">TextView</span> </span></span></span><br><span class="line"><span class="xml">   binding_spanned_clickListener="@</span><span class="template-variable">&#123;listener&#125;</span><span class="xml">"</span></span><br><span class="line"><span class="xml">   binding_spanned_data="@</span><span class="template-variable">&#123;item.removeDesc&#125;</span><span class="xml">"</span></span><br><span class="line"><span class="xml">.../&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨Fragmenté‡Œå®ç°æ¥å£ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onSpanClick</span><span class="params">(widget: <span class="type">View</span>, map: <span class="type">HashMap</span>&lt;<span class="type">String</span>, Any?&gt;)</span></span> &#123;</span><br><span class="line">            <span class="keyword">val</span> imAccount = map[ConvertUtil.IM_ACCOUNT]</span><br><span class="line">            <span class="keyword">if</span> (imAccount <span class="keyword">is</span> String) &#123;</span><br><span class="line">                RouterManager.goImUser(UserParams(imAccount), <span class="string">"ChatFragment"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>ç»“è®ºï¼š</strong><br>æ²¡å•¥å¥½çš„ï¼Œå°±æ˜¯æ›²æŠ˜å»å®ç°åˆ†ç¦»è€Œå·²ã€‚</p><p>vm è¿˜æœ‰é—´æ¥ä¾èµ–Viewã€‚<br>vmæŒæœ‰SpannableStringï¼Œ<br>SpannableStringæŒæœ‰ClickableSpanï¼Œ<br>ClickableSpanæŒæœ‰listenerï¼Œ<br>listeneræŒæœ‰fragmentã€‚<br>emmmmâ€¦.</p><p>ClickableSpanè®¾è®¡å°±æ˜¯è¿™æ ·ã€‚é‚£å°±æ¥äº†è§£äº†è§£å®ƒçš„å®ç°åŸç†å§ã€‚</p><h4 id="LinkMovementMethodï¼š"><a href="#LinkMovementMethodï¼š" class="headerlink" title="LinkMovementMethodï¼š"></a>LinkMovementMethodï¼š</h4><p>ClickableSpanæºç ä¹Ÿçœ‹äº†ï¼Œæ˜¾ç„¶å®ƒä¸æ˜¯ä¸»è¦å…³é”®ã€‚é‚£æ˜¯è°å»è°ƒç”¨ClickableSpançš„onClickæ–¹æ³•ï¼Œæ€ä¹ˆå†³å®šè°ƒç”¨æ—¶æœºå‘¢ï¼Ÿ</p><p>ClickableSpanæ–‡ä»¶å¤´ä»‹ç»ä¸­ï¼Œå·²ä¾›å‡ºä¸»è°‹æ˜¯LinkMovementMethodï¼ˆæ˜¯ä¸€ä¸ªå•ä¾‹ï¼‰ã€‚</p><p>ç‚¹å‡»äº‹ä»¶ï¼Œæ˜¾ç„¶ç¦»ä¸å¼€onTachçš„æ–¹æ³•ã€‚LinkMovementMethodé‡Œæ­£å¥½æœ‰ï¼Œé‚£å°±å†³å®šæ˜¯å®ƒäº†ã€‚<br><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public boolean onTouchEvent(TextView widget, Spannable <span class="keyword">buffer</span>,</span><br><span class="line">                                MotionEvent event) &#123;</span><br><span class="line">        <span class="type">int</span> action = event.getAction();</span><br><span class="line">        <span class="keyword">if</span> (action == MotionEvent.ACTION_UP || action == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">            <span class="type">int</span> x = (<span class="type">int</span>) event.getX();</span><br><span class="line">            <span class="type">int</span> y = (<span class="type">int</span>) event.getY();</span><br><span class="line">            x -= widget.getTotalPaddingLeft();</span><br><span class="line">            y -= widget.getTotalPaddingTop();</span><br><span class="line">            x += widget.getScrollX();</span><br><span class="line">            y += widget.getScrollY();</span><br><span class="line">            <span class="comment">// æ‰¾è§¦ç¢°çš„ä½ç½®ã€‚</span></span><br><span class="line">            Layout <span class="keyword">layout</span> = widget.getLayout();</span><br><span class="line">            <span class="comment">// ç¬¬å‡ è¡Œã€‚</span></span><br><span class="line">            <span class="type">int</span> line = <span class="keyword">layout</span>.getLineForVertical(y);</span><br><span class="line">            <span class="comment">// ç¬¬å‡ ä¸ªå­—ç¬¦ã€‚</span></span><br><span class="line">            <span class="type">int</span> off = <span class="keyword">layout</span>.getOffsetForHorizontal(line, x);</span><br><span class="line">            <span class="comment">// æ‰¾å‡ºè§¦æ‘¸åˆ°çš„æ–‡æœ¬ä¸­çš„ ClickableSpanã€‚</span></span><br><span class="line">            ClickableSpan[] links = <span class="keyword">buffer</span>.getSpans(off, off, ClickableSpan.class);</span><br><span class="line">            <span class="keyword">if</span> (links.<span class="built_in">length</span> != <span class="number">0</span>) &#123;</span><br><span class="line">                ClickableSpan link = links[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (action == MotionEvent.ACTION_UP) &#123;</span><br><span class="line">                    <span class="comment">// ä¸è®¤è¯†ï¼Œä¸ç®¡å®ƒã€‚</span></span><br><span class="line">                    <span class="keyword">if</span> (link instanceof TextLinkSpan) &#123;</span><br><span class="line">                        ((TextLinkSpan) link).onClick(</span><br><span class="line">                                widget, TextLinkSpan.INVOCATION_METHOD_TOUCH);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// æ‰‹æŒ‡æŠ¬èµ·æ—¶å›è°ƒonClickæ–¹æ³•ã€‚</span></span><br><span class="line">                        link.onClick(widget);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">                    <span class="comment">// æŒ‰ä¸‹è®¾ç½®ä¸€ä¸‹é€‰ä¸­æ ·å¼ã€‚ä¹Ÿå°±æ˜¯å…‰æ ‡ã€‚</span></span><br><span class="line">                    <span class="keyword">if</span> (widget.getContext().getApplicationInfo().targetSdkVersion</span><br><span class="line">                            &gt;= Build.VERSION_CODES.P) &#123;</span><br><span class="line">                        <span class="comment">// Selection change will reposition the toolbar. Hide it for a few ms for a</span></span><br><span class="line">                        <span class="comment">// smoother transition.</span></span><br><span class="line">                        widget.hideFloatingToolbar(HIDE_FLOATING_TOOLBAR_DELAY_MS);</span><br><span class="line">                    &#125;</span><br><span class="line">                    Selection.setSelection(<span class="keyword">buffer</span>,</span><br><span class="line">                            <span class="keyword">buffer</span>.getSpanStart(link),</span><br><span class="line">                            <span class="keyword">buffer</span>.getSpanEnd(link));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æ¸…é™¤é€‰ä¸­æ ·å¼ã€‚ä¹Ÿå°±æ˜¯å…‰æ ‡ã€‚</span></span><br><span class="line">                Selection.removeSelection(<span class="keyword">buffer</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> super.onTouchEvent(widget, <span class="keyword">buffer</span>, event);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥LinkMovementMethodä¹Ÿæ˜¯æ ¹æ®è§¦æ‘¸çš„ä½ç½®æ‰¾å‡ºClickableSpanï¼ˆåŒä¸€ä¸ªä½ç½®è®¾ç½®å¤šä¸ªçš„è¯ï¼Œä¹Ÿåªä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªï¼‰ï¼Œç„¶åå›è°ƒonClickã€‚<br>LinkMovementMethodæ˜¯è¢«TextViewå›è°ƒã€‚<br>çœ‹åˆ°è¿™é‡ŒClickableSpançš„å®ç°åŸç†åŸºæœ¬å°±æ¸…æ¥šäº†ã€‚</p><h5 id="å…¶ä»–æ–¹æ¡ˆ"><a href="#å…¶ä»–æ–¹æ¡ˆ" class="headerlink" title="å…¶ä»–æ–¹æ¡ˆ"></a>å…¶ä»–æ–¹æ¡ˆ</h5><p>æœ‰ä¸ªå¤§èƒ†çš„æƒ³æ³•ğŸ’¡ï¼š<br>æˆ‘å…ˆè‡ªå®šä¹‰åªå¸¦æ•°æ®å’Œæ ·å¼çš„spanã€‚å†å®šä¹‰ä¸€ä¸ª MySpanListener é‡Œé¢æœ‰ä¸ªæ–¹æ³•<code>onClick(v:View,data:Data)</code>ã€‚<br>ç„¶åè‡ªå®šä¹‰LinkMovementMethodï¼ˆæ¯”å¦‚å«MyMovementMethodï¼‰ã€‚åŒä¸Šåœ¨onTouchEventé‡Œæ‰¾å‡ºè‡ªå·±å®šä¹‰spanã€‚ç„¶åæ ¹æ®textViewæ‹¿åˆ°listenerã€‚å›è°ƒ<code>onClick(v:View,data:Data)</code>æ–¹æ³•ã€‚<br>é‚£ä¹ˆé—®é¢˜æ˜¯çº¢å­—çš„æ€ä¹ˆå»å®ç°ï¼ˆä¸»è¦é—®é¢˜æ˜¯listenerï¼Œä»¥ä»€ä¹ˆç»´åº¦å‚¨å­˜ï¼Œæ€ä¹ˆå‚¨å­˜ï¼‰ã€‚æ¯”å¦‚åœ¨MyMovementMethodé‡Œè®¾ç½®ä¸€ä¸ªå¼±å¼•ç”¨çš„mapï¼š<code>WeakHashMap&lt;TextView,MySpanListener&gt;</code></p><p>ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•ï¼Œä½†æ˜¯çœ‹èµ·æ¥æŒºåˆ«æ‰­ã€‚å“ˆã€‚ã€‚ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-99188fa15f6b462a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p><h4 id="å¦ä¸€ä¸ªé—®é¢˜"><a href="#å¦ä¸€ä¸ªé—®é¢˜" class="headerlink" title="å¦ä¸€ä¸ªé—®é¢˜"></a>å¦ä¸€ä¸ªé—®é¢˜</h4><p>LinkMovementMethodæœ‰ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå°±æ˜¯é•¿æŒ‰æ—¶ã€‚ä¾æ—§ä¼šå›è°ƒonClickæ–¹æ³•ã€‚è¿™å°±ä¼šå‡ºç°äº¤äº’ä¼¤çš„bugã€‚<br>è§£å†³æ–¹æ¡ˆï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> ClickLinkMovementMethod : LinkMovementMethod() &#123;</span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CLICK_DELAY = <span class="number">500</span>L</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> lastClickTime: <span class="built_in">Long</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onTouchEvent</span><span class="params">(widget: <span class="type">TextView</span>?, buffer: <span class="type">Spannable</span>?, event: <span class="type">MotionEvent</span>?)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        event ?: <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        widget ?: <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">val</span> action = event.action</span><br><span class="line">        <span class="keyword">if</span> (action == MotionEvent.ACTION_UP ||</span><br><span class="line">                action == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">            <span class="keyword">var</span> x = event.x.toInt()</span><br><span class="line">            <span class="keyword">var</span> y = event.y.toInt()</span><br><span class="line">            x -= widget.totalPaddingLeft</span><br><span class="line">            y -= widget.totalPaddingTop</span><br><span class="line">            x += widget.scrollX</span><br><span class="line">            y += widget.scrollY</span><br><span class="line">            <span class="keyword">val</span> layout: Layout = widget.layout</span><br><span class="line">            <span class="keyword">val</span> line: <span class="built_in">Int</span> = layout.getLineForVertical(y)</span><br><span class="line">            <span class="keyword">val</span> off: <span class="built_in">Int</span> = layout.getOffsetForHorizontal(line, x.toFloat())</span><br><span class="line">            <span class="keyword">val</span> link: Array&lt;ClickableSpan&gt; = buffer?.getSpans(off, off, ClickableSpan::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">                    ?: <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            <span class="keyword">if</span> (link.isNotEmpty()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (action == MotionEvent.ACTION_UP) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (System.currentTimeMillis() - lastClickTime &lt; CLICK_DELAY) &#123;</span><br><span class="line">                        link[<span class="number">0</span>].onClick(widget)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">                    lastClickTime = System.currentTimeMillis()</span><br><span class="line">                    Selection.setSelection(buffer,</span><br><span class="line">                            buffer.getSpanStart(link[<span class="number">0</span>]),</span><br><span class="line">                            buffer.getSpanEnd(link[<span class="number">0</span>]))</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Selection.removeSelection(buffer)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><ol><li>ClickableSpanå®ç°ç‚¹å‡»ç›‘å¬çš„åŸç†æ˜¯LinkMovementMethodã€‚</li><li>LinkMovementMethodå­˜åœ¨é•¿æŒ‰æ—¶äº¤äº’çš„bugã€‚</li><li>ClickableSpançš„æ•°æ®&amp;äº‹ä»¶åˆ†ç¦»ä¾æ—§æœŸæœ›æ›´ä¼˜è´¨çš„æ–¹æ¡ˆã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ClickableSpan&quot;&gt;&lt;a href=&quot;#ClickableSpan&quot; class=&quot;headerlink&quot; title=&quot;ClickableSpan&quot;&gt;&lt;/a&gt;ClickableSpan&lt;/h2&gt;&lt;p&gt;ClickableSpan ç”¨æ¥å®ç° TextViewé‡Œçš„æ–‡å­—å±€éƒ¨çš„é«˜äº®å’Œç‚¹å‡»äº‹ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>Fragment ç›‘å¬è¿”å›æŒ‰é”®</title>
    <link href="https://wzmyyj.top/2020/05/11/android_4/"/>
    <id>https://wzmyyj.top/2020/05/11/android_4/</id>
    <published>2020-05-11T05:00:30.000Z</published>
    <updated>2020-07-21T03:05:01.973Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç›‘å¬è¿”å›é”®"><a href="#ç›‘å¬è¿”å›é”®" class="headerlink" title="ç›‘å¬è¿”å›é”®"></a>ç›‘å¬è¿”å›é”®</h2><p>Androidå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç”¨fragmentæ‰¿æ‹…é¡µé¢UIä¸»è¦çš„é€»è¾‘ï¼Œç®€åŒ–activityé€»è¾‘ã€‚æœ‰ä¸ªåœºæ™¯ï¼Œfragmentéœ€è¦ç›‘å¬è¿”å›é”®ã€‚ä½†fragmentä¸åƒactivityèƒ½æ„ŸçŸ¥ç‰©ç†æŒ‰é”®ã€‚</p><a id="more"></a><h3 id="è¿‡å»"><a href="#è¿‡å»" class="headerlink" title="è¿‡å»"></a>è¿‡å»</h3><p>æˆ‘ä»¬ä¼šå†™ä¸€ä¸ªç›‘å¬æ¥å£ï¼Œè®©fragmentå®ç°ã€‚ç„¶åactivityéå†ï¼ˆæˆ–æ ¹æ®tagï¼‰æ‰¾åˆ°éœ€è¦çš„fragmentï¼Œåœ¨æŒ‰è¿”å›é”®æ—¶ï¼Œä¸»åŠ¨å°†äº‹ä»¶ä¸‹å‘ç»™fragmentã€‚</p><p>è™½ç„¶å®ç°äº†fragmentç›‘å¬è¿”å›é”®çš„æ•ˆæœï¼Œä½†æ˜¯ä»£ç éœ€è¦ä¾µå…¥åˆ°activityï¼Œå¹¶ä¸åˆ©äºç»´æŠ¤ã€‚googleå®˜æ–¹ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="ç°åœ¨"><a href="#ç°åœ¨" class="headerlink" title="ç°åœ¨"></a>ç°åœ¨</h3><p>åœ¨æ–°ç‰ˆçš„AndroidXä¸­ï¼š<code>ComponentActivity</code>ä¸­å¢åŠ äº†<code>OnBackPressedDispatcher</code>ï¼ˆç”¨äºæ³¨å†Œè¿”å›é”®ç›‘å¬ï¼‰ã€‚</p><p>activityç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-a0a3b96b46bac1a5.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="WechatIMG9.jpeg" title="WechatIMG9.jpeg"> </p><p>æ–°çš„fragmentç›‘å¬æ–¹æ¡ˆï¼š</p><p><strong>å…³é”®ç±»</strong>ï¼šOnBackPressedCallbackï¼ŒOnBackPressedDispatcherï¼ŒComponentActivityã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰è¿”å›é”®ç›‘å¬äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="keyword">val</span> callback = <span class="keyword">object</span> : OnBackPressedCallback(<span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">handleOnBackPressed</span><span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="comment">//do some thing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œç›‘å¬äº‹ä»¶ã€‚activityä¸ºComponentActivityçš„å­ç±»å¯¹è±¡å³å¯ã€‚å¹¶ç»‘å®šç”Ÿå‘½å‘¨æœŸã€‚</span></span><br><span class="line">activity<span class="selector-class">.onBackPressedDispatcher</span><span class="selector-class">.addCallback</span>(lifecycleOwner, callback)</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥ä¸ç»‘å®šç”Ÿå‘½å‘¨æœŸã€‚</span></span><br><span class="line">activity<span class="selector-class">.onBackPressedDispatcher</span><span class="selector-class">.addCallback</span>(callback)</span><br></pre></td></tr></table></figure><p><code>OnBackPressedCallback</code>å¯ä»¥è®¾ç½®<code>enabled</code>ï¼Œå¯ä»¥çµæ´»æ§åˆ¶è¦ä¸è¦æ¶ˆè´¹è¿”å›é”®ç‚¹å‡»äº‹ä»¶ã€‚</p><h4 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h4><p>æ‰€æœ‰ä»£ç éƒ½åœ¨fragmenté‡Œã€‚ä¸éœ€è¦è¦æ±‚activityå†™å¤šä½™çš„é€»è¾‘ã€‚åªè¦èƒ½æ‹¿åˆ°activityå¯¹è±¡å’Œæ‰€åœ¨çš„lifecycleOwnerå³å¯å®Œæˆç›‘å¬ä»»åŠ¡ã€‚ç”šè‡³æ˜¯åœ¨è‡ªå®šä¹‰viewä¸­ã€‚</p><h4 id="æ·±å…¥æºç "><a href="#æ·±å…¥æºç " class="headerlink" title="æ·±å…¥æºç "></a>æ·±å…¥æºç </h4><p><code>OnBackPressedCallback</code>ï¼šç”¨äºå¤„ç†<code>OnBackPressedDispatcher.onBackPressed()</code>å›è°ƒè€Œæ— éœ€å°†è¯¥å®ç°ä¸çš„å­ç±»å¼ºè€¦åˆçš„ç±»ComponentActivityã€‚æºç æ¯”è¾ƒç®€å•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OnBackPressedCallback</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> mEnabled;</span><br><span class="line">    <span class="keyword">private</span> CopyOnWriteArrayList&lt;Cancellable&gt; mCancellables = <span class="keyword">new</span> CopyOnWriteArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a &#123;<span class="doctag">@link</span> OnBackPressedCallback&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> enabled The default enabled state for this callback.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setEnabled(boolean)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OnBackPressedCallback</span><span class="params">(<span class="keyword">boolean</span> enabled)</span> </span>&#123;</span><br><span class="line">        mEnabled = enabled;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set the enabled state of the callback. Only when this callback</span></span><br><span class="line"><span class="comment">     * is enabled will it receive callbacks to &#123;<span class="doctag">@link</span> #handleOnBackPressed()&#125;.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Note that the enabled state is an additional layer on top of the</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> androidx.lifecycle.LifecycleOwner&#125; passed to</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> OnBackPressedDispatcher#addCallback(LifecycleOwner, OnBackPressedCallback)&#125;</span></span><br><span class="line"><span class="comment">     * which controls when the callback is added and removed to the dispatcher.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> enabled whether the callback should be considered enabled</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@MainThread</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setEnabled</span><span class="params">(<span class="keyword">boolean</span> enabled)</span> </span>&#123;</span><br><span class="line">        mEnabled = enabled;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Checks whether this callback should be considered enabled. Only when this callback</span></span><br><span class="line"><span class="comment">     * is enabled will it receive callbacks to &#123;<span class="doctag">@link</span> #handleOnBackPressed()&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Whether this callback should be considered enabled.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@MainThread</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mEnabled;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes this callback from any &#123;<span class="doctag">@link</span> OnBackPressedDispatcher&#125; it is currently</span></span><br><span class="line"><span class="comment">     * added to.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@MainThread</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Cancellable cancellable: mCancellables) &#123;</span><br><span class="line">            cancellable.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Callback for handling the &#123;<span class="doctag">@link</span> OnBackPressedDispatcher#onBackPressed()&#125; event.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@MainThread</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleOnBackPressed</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCancellable</span><span class="params">(@NonNull Cancellable cancellable)</span> </span>&#123;</span><br><span class="line">        mCancellables.add(cancellable);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeCancellable</span><span class="params">(@NonNull Cancellable cancellable)</span> </span>&#123;</span><br><span class="line">        mCancellables.remove(cancellable);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>OnBackPressedDispatcher</code>ï¼šå­˜æ”¾ç›‘å¬çš„å®¹å™¨ï¼Œé€šè¿‡å®ƒç»Ÿä¸€æ‰§è¡Œã€‚</p><p><strong>å‚¨å­˜ç»“æ„ï¼š</strong></p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ©ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨å›è°ƒã€‚    </span></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"WeakerAccess"</span>) <span class="comment">/* synthetic access */</span></span><br><span class="line"><span class="keyword">final</span> ArrayDeque&lt;OnBackPressedCallback&gt; mOnBackPressedCallbacks = <span class="keyword">new</span> ArrayDeque&lt;&gt;();</span><br></pre></td></tr></table></figure><p><strong>æ˜¯å¦æœ‰æœ‰æ•ˆå›è°ƒï¼š</strong><br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MainThread</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">hasEnabledCallbacks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Iterator&lt;OnBackPressedCallback&gt; iterator =</span><br><span class="line">                mOnBackPressedCallbacks.descendingIterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (iterator.next().isEnabled()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><strong>æ‰§è¡Œé¡ºåºï¼š</strong><br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŒ‰å…ˆæ³¨å†Œé¡ºåºéå†ï¼Œåªæ‰§è¡Œenabledä¸ºtrueçš„å›è°ƒã€‚</span></span><br><span class="line"><span class="meta">@MainThread</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onBackPressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Iterator&lt;OnBackPressedCallback&gt; iterator =</span><br><span class="line">                mOnBackPressedCallbacks.descendingIterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            OnBackPressedCallback callback = iterator.next();</span><br><span class="line">            <span class="keyword">if</span> (callback.isEnabled()) &#123;</span><br><span class="line">                callback.handleOnBackPressed();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mFallbackOnBackPressed != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mFallbackOnBackPressed.run();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><strong>ç»‘å®šç”Ÿå‘½å‘¨æœŸåŸç†ï¼š</strong><br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@MainThread</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> addCallback(<span class="keyword">@NonNull</span> LifecycleOwner owner,</span><br><span class="line">            <span class="keyword">@NonNull</span> OnBackPressedCallback onBackPressedCallback) &#123;</span><br><span class="line">        Lifecycle lifecycle = owner.getLifecycle();</span><br><span class="line">        <span class="keyword">if</span> (lifecycle.getCurrentState() == Lifecycle.State.DESTROYED) &#123;</span><br><span class="line">            <span class="keyword">return</span>;  <span class="comment">// æ— è§†å·²ç»æ­»äº¡çš„ã€‚</span></span><br><span class="line">        &#125;</span><br><span class="line">        onBackPressedCallback.addCancellable(</span><br><span class="line">                <span class="keyword">new</span> LifecycleOnBackPressedCancellable(lifecycle, onBackPressedCallback));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>LifecycleOnBackPressedCancellable ç›‘å¬ç”Ÿå‘½å‘¨æœŸå˜åŒ–ï¼Œå†³å®šæ˜¯å¦cancelæ‰ç›‘å¬ã€‚<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">LifecycleOnBackPressedCancellable</span> <span class="keyword">implements</span> <span class="title">LifecycleEventObserver</span>,</span></span><br><span class="line"><span class="class">            <span class="title">Cancellable</span> &#123;</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Lifecycle mLifecycle;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> OnBackPressedCallback mOnBackPressedCallback;</span><br><span class="line">        <span class="meta">@Nullable</span></span><br><span class="line">        <span class="keyword">private</span> Cancellable mCurrentCancellable;</span><br><span class="line">        LifecycleOnBackPressedCancellable(<span class="meta">@NonNull</span> Lifecycle lifecycle,</span><br><span class="line">                <span class="meta">@NonNull</span> OnBackPressedCallback onBackPressedCallback) &#123;</span><br><span class="line">            mLifecycle = lifecycle;</span><br><span class="line">            mOnBackPressedCallback = onBackPressedCallback;</span><br><span class="line">            lifecycle.addObserver(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> onStateChanged(<span class="meta">@NonNull</span> LifecycleOwner source,</span><br><span class="line">                <span class="meta">@NonNull</span> Lifecycle.Event event) &#123;</span><br><span class="line">            <span class="keyword">if</span> (event == Lifecycle.Event.ON_START) &#123;</span><br><span class="line">                <span class="comment">// æ­¤æ—¶ä¸ºæœ‰æ•ˆã€‚</span></span><br><span class="line">                mCurrentCancellable = addCancellableCallback(mOnBackPressedCallback);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event == Lifecycle.Event.ON_STOP) &#123;</span><br><span class="line">                <span class="comment">// Should always be non-null</span></span><br><span class="line">                <span class="keyword">if</span> (mCurrentCancellable != <span class="literal">null</span>) &#123;</span><br><span class="line">                    mCurrentCancellable.cancel();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event == Lifecycle.Event.ON_DESTROY) &#123;</span><br><span class="line">                cancel();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> cancel() &#123;</span><br><span class="line">            mLifecycle.removeObserver(<span class="keyword">this</span>);</span><br><span class="line">            mOnBackPressedCallback.removeCancellable(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">if</span> (mCurrentCancellable != <span class="literal">null</span>) &#123;</span><br><span class="line">                mCurrentCancellable.cancel();</span><br><span class="line">                mCurrentCancellable = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><strong>ComponentActivityï¼š</strong></p><p><strong>å…³é”®ä»£ç ï¼š</strong><br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç±»çš„ onBackPressed äº‹ä»¶å§”æ‰˜ç»™ OnBackPressedDispatcher ã€‚</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> OnBackPressedDispatcher mOnBackPressedDispatcher =</span><br><span class="line">            <span class="keyword">new</span> OnBackPressedDispatcher(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    ComponentActivity.<span class="keyword">super</span>.onBackPressed();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="comment">// è‡ªå·±çš„ onBackPressed å…¨äº¤ç»™ OnBackPressedDispatcher å¤„ç†ã€‚</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@MainThread</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onBackPressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mOnBackPressedDispatcher.onBackPressed();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åˆ©ç”¨æ³¨å†Œç›‘å¬çš„æ–¹å¼ï¼Œå¯ä»¥å¾ˆå¥½çš„ç»“å¶ä»£ç ï¼Œå¯ä»¥activityçš„åŠŸèƒ½åˆ†å‘åˆ°å„ä¸ªèƒ½å¤Ÿè®¿é—®activityå¯¹è±¡çš„ç»„ä»¶ä¸Šã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-b23b9fde057bbdd1.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸ªå›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç›‘å¬è¿”å›é”®&quot;&gt;&lt;a href=&quot;#ç›‘å¬è¿”å›é”®&quot; class=&quot;headerlink&quot; title=&quot;ç›‘å¬è¿”å›é”®&quot;&gt;&lt;/a&gt;ç›‘å¬è¿”å›é”®&lt;/h2&gt;&lt;p&gt;Androidå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç”¨fragmentæ‰¿æ‹…é¡µé¢UIä¸»è¦çš„é€»è¾‘ï¼Œç®€åŒ–activityé€»è¾‘ã€‚æœ‰ä¸ªåœºæ™¯ï¼Œfragmentéœ€è¦ç›‘å¬è¿”å›é”®ã€‚ä½†fragmentä¸åƒactivityèƒ½æ„ŸçŸ¥ç‰©ç†æŒ‰é”®ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>LiveDataå®ç°æ¶ˆæ¯æ€»çº¿</title>
    <link href="https://wzmyyj.top/2020/05/10/android_3/"/>
    <id>https://wzmyyj.top/2020/05/10/android_3/</id>
    <published>2020-05-10T07:04:30.000Z</published>
    <updated>2020-07-21T03:03:23.347Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¶ˆæ¯æ€»çº¿"><a href="#æ¶ˆæ¯æ€»çº¿" class="headerlink" title="æ¶ˆæ¯æ€»çº¿"></a>æ¶ˆæ¯æ€»çº¿</h2><p>Androidå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸é‡è§ä¸åŒé¡µé¢ä¹‹é—´è¦ä¿æŒæ•°æ®åŒæ­¥ã€‚é€æœ€åˆçš„onActivityResultï¼Œåˆ°åé¢çš„ç¬¬ä¸‰æ–¹åº“EventBusï¼ŒRxBus,LiveEventBusã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ©ç”¨livedataè‡ªå·±å†™ä¸€ä¸ªç®€å•çš„æ¶ˆæ¯æ€»çº¿ã€‚</p><a id="more"></a><h4 id="å¯¹æ¯”è¿‡å»ï¼š"><a href="#å¯¹æ¯”è¿‡å»ï¼š" class="headerlink" title="å¯¹æ¯”è¿‡å»ï¼š"></a>å¯¹æ¯”è¿‡å»ï¼š</h4><p>onActivityResultï¼šä½¿ç”¨è¾ƒä¸ºç¹çï¼Œå¹¶ä¸”åœ¨å¤šé¡µé¢ä¸‹ï¼ˆæ¯”å¦‚æ ˆï¼šA,B,Cã€‚Cçš„äº‹ä»¶è¦ä¼ é€’ç»™Aå°±ä½¿ç”¨ä¸æ–¹ä¾¿äº†)ã€‚<br>EventBusï¼šæ—¶ä»£çš„çœ¼æ³ªï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œä½†æ€§èƒ½å†…å­˜ä½“ç§¯éƒ½æ˜¯ç¼ºé™·ã€‚<br>RxBusï¼šä¸æ˜¯åº“ï¼Œæ˜¯ä¸ªæ–‡ä»¶ï¼Œå®ç°åªæœ‰çŸ­çŸ­30è¡Œä»£ç ã€‚ç»“åˆRxjavaå¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ã€‚<br>LiveEventBusï¼šåˆ©ç”¨ç³»ç»Ÿçš„livedataã€‚ä½“ç§¯å°ã€‚ä¸”å¯ä»¥æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸã€‚<br>æ¶ˆæ¯æ€»çº¿ | å»¶è¿Ÿå‘é€ | æœ‰åºæ¥æ”¶æ¶ˆæ¯ | Sticky |    ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥    | è·¨è¿›ç¨‹/APP | çº¿ç¨‹åˆ†å‘<br>-|-|-|-|-|-|-<br>EventBus | âŒ    | âœ… | âœ… | âŒ | âŒ | âœ…<br>RxBus | âŒ | âŒ | âœ… | âŒ | âŒ     | âœ…<br>LiveEventBus | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ</p><p>å®ƒä»¬éƒ½å¾ˆä¼˜ç§€ã€‚ä½†æˆ‘ä»¬ä¸ç”¨å®ƒä»¬ã€‚è‡ªå·±å†™ä¸ªç®€å•çš„å®ç°æ–¹æ¡ˆã€‚ä¸»è¦å‚è€ƒLiveEventBusçš„æ ¸å¿ƒé€»è¾‘ã€‚</p><h4 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h4><p>çŸ­çŸ­50å¤šè¡Œä»£ç ï¼ˆå»æ‰æ³¨é‡Šå’Œç©ºè¡Œä¹Ÿå°±30è¡Œå·¦å³ï¼‰ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> EventHelper &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> map = HashMap&lt;String, EventLiveData&lt;*&gt;&gt;()</span><br><span class="line">    <span class="meta">@Suppress(<span class="meta-string">"UNCHECKED_CAST"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">with</span><span class="params">(key: <span class="type">String</span>, type: <span class="type">Class</span>&lt;<span class="type">T</span>&gt;? = <span class="literal">null</span>)</span></span>: EventLiveData&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!map.containsKey(key)) &#123;</span><br><span class="line">            map[key] = EventLiveData&lt;T&gt;()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map[key] <span class="keyword">as</span>? EventLiveData&lt;T&gt;</span><br><span class="line">                ?: <span class="keyword">throw</span> RuntimeException(<span class="string">"cannot cast EventLiveData of "</span> + type.toString())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®°å½•ç‰ˆæœ¬çš„ MutableLiveDataã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">EventLiveData</span>&lt;<span class="type">T</span>&gt; : <span class="type">MutableLiveData</span>&lt;<span class="type">T</span>&gt;</span>() &#123;</span><br><span class="line">        <span class="keyword">var</span> version: <span class="built_in">Int</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">set</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * postValue æœ€ç»ˆä¹Ÿä¼šè°ƒ setValue ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨è¿™é‡Œç»Ÿè®¡ versionã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">setValue</span><span class="params">(value: <span class="type">T</span>)</span></span> &#123;</span><br><span class="line">            version++</span><br><span class="line">            <span class="keyword">super</span>.setValue(value)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è®¢é˜…äº‹ä»¶ã€‚ç»‘å®šç”Ÿå‘½å‘¨æœŸã€‚è¿”å› Observer æ–¹ä¾¿ä¸»åŠ¨ç§»é™¤è§‚å¯Ÿã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">observeEvent</span><span class="params">(owner: <span class="type">LifecycleOwner</span>, onEvent: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Unit</span>): Observer&lt;T&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> EventObserver(onEvent).apply &#123; <span class="keyword">super</span>.observe(owner, <span class="keyword">this</span>) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è®¢é˜…äº‹ä»¶ã€‚æ°¸ä¹…æœ‰æ•ˆã€‚è¿”å› Observer æ–¹ä¾¿ä¸»åŠ¨ç§»é™¤è§‚å¯Ÿã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">observeForeverEvent</span><span class="params">(onEvent: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Unit</span>): Observer&lt;T&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> EventObserver(onEvent).apply &#123; <span class="keyword">super</span>.observeForever(<span class="keyword">this</span>) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ä¸æ¥æ”¶åˆ›å»ºä¹‹å‰çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        inner <span class="class"><span class="keyword">class</span> <span class="title">EventObserver</span>&lt;<span class="type">T</span>&gt;</span>(<span class="keyword">val</span> onEvent: (T) -&gt; <span class="built_in">Unit</span>) : Observer&lt;T&gt; &#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">var</span> observerVersion = <span class="keyword">this</span><span class="symbol">@EventLiveData</span>.version</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onChanged</span><span class="params">(t: <span class="type">T</span>)</span></span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (observerVersion &lt; <span class="keyword">this</span><span class="symbol">@EventLiveData</span>.version) &#123;</span><br><span class="line">                    observerVersion = <span class="keyword">this</span><span class="symbol">@EventLiveData</span>.version</span><br><span class="line">                    onEvent(t)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨å§¿åŠ¿ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ï¼š(ä¸€èˆ¬ä¼šæŠŠè¿™æ­¥å°è£…èµ·æ¥ï¼‰</span></span><br><span class="line">EventHelper.with&lt;Event&gt;(Key) <span class="comment">//or </span></span><br><span class="line">EventHelper.with(Key,Event::class.java)</span><br><span class="line"><span class="comment">// è®¢é˜…ï¼š</span></span><br><span class="line"><span class="function"><span class="title">observeEvent</span><span class="params">(owner)</span></span>&#123; event -&gt; do something &#125; <span class="comment">// ç»‘å®šç”Ÿå‘½å‘¨æœŸã€‚</span></span><br><span class="line">observeForeverEvent&#123; event -&gt; do something &#125; <span class="comment">// æ°¸ä¹…æœ‰æ•ˆã€‚</span></span><br><span class="line"><span class="comment">// å‘å¸ƒï¼š</span></span><br><span class="line"><span class="function"><span class="title">setValue</span><span class="params">(event)</span></span> <span class="comment">// ä¸»çº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="function"><span class="title">postValue</span><span class="params">(event)</span></span> <span class="comment">// å­çº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">// ç§»é™¤ï¼š</span></span><br><span class="line">åŒliveDataã€‚</span><br></pre></td></tr></table></figure></p><h4 id="å®æˆ˜ï¼š"><a href="#å®æˆ˜ï¼š" class="headerlink" title="å®æˆ˜ï¼š"></a>å®æˆ˜ï¼š</h4><ol><li>å°è£…ï¼šåŒä¸€æ¨¡å—çš„äº‹ä»¶æ”¾åœ¨ä¸€èµ·ã€‚key ä¸ event å¯¹åº”ã€‚</li><li>key å‘½åè§„èŒƒï¼šæ¨¡å—å+å­æ¨¡å—å+å…·ä½“äº‹ä»¶ã€‚</li><li>eventç±»ä¸ŠåŠ ä¸ŠIDï¼šä¾‹å¦‚ï¼šChangeGroupNameEventåŠ ä¸ŠgroupCodeæ˜ç¡®æ˜¯é‚£ä¸ªç¾¤åç§°å˜äº†ã€‚<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">object</span> IMEventHelper &#123;</span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CHANGE_GROUP_NAME = <span class="string">"im/group/changeGroupName"</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CHANGE_NOTIFICATION = <span class="string">"im/group/changeNotification"</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CHANGE_MEMBER_LIST = <span class="string">"im/group/changeMemberList"</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CHANGE_GROUP_LIST = <span class="string">"im/group/changeGroupList"</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> QUIT_GROUP = <span class="string">"im/group/quitGroup"</span></span><br><span class="line">    <span class="keyword">private</span> const <span class="keyword">val</span> CHOOSE_AT = <span class="string">"im/group/chooseAt"</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¾¤åç§°ä¿®æ”¹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">changeGroupName</span><span class="params">()</span></span> = EventHelper.with&lt;ChangeGroupNameEvent&gt;(CHANGE_GROUP_NAME)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¬å‘Šä¿®æ”¹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">changeNotification</span><span class="params">()</span></span> = EventHelper.with&lt;ChangeNotificationEvent&gt;(CHANGE_NOTIFICATION)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆå‘˜åˆ—è¡¨å˜æ¢ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">changeMemberList</span><span class="params">()</span></span> = EventHelper.with&lt;ChangeMemberListEvent&gt;(CHANGE_MEMBER_LIST)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¾¤èŠåˆ—è¡¨å˜æ¢ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">changeGroupList</span><span class="params">()</span></span> = EventHelper.with&lt;ChangeGroupListEvent&gt;(CHANGE_GROUP_LIST)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€€å‡ºç¾¤èŠã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">quitGroup</span><span class="params">()</span></span> = EventHelper.with&lt;QuitGroupEvent&gt;(QUIT_GROUP)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€‰æ‹©AT æˆå‘˜ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">chooseAt</span><span class="params">()</span></span> = EventHelper.with&lt;AtMemberEvent&gt;(CHOOSE_AT)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>eventç±»ï¼š<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">ChangeGroupNameEvent</span>(<span class="title">val</span> <span class="title">groupCode</span>: <span class="type">String</span>, <span class="title">val</span> <span class="title">newName</span>: <span class="type">String</span>)</span></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ï¼š<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ fragment åˆå§‹åŒ–é‡Œè®¢é˜…äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="selector-tag">IMEventHelper</span></span><br><span class="line">    <span class="selector-class">.changeGroupName</span>()</span><br><span class="line">    <span class="selector-class">.observeEvent</span>(this) &#123; <span class="selector-tag">vm</span><span class="selector-class">.changeName</span>(it) &#125;</span><br><span class="line"><span class="comment">// åœ¨ å…¶å®ƒåœ°æ–¹å‘å¸ƒäº‹ä»¶ã€‚</span></span><br><span class="line"><span class="selector-tag">IMEventHelper</span></span><br><span class="line">    <span class="selector-class">.changeGroupName</span>()</span><br><span class="line">    <span class="selector-class">.postValue</span>(ChangeGroupNameEvent(groupCode, newName))</span><br></pre></td></tr></table></figure></p><h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><p>è¦ç‚¹ï¼š</p><ol><li>åˆ©ç”¨LiveDataï¼Œæ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸçš„ç‰¹æ€§ã€‚</li><li>ä¸æ¥æ”¶æ³¨å†Œè§‚å¯Ÿä¹‹å‰çš„æ¶ˆæ¯ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>Livedataåªèƒ½ä¿è¯æ¥æ”¶åˆ°æœ€æ–°çš„æ•°æ®ã€‚ä¸­é—´çš„æ•°æ®å¯ä¸ç®¡å“¦ã€‚ğŸ˜¯</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-261af345089ca6e6.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ¶ˆæ¯æ€»çº¿&quot;&gt;&lt;a href=&quot;#æ¶ˆæ¯æ€»çº¿&quot; class=&quot;headerlink&quot; title=&quot;æ¶ˆæ¯æ€»çº¿&quot;&gt;&lt;/a&gt;æ¶ˆæ¯æ€»çº¿&lt;/h2&gt;&lt;p&gt;Androidå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸é‡è§ä¸åŒé¡µé¢ä¹‹é—´è¦ä¿æŒæ•°æ®åŒæ­¥ã€‚é€æœ€åˆçš„onActivityResultï¼Œåˆ°åé¢çš„ç¬¬ä¸‰æ–¹åº“EventBusï¼ŒRxBus,LiveEventBusã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ©ç”¨livedataè‡ªå·±å†™ä¸€ä¸ªç®€å•çš„æ¶ˆæ¯æ€»çº¿ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>kotlinä½¿ç”¨letæŠ¥java.lang.NoClassDefFoundError</title>
    <link href="https://wzmyyj.top/2019/11/13/kotlin_1/"/>
    <id>https://wzmyyj.top/2019/11/13/kotlin_1/</id>
    <published>2019-11-13T08:27:00.000Z</published>
    <updated>2020-07-21T02:55:28.276Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜é˜è¿°"><a href="#é—®é¢˜é˜è¿°" class="headerlink" title="é—®é¢˜é˜è¿°"></a>é—®é¢˜é˜è¿°</h2><p>kotlin è¿è¡Œè¿™æ®µä»£ç æŠ¥java.lang.NoClassDefFoundErroré”™è¯¯ï¼ˆè¡¨ç¤ºè¿è¡Œä¸­æ‰¾ä¸åˆ°ç±»çš„å®šä¹‰ï¼‰ã€‚å¦‚ä¸‹ä»£ç ï¼š</p><a id="more"></a><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">shareUrlToFriend</span><span class="params">(logoUrl: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">      activity?.let &#123;</span><br><span class="line">          Glide.with(<span class="keyword">this</span>)</span><br><span class="line">                  .asBitmap()</span><br><span class="line">                  .load(logoUrl)</span><br><span class="line">                  .into(<span class="keyword">object</span> : CustomTarget&lt;Bitmap&gt;() &#123;</span><br><span class="line">                      <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onLoadCleared</span><span class="params">(placeholder: <span class="type">Drawable</span>?)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">                      &#125;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResourceReady</span><span class="params">(resource: <span class="type">Bitmap</span>, transition: <span class="type">Transition</span>&lt;<span class="type">in</span> <span class="type">Bitmap</span>&gt;?)</span></span> &#123;</span><br><span class="line">                          print(logoUrl)<span class="comment">//å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨äº†logoUrl</span></span><br><span class="line"></span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æ›¿æ¢å°è¯•ï¼ŒæŠ¥é”™ä¸æ˜¯Glideçš„é”…ã€‚æ ¹æ®kotliné»˜è®¤æœ€åä¸€è¡Œæ˜¯è¿”å›å€¼çš„è§„åˆ™ï¼Œè¿™ä»£ç æœ€å<code>let</code>ä¸‹é¢æœ€åä¸€ä¸ªè¿”å›å¯¹è±¡æ˜¯CustomTargetçš„åŒ¿åå†…éƒ¨ç±»å¯¹è±¡ã€‚å› ä¸ºï¼š<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Glide into()æ–¹æ³•</span></span><br><span class="line"><span class="variable">@NonNull</span></span><br><span class="line">  public &lt;Y extends Target&lt;TranscodeType&gt;&gt; Y into(<span class="variable">@NonNull</span> Y target) &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">into</span>(target, <span class="comment">/*targetListener=*/</span> null, Executors.mainThreadExecutor());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥ï¼Œå¯ä»¥æŠŠä¸Šé¢ä»£ç æ›¿æ¢æˆå¦‚ä¸‹ç®€å•ä»£ç ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a: Any? = <span class="literal">null</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">(u: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        a?.let &#123;</span><br><span class="line">            <span class="keyword">object</span> : Inter &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">e</span><span class="params">()</span></span> &#123;</span><br><span class="line">                    print(u)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> t = T()</span><br><span class="line">    t.a = Any()</span><br><span class="line">    t.f(<span class="string">"u"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">e</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™æ®µæ‰§è¡Œ<code>f()</code>å‡½æ•°ä»£ç ä¼šæŠ¥ä¸€æ ·çš„é”™è¯¯ã€‚<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java<span class="selector-class">.lang</span><span class="selector-class">.NoClassDefFoundError</span>: com/a/wzm/shere/ui/T<span class="variable">$f</span>$<span class="number">1</span>$<span class="number">1</span></span><br><span class="line">    at com<span class="selector-class">.a</span><span class="selector-class">.wzm</span><span class="selector-class">.shere</span><span class="selector-class">.ui</span><span class="selector-class">.T</span><span class="selector-class">.f</span>(Test<span class="selector-class">.kt</span>:<span class="number">14</span>)</span><br><span class="line">    at com<span class="selector-class">.a</span><span class="selector-class">.wzm</span><span class="selector-class">.shere</span><span class="selector-class">.ui</span><span class="selector-class">.TestKt</span><span class="selector-class">.main</span>(Test<span class="selector-class">.kt</span>:<span class="number">28</span>)</span><br><span class="line">    at com<span class="selector-class">.a</span><span class="selector-class">.wzm</span><span class="selector-class">.shere</span><span class="selector-class">.ui</span><span class="selector-class">.TestKt</span><span class="selector-class">.main</span>(Test.kt)</span><br><span class="line">Caused by: java<span class="selector-class">.lang</span><span class="selector-class">.ClassNotFoundException</span>: com<span class="selector-class">.a</span><span class="selector-class">.wzm</span><span class="selector-class">.shere</span><span class="selector-class">.ui</span><span class="selector-class">.T</span><span class="variable">$f</span>$<span class="number">1</span>$<span class="number">1</span></span><br><span class="line">    at java<span class="selector-class">.net</span><span class="selector-class">.URLClassLoader</span><span class="selector-class">.findClass</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">382</span>)</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">424</span>)</span><br><span class="line">    at sun<span class="selector-class">.misc</span><span class="selector-class">.Launcher</span><span class="variable">$AppClassLoader</span>.loadClass(Launcher<span class="selector-class">.java</span>:<span class="number">349</span>)</span><br><span class="line">    at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">357</span>)</span><br><span class="line">    ... <span class="number">3</span> more</span><br><span class="line"></span><br><span class="line">Process finished with exit <span class="selector-tag">code</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></p><p><code>T$f$1$1</code>æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Ÿ</p><h2 id="é—®é¢˜è¿½æº¯"><a href="#é—®é¢˜è¿½æº¯" class="headerlink" title="é—®é¢˜è¿½æº¯"></a>é—®é¢˜è¿½æº¯</h2><p>æŸ¥çœ‹ç¿»è¯‘åçš„Javaä»£ç ï¼š<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.0   ä¸»è¦çœ‹f()å‡½æ•°ã€‚</span></span><br><span class="line"><span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">if</span> (this.a != <span class="built_in">null</span>) &#123;</span><br><span class="line">         <span class="built_in">boolean</span> var3 = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">         int var6 = <span class="literal">false</span>;</span><br><span class="line">         <span class="number">1</span> var10000 = (<span class="number">1</span>)(<span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u));<span class="comment">// 1æ˜¯å•¥ï¼Ÿ</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>é‡Œé¢è¿™ä¸ª<code>1</code>å°±æ˜¯ä¸æ²¡å®šä¹‰çš„ç±»å‹ï¼ˆä¹Ÿå°±æ˜¯æŠ¥é”™é‡Œé¢éœ€è¦å®šä¹‰çš„<code>T$f$1$1</code>ï¼‰ã€‚ä¸ºä»€ä¹ˆæœ‰ä¸ª<code>1</code>å‡ºæ¥æ£ä¹±?<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//ç”Ÿæˆçš„ç±»ã€‚</span><br><span class="line">@Metadata(</span><br><span class="line">   mv = &#123;1, 1, 15&#125;,</span><br><span class="line">   bv = &#123;1, 0, 3&#125;,</span><br><span class="line">   k = 1,</span><br><span class="line">   d1 = &#123;"<span class="symbol">\u</span>0000<span class="symbol">\u</span>0011<span class="symbol">\n</span><span class="symbol">\u</span>0000<span class="symbol">\n</span><span class="symbol">\u</span>0002<span class="symbol">\u</span>0018<span class="symbol">\u</span>0002<span class="symbol">\n</span><span class="symbol">\u</span>0000<span class="symbol">\n</span><span class="symbol">\u</span>0002<span class="symbol">\u</span>0010<span class="symbol">\u</span>0002<span class="symbol">\n</span><span class="symbol">\u</span>0000*<span class="symbol">\u</span>0001<span class="symbol">\u</span>0000<span class="symbol">\b</span><span class="symbol">\n</span><span class="symbol">\u</span>0018<span class="symbol">\u</span>00002<span class="symbol">\u</span>00020<span class="symbol">\u</span>0001J<span class="symbol">\b</span><span class="symbol">\u</span>0010<span class="symbol">\u</span>0002<span class="symbol">\u</span>001a<span class="symbol">\u</span>00020<span class="symbol">\u</span>0003H<span class="symbol">\u</span>0016Â¨<span class="symbol">\u</span>0006<span class="symbol">\u</span>0004Â¸<span class="symbol">\u</span>0006<span class="symbol">\u</span>0000"&#125;,</span><br><span class="line">   d2 = &#123;"com/a/wzm/shere/ui/Te<span class="keyword">$f$1$1", "Lcom/a/wzm/share/ui/Inter;", "a", "", "app"&#125;</span></span><br><span class="line"><span class="keyword">)</span></span><br><span class="line"><span class="keyword">public final class Te$f$$inlined$let$lambda$1 implements Inter &#123;</span></span><br><span class="line"><span class="keyword">   // $FF: synthetic field</span></span><br><span class="line"><span class="keyword">   final String $u$inlined;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">   Te$f$$inlined$let$lambda$1</span>(String var1) &#123;</span><br><span class="line">      this.<span class="keyword">$u$inlined = var1;</span></span><br><span class="line"><span class="keyword">   &#125;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">   public void a</span>() &#123;</span><br><span class="line">      String var1 = this.<span class="keyword">$u$inlined;</span></span><br><span class="line"><span class="keyword">      boolean var2 = false;</span></span><br><span class="line"><span class="keyword">      System.out.print</span>(var1);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç±»åè·Ÿæ³¨è§£é‡Œçš„ï¼ˆ<code>&quot;com/a/wzm/share/ui/Te$f$1$1&quot;</code>ï¼‰ä¸ä¸€è‡´ã€‚</p><h4 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h4><p>å¯¹ä¸Šè¯‰ä»£ç ç®€å•ä¿®æ”¹æµ‹è¯•ã€‚å‘ç°åªéœ€è¦ç®€å•ä¿®æ”¹å°±ä¸æŠ¥é”™ã€‚æ¯”å¦‚ï¼š</p><ol><li>ä¸ç”¨ <code>let</code>ç¬¬ä¸€è¡Œç”¨<code>if(a==null)return</code>ã€‚ï¼ˆè§„é¿äº†letçš„é—®é¢˜ï¼Œä¸è®¨è®ºï¼‰ã€‚</li><li><code>a</code>åé¢çš„<code>?</code>å»æ‰ã€‚</li><li>æ–¹æ³•<code>e()</code>é‡Œä¸ä½¿ç”¨<code>u</code></li><li><code>object: Inter</code>å‰é¢åŠ ä¸Š<code>val x=</code>è¿›è¡Œèµ‹å€¼æ‰ã€‚</li><li>åœ¨<code>let</code>æœ€åä¸€è¡Œå†™ä¸ª1ï¼Œtrueæˆ–å…¶ä»–æ˜ç¡®ç±»å‹çš„ä¸œè¥¿ã€‚</li></ol><p>è€Œè¿™æ ·åšï¼ŒæŠ¥ä¸€æ ·é”™è¯¯ã€‚</p><ol start="6"><li><code>a?.let</code>å‰é¢åŠ <code>val c=</code>è¿›è¡Œèµ‹å€¼æ“ä½œã€‚æ­¤æ—¶å°±ç®—<code>?</code>ï¼ˆå¦‚2æ‰€è¯‰ï¼‰ å»æ‰ä¹ŸæŠ¥é”™ã€‚ç»“åˆ3ï¼Œ4ï¼Œ5ä¸æŠ¥é”™ã€‚</li></ol><p>æŠŠä¸Šè¯‰å®éªŒé€šè¿‡è½¬æ¢ï¼ŒæŸ¥çœ‹ç¿»è¯‘åçš„Javaä»£ç ï¼š<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NO.2</span></span><br><span class="line"> <span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      Object var2 = this.a;</span><br><span class="line">      <span class="built_in">boolean</span> var3 = <span class="literal">false</span>;</span><br><span class="line">      <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">      int var6 = <span class="literal">false</span>;</span><br><span class="line">      <span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.3</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> f(@NotNull <span class="keyword">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.a != <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="built_in">boolean</span> var3 = <span class="keyword">false</span>;</span><br><span class="line">         <span class="built_in">boolean</span> var4 = <span class="keyword">false</span>;</span><br><span class="line">         <span class="built_in">int</span> var6 = <span class="keyword">false</span>;</span><br><span class="line">         <span class="keyword">new</span> T$f$<span class="number">1</span>$<span class="number">1</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="keyword">Object</span> var10000 = <span class="keyword">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.4</span></span><br><span class="line"><span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">if</span> (this.a != <span class="built_in">null</span>) &#123;</span><br><span class="line">         <span class="built_in">boolean</span> var3 = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">         int var6 = <span class="literal">false</span>;</span><br><span class="line">         <span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.5ï¼Œæœ€åä¸€è¡ŒåŠ äº†ä¸ªtrue</span></span><br><span class="line"><span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">if</span> (this.a != <span class="built_in">null</span>) &#123;</span><br><span class="line">         <span class="built_in">boolean</span> var3 = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">         int var6 = <span class="literal">false</span>;</span><br><span class="line">         <span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u);</span><br><span class="line">         <span class="built_in">boolean</span> var10000 = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.6 åˆå‡ºç°æœªçŸ¥ç±»å‹ï¼š1</span></span><br><span class="line"><span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      Object var3 = this.a;</span><br><span class="line">      <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">      <span class="built_in">boolean</span> var5 = <span class="literal">false</span>;</span><br><span class="line">      int var7 = <span class="literal">false</span>;</span><br><span class="line">      <span class="number">1</span> x = (<span class="number">1</span>)(<span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>åŒºåˆ«</th><th>åŒ¿åç±»</th><th>æ˜¯å¦å‡ºç°ç±»å‹ï¼ˆ1ï¼‰  </th></tr></thead><tbody><tr><td>NO.0ï¼ˆåŸå§‹ï¼‰</td><td><code>T$f$$inlined$let$lambda$1</code></td><td>æ˜¯</td><td></td></tr><tr><td>NO.2</td><td><code>T$f$$inlined$let$lambda$1</code></td><td>å¦</td><td></td></tr><tr><td>NO.3</td><td><code>T$f$1$1</code></td><td>å¦</td><td></td></tr><tr><td>NO.4</td><td><code>T$f$$inlined$let$lambda$1</code></td><td>å¦</td><td></td></tr><tr><td>NO.5</td><td><code>T$f$$inlined$let$lambda$1</code></td><td>å¦</td><td></td></tr><tr><td>NO.6</td><td><code>T$f$$inlined$let$lambda$1</code></td><td>æ˜¯</td><td></td></tr></tbody></table><p>é¦–å…ˆåˆ†æç¬¬4ç‚¹å’Œç¬¬5ç‚¹ã€‚ç¬¬4ç‚¹æŠŠåŒ¿åç±»å¯¹è±¡èµ‹å€¼ç»™äº†<code>x</code>ï¼Œè¿™æ„å‘³è¿™<code>let</code>åªèƒ½å–ä¸‹ä¸€è¡Œåšè¿”å›å€¼ï¼ˆæ²¡æœ‰ä¸‹è¡Œï¼Œå°±æ˜¯<code>Unit</code>ï¼‰ã€‚æ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´<code>let</code>æœ‰æ˜ç¡®è¿”å›å€¼å°±ä¸æŠ¥é”™ã€‚<br>æ²¡æœ‰æ˜ç¡®è¿”å›å€¼ç±»å‹ä¸”â€œä¸å…³å¿ƒâ€è¿”å›å€¼ï¼ˆå¦‚NO.2)ï¼Œä¹Ÿä¸ä¼šé”™ã€‚NO.0ä¹Ÿä¸â€œå…³å¿ƒâ€è¿”å›å€¼å•Šï¼Ÿå¯æ˜¯NO.0åˆå¯¹açš„ç©ºåˆ¤æ–­ï¼Œå¯¹<code>let</code>è¿”å›åˆä¸¤ç§ç»“æœï¼Œè¦ä¹ˆæœ‰è¿”å›ï¼Œè¦ä¹ˆæ²¡è¿”å›ï¼Œå°†ä¹Ÿå®ƒå½’çº³ä¸ºâ€œå…³å¿ƒâ€ç»“æœã€‚<br>è‡³äºNO.3çš„æƒ…å†µï¼ˆå°±ç®—ç»“åˆNO.6ä¹Ÿä¸æŠ¥é”™ï¼‰ï¼Œç”Ÿæˆçš„ç±»å°±æ˜¯NO.0ä¸­æŠ¥é”™ä¸­æ²¡å®šä¹‰çš„ç±»ï¼ˆä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œç¨åè®¨è®ºï¼‰ã€‚æ‰€ä»¥ä¹Ÿå°±æ²¡é—®é¢˜äº†ã€‚</p><h3 id="é—®é¢˜1"><a href="#é—®é¢˜1" class="headerlink" title="é—®é¢˜1"></a>é—®é¢˜1</h3><p>ä¸ºä»€ä¹ˆ<code>let</code>â€œå…³å¿ƒâ€è¿”å›å€¼ä¼šæœ‰åŒºåˆ«ï¼Ÿ<code>let</code>çš„è¿”å›å€¼ç©¶ç«Ÿæ˜¯ä¸ªå•¥ï¼Ÿ</p><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>é¦–å…ˆï¼ŒæŸ¥çœ‹<code>let</code>æ–¹æ³•çš„å®šä¹‰ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@kotlin</span>.<span class="keyword">internal</span>.InlineOnly</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> T.<span class="title">let</span><span class="params">(block: (<span class="type">T</span>)</span></span> -&gt; R): R &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> block(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>let</code> æ˜¯æ³›å‹çš„æ‰©å±•æ–¹æ³•ï¼Œå‚æ•°æ˜¯ä¸ªé«˜é˜¶å‡½æ•°ã€‚ä½œç”¨æ˜¯å°†ä¸€ç§ç±»å‹<code>T</code>ï¼Œé€šè¿‡<code>block</code>æ–¹æ³•å˜æ¢å˜æˆç±»å‹<code>R</code>ã€‚</p><p>æ‰€ä»¥<code>let</code>è¿”å›å€¼æ˜¯ä¸ª<code>R</code>ã€‚é‚£<code>R</code>æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å½“ç„¶æ˜¯è‡ªå·±å®šå–½ã€‚æˆ‘ä»¬ä¸€ç›´éƒ½æ˜¯ç›´æ¥ç”¨<code>let</code>ï¼Œå®é™…ä¸Šä¸¥æ ¼ç”¨æ³•åº”è¯¥è¿™æ ·ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">val</span> s = a.let&lt;<span class="built_in">Int</span>, String&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span><span class="symbol">@let</span> it.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åªä¸è¿‡ï¼Œkotlinçš„è‡ªåŠ¨ç±»å‹è¯†åˆ«å¸®æˆ‘ä»¬åšäº†ç±»å‹åŒºåˆ†ã€‚</p><p>é—®é¢˜ä¸­çš„ç±»å‹<code>1</code>ä¼°è®¡å°±æ˜¯ä¸æ˜ç¡®çš„<code>R</code>ã€‚æ‰€ä»¥æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šç´¯è¡Œè¯•è¯•ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">(u: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">       a?.let&lt;Any, Inter&gt; &#123;</span><br><span class="line">            <span class="keyword">object</span> : Inter &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">a</span><span class="params">()</span></span> &#123;</span><br><span class="line">                    print(u)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>å¯¹åº”çš„Javaä»£ç ã€‚<br> <figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> final <span class="literal">void</span> f(@NotNull <span class="built_in">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">if</span> (this.a != <span class="built_in">null</span>) &#123;</span><br><span class="line">         <span class="built_in">boolean</span> var3 = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">boolean</span> var4 = <span class="literal">false</span>;</span><br><span class="line">         int var6 = <span class="literal">false</span>;</span><br><span class="line">         Inter var10000 = (Inter)(<span class="literal">new</span> T$f$$inlined$let$lambda$<span class="number">1</span>(u));</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>åŸæœ¬æ˜¯<code>1</code>çš„åœ°æ–¹å˜æˆäº†æˆ‘ä»¬æŒ‡å®šçš„ç±»å‹<code>Inter</code>ã€‚ä»£ç è·‘èµ·æ¥ä¹Ÿä¸åœ¨è·Œè·Ÿæ–—ã€‚</p><blockquote><p>é‚£ä¸ºä»€ä¹ˆâ€œä¸å…³å¿ƒâ€ç»“æœçš„æ—¶å€™ç¿»è¯‘è¿‡æ¥å°±ä¸éœ€è¦è½¬  <code>R</code> çš„ç±»å‹å‘¢ï¼Ÿï¼ˆç›®å‰æ‰¾åˆ°çš„è§£é‡Šæ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–æ‰æ˜ç¡®ä¸éœ€è¦çš„è¿‡ç¨‹ï¼‰</p></blockquote><h3 id="é—®é¢˜2"><a href="#é—®é¢˜2" class="headerlink" title="é—®é¢˜2"></a>é—®é¢˜2</h3><p>çœ‹è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å‘ç°äº†ï¼Œ<code>let</code>é‡Œçš„ä»£ç ç›´æ¥è¢«æ‹·åˆ°<code>f()</code>å‡½æ•°é‡Œé¢ï¼Œè€Œä¸æ˜¯ç”Ÿæˆé«˜é˜¶å‡½æ•°<code>block: (T) -&gt; R</code>è¡¨ç¤ºçš„æ¥å£çš„å®ç°ç±»ã€‚è€Œä¸”<code>Inter</code>æœ¬è¯¥å†…éƒ¨ç±»çš„å®ç°ï¼Œä¹Ÿå˜æˆäº†å®šä¹‰äº†å¤–éƒ¨ç‹¬ç«‹çš„ç±»ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p><h3 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h3><p>è¿™æ˜¯å› ä¸º<code>inline</code>å…³é”®å­—çš„ä½œç”¨ï¼š<code>inline</code> çš„å·¥ä½œåŸç†å°±æ˜¯å°†å†…è”å‡½æ•°çš„å‡½æ•°ä½“å¤åˆ¶åˆ°è°ƒç”¨å¤„å®ç°å†…è”ã€‚è¯¦æƒ…è§<a href="https://www.jianshu.com/p/c63c29f3b72a?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™</a>ã€‚</p><h4 id="å®éªŒ-1"><a href="#å®éªŒ-1" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h4><p>å†™ä¸€ä¸ªæ²¡æœ‰<code>inline</code>çš„ä»¿<code>let</code>æ–¹æ³•ï¼Œå†æ›¿æ¢åŸ<code>let</code>ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> T.<span class="title">mylet</span><span class="params">(block: (<span class="type">T</span>)</span></span> -&gt; R): R &#123;</span><br><span class="line">    <span class="keyword">return</span> block(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//No.7</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">(u: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        a?.mylet &#123;</span><br><span class="line">            <span class="keyword">object</span> : Inter &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">a</span><span class="params">()</span></span> &#123;</span><br><span class="line">                    print(u)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸æŠ¥é”™ï¼Œçœ‹æ³•Javaä»£ç ã€‚<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NO.7</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> f(@NotNull <span class="keyword">final</span> <span class="keyword">String</span> u) &#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(u, <span class="string">"u"</span>);</span><br><span class="line">      <span class="keyword">Object</span> var10000 = <span class="keyword">this</span>.a;</span><br><span class="line">      <span class="keyword">if</span> (var10000 != <span class="keyword">null</span>) &#123;</span><br><span class="line">         &lt;undefinedtype&gt; var2 = (&lt;undefinedtype&gt;)TestKt.mylet(var10000, (Function1)(<span class="keyword">new</span> Function1() &#123;</span><br><span class="line">            <span class="comment">// $FF: synthetic method</span></span><br><span class="line">            <span class="comment">// $FF: bridge method</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">Object</span> invoke(<span class="keyword">Object</span> var1) &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">this</span>.invoke(var1);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @NotNull</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">final</span> &lt;undefinedtype&gt; invoke(@NotNull <span class="keyword">Object</span> it) &#123;</span><br><span class="line">               Intrinsics.checkParameterIsNotNull(it, <span class="string">"it"</span>);</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">new</span> Inter() &#123;</span><br><span class="line">                  <span class="keyword">public</span> <span class="keyword">void</span> a() &#123;</span><br><span class="line">                     <span class="keyword">String</span> var1 = u;</span><br><span class="line">                     <span class="built_in">boolean</span> var2 = <span class="keyword">false</span>;</span><br><span class="line">                     System.out.<span class="built_in">print</span>(var1);</span><br><span class="line">                  &#125;</span><br><span class="line">               &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>å†…éƒ¨ç”¨<code>Function1</code> ä»£è¡¨<code>block: (T) -&gt; R</code>è¡¨ç¤ºçš„æ¥å£çš„å®ç°ç±»ã€‚<code>Inter</code>ä¾æ—§æ˜¯å†…éƒ¨ç±»çš„æ–¹å¼å®ç°ã€‚</p><p>å¯è§ï¼Œ<code>inline</code>å…³é”®å­—åœ¨å¤„ç†æ–¹æ³•ä½“ä¸­çš„å†…éƒ¨ç±»ï¼Œåšäº†æ˜æ˜¾çš„ä¼˜åŒ–å¤„ç†ï¼ˆå³ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„å¤–éƒ¨ç±»ï¼‰ã€‚</p><h3 id="é—®é¢˜3"><a href="#é—®é¢˜3" class="headerlink" title="é—®é¢˜3"></a>é—®é¢˜3</h3><p>ç»“åˆé—®é¢˜1ä¸­çš„NO.3å’Œé—®é¢˜2ä»¥åŠå®éªŒï¼Œå‘ç°<code>Inter</code>ä¸­ç”¨åˆ°<code>let</code>å¤–éƒ¨ä¿¡æ¯æ—¶ï¼Œç”Ÿæˆçš„ç±»æ˜¯<code>T$f$$inlined$let$lambda$1</code>ï¼ˆä½†åé¢è¿˜ä¼šå¼ºè½¬ä¸º<code>T$f$1$1</code>ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ª<code>1</code>ï¼Œç„¶åæŠ¥æ‰¾ä¸åˆ°ç±»çš„å®šä¹‰çš„é”™è¯¯ï¼‰ï¼Œè€Œä¸ä½¿ç”¨å¤–éƒ¨çš„ä¿¡æ¯æ—¶ï¼Œç”Ÿæˆçš„ç±»æ˜¯<code>T$f$1$1</code>ã€‚åŒºåˆ†åº¦æ˜¯ä»€ä¹ˆï¼Ÿ</p><h3 id="çŒœæƒ³"><a href="#çŒœæƒ³" class="headerlink" title="çŒœæƒ³"></a>çŒœæƒ³</h3><p>é€šè¿‡inlineå†…è”å‡½æ•°ä¼ å…¥çš„lambdaè¡¨è¾¾å¼ç”Ÿæˆçš„åŒ¿åç±»ï¼Œå¦‚æœæœ‰æŒ‡å‘å¤–éƒ¨çš„å˜é‡ï¼Œé‚£ä¹ˆå‘½åä¸ºï¼šclass + method + inlined + method + lambda + numberã€‚å¦‚æœæ²¡æœ‰ï¼Œå‘½åä¸ºï¼š class + method + number + numberï¼ˆç¬¬ä¸€ä¸ªnumberè¡¨ç¤º<code>let</code>åŒå±‚çº§ç¼–å·ï¼Œç¬¬äºŒä¸ªnumberè¡¨ç¤ºå†…éƒ¨ç±»çš„ç¼–å·ã€‚è€Œç„¶è¿è¡Œä¸­å¤–éƒ¨ç±»åœ¨æ‰§è¡Œcheckcastçš„æ—¶å€™ï¼Œè¿˜æ˜¯æŒ‰ç…§æ—§çš„è§„åˆ™å»ç»„è£…å‘½åã€‚ï¼ˆä»…ä¸ºçŒœæƒ³ï¼Œæœªå¾—åŸå› ï¼‰</p><p>##ç»“è®º<br>å…¶å®è¿˜æ²¡æœ‰å…·ä½“ç»“è®ºï¼é‡åˆ°æ­¤ç±»é—®é¢˜ï¼Œå¤§èƒ†çŒœæƒ³ï¼ŒåŠ¨æ‰‹å®è·µï¼Œæ€»ç»“è§„å¾‹ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-58be1f83080df619.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é—®é¢˜é˜è¿°&quot;&gt;&lt;a href=&quot;#é—®é¢˜é˜è¿°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜é˜è¿°&quot;&gt;&lt;/a&gt;é—®é¢˜é˜è¿°&lt;/h2&gt;&lt;p&gt;kotlin è¿è¡Œè¿™æ®µä»£ç æŠ¥java.lang.NoClassDefFoundErroré”™è¯¯ï¼ˆè¡¨ç¤ºè¿è¡Œä¸­æ‰¾ä¸åˆ°ç±»çš„å®šä¹‰ï¼‰ã€‚å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
    
    </summary>
    
    
      <category term="kotlin" scheme="https://wzmyyj.top/tags/kotlin/"/>
    
  </entry>
  
  <entry>
    <title>ä»¿çŸ¥éŸ³æ¼«å®¢æ¼«ç”»APP--MVPæ¨¡å¼</title>
    <link href="https://wzmyyj.top/2018/08/22/android_2/"/>
    <id>https://wzmyyj.top/2018/08/22/android_2/</id>
    <published>2018-08-22T05:11:12.000Z</published>
    <updated>2020-04-08T03:27:59.485Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ZYMKï¼ˆæ¼«ç”»appï¼‰"><a href="#ZYMKï¼ˆæ¼«ç”»appï¼‰" class="headerlink" title="ZYMKï¼ˆæ¼«ç”»appï¼‰"></a>ZYMKï¼ˆæ¼«ç”»appï¼‰</h2><p>ä¸€æ¬¾é‡‡ç”¨MVPçš„ä»¿ã€ŠçŸ¥éŸ³æ¼«å®¢ã€‹æ¼«ç”»APPã€‚</p><p>mvp + rxjava + retrofit + okhttp + greendao + glide + gson + jsoup + eventbus + butterknife</p><h4 id="é¡¹ç›®åœ°å€ï¼š"><a href="#é¡¹ç›®åœ°å€ï¼š" class="headerlink" title="é¡¹ç›®åœ°å€ï¼š"></a>é¡¹ç›®åœ°å€ï¼š</h4><p><a href="https://github.com/wzmyyj/ZYMK" target="_blank" rel="noopener">https://github.com/wzmyyj/ZYMK</a></p><a id="more"></a><h4 id="æœ€æ–°æ›´æ–°ï¼ˆ2018-06-19ï¼‰"><a href="#æœ€æ–°æ›´æ–°ï¼ˆ2018-06-19ï¼‰" class="headerlink" title="æœ€æ–°æ›´æ–°ï¼ˆ2018.06.19ï¼‰"></a>æœ€æ–°æ›´æ–°ï¼ˆ2018.06.19ï¼‰</h4><ol><li>ç”±å¸¸è§„MVPæ”¹ä¸ºGoogleæ¨èçš„MVP-Contractæ¨¡å¼ã€‚å°†åŸæœ¬çš„presenterå±‚æ¯ä¸ªç±»æŠ½è±¡å‡ºæ¥å£ï¼Œå¹¶å°†è¿™äº›æ¥å£å’Œå¯¹åº”çš„viewçš„æ¥å£ï¼Œæ”¾åœ¨åŒä¸€ä¸ªcontractæ¥å£é‡Œï¼ˆæ¥å£é‡Œæ”¾ä¸¤ä¸ªæ¥å£ï¼‰ã€‚</li></ol><ul><li>æŠ½è±¡å‡ºpå±‚æ¥å£ä½¿vå±‚ä¾èµ–äºpå±‚æ¥å£ï¼ˆçˆ¶ç±»ï¼‰ã€‚ä¾èµ–å€’è½¬åŸåˆ™ã€‚</li><li>ä½¿ç”¨contractå¥½å¤„æ˜¯på±‚ä¸vå±‚ç›¸äº’è°ƒç”¨å…³ç³»åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œä¸€ç›®äº†ç„¶ã€‚ä¸‹æ¬¡ä¼šè¯¦ç»†ä»‹ç»è¿™ç§æ¨¡å¼ã€‚</li></ul><ol start="2"><li><p>ä¿®æ”¹äº†ä¸€äº›å‘½åè§„èŒƒï¼Œç±»åï¼Œæ–¹æ³•åç­‰ã€‚</p></li><li><p>ä¿®æ”¹äº†ä¸€äº›ç±»å®ç°çš„æ–¹æ³•ï¼Œä¿®å¤ä¸€ä¸ªå°bugã€‚</p></li></ol><h4 id="Apkä¸‹è½½ï¼š"><a href="#Apkä¸‹è½½ï¼š" class="headerlink" title="Apkä¸‹è½½ï¼š"></a>Apkä¸‹è½½ï¼š</h4><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1Gp5vcoUx7NEr8n17nM8wwg" target="_blank" rel="noopener">https://pan.baidu.com/s/1Gp5vcoUx7NEr8n17nM8wwg</a> å¯†ç ï¼šb6zq</p><h4 id="é¡¹ç›®åœ°å€ï¼š-1"><a href="#é¡¹ç›®åœ°å€ï¼š-1" class="headerlink" title="é¡¹ç›®åœ°å€ï¼š"></a>é¡¹ç›®åœ°å€ï¼š</h4><p><a href="https://github.com/wzmyyj/ZYMK" target="_blank" rel="noopener">https://github.com/wzmyyj/ZYMK</a></p><h4 id="æ•ˆæœå›¾ï¼š"><a href="#æ•ˆæœå›¾ï¼š" class="headerlink" title="æ•ˆæœå›¾ï¼š"></a>æ•ˆæœå›¾ï¼š</h4><p><img src="https://upload-images.jianshu.io/upload_images/3262738-458c938a01e30e0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="a"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-8e5cdbfd8b1002b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="b"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-01656f1ed477c2e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="p"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-3666b561548ab60b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="b"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-46e77fe88ce2d05c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="d"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-59ef61e1c92014d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="e"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-8d6230878da72de7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="f"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-2c6fea325e8b6f33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="g"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-da02b8b7a7dc43ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt="s"></p><h4 id="å…è´£å£°æ˜ï¼š"><a href="#å…è´£å£°æ˜ï¼š" class="headerlink" title="å…è´£å£°æ˜ï¼š"></a>å…è´£å£°æ˜ï¼š</h4><p>æœ¬ç¨‹åºæ‰€æœ‰èµ„æºå…¨éƒ¨æ¥æºäºç½‘ç»œçˆ¬è™«,ä¸”è§„é¿äº†ä»˜è´¹çš„æ¼«ç”»ï¼Œæ‰€æœ‰çš„æ¼«ç”»åœ¨ç½‘ç»œå¯ä»¥å…è´¹é˜…è¯»çš„ã€‚æœ¬ç¨‹åºä»…ä¾›å­¦ä¹ å‚è€ƒä½¿ç”¨ï¼Œä¸¥ç¦ä»»ä½•å•†ä¸šç”¨é€”ã€‚æ¬¢è¿å„ä½è¿›è¡ŒæŠ€æœ¯è®¨è®ºå’Œäº¤æµã€‚å¦‚æœä¾µçŠ¯åˆ°ä»»ä½•äººçš„åˆ©ç›Šï¼Œå¯ä»¥è”ç³»ä½œè€…QQï¼š2018987032ã€‚è¿›è¡Œåå•†ï¼Œè¿›è¡Œæ¼«ç”»çš„ä¸‹æ¶ã€‚</p><h4 id="åšå®¢ï¼š"><a href="#åšå®¢ï¼š" class="headerlink" title="åšå®¢ï¼š"></a>åšå®¢ï¼š</h4><p>åŒæ­¥äºç®€ä¹¦ï¼š<a href="https://www.jianshu.com/p/80c8541387de" target="_blank" rel="noopener">https://www.jianshu.com/p/80c8541387de</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ZYMKï¼ˆæ¼«ç”»appï¼‰&quot;&gt;&lt;a href=&quot;#ZYMKï¼ˆæ¼«ç”»appï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ZYMKï¼ˆæ¼«ç”»appï¼‰&quot;&gt;&lt;/a&gt;ZYMKï¼ˆæ¼«ç”»appï¼‰&lt;/h2&gt;&lt;p&gt;ä¸€æ¬¾é‡‡ç”¨MVPçš„ä»¿ã€ŠçŸ¥éŸ³æ¼«å®¢ã€‹æ¼«ç”»APPã€‚&lt;/p&gt;
&lt;p&gt;mvp + rxjava + retrofit + okhttp + greendao + glide + gson + jsoup + eventbus + butterknife&lt;/p&gt;
&lt;h4 id=&quot;é¡¹ç›®åœ°å€ï¼š&quot;&gt;&lt;a href=&quot;#é¡¹ç›®åœ°å€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é¡¹ç›®åœ°å€ï¼š&quot;&gt;&lt;/a&gt;é¡¹ç›®åœ°å€ï¼š&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/wzmyyj/ZYMK&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/wzmyyj/ZYMK&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•ã€‘è‘±çš„æˆ˜äº‰ä¸€é“ç®—æ³•é¢˜</title>
    <link href="https://wzmyyj.top/2018/07/08/java_3/"/>
    <id>https://wzmyyj.top/2018/07/08/java_3/</id>
    <published>2018-07-08T08:21:29.000Z</published>
    <updated>2020-04-08T09:10:15.516Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´ï¼ŒåŒå­¦ç»™çœ‹äº†ä¸€é“ï¼ŒæŸä¸ªå†å¹´çš„è€ƒç ”æœºè¯•ç®—æ³•é¢˜ã€‚æˆ‘æƒ³ç”¨é¢å‘å¯¹è±¡çš„æ–¹æ³•å»å®ç°ã€‚</p><a id="more"></a><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p> ä¸€ä¸ªm*nçš„æ£‹ç›˜ï¼Œä¸Šé¢æœ‰kæ ¹è‘±ï¼Œæ¯æ ¹è‘±é¢æœæ–¹å‘ä¸ºdï¼ˆ0123åˆ†åˆ«è¡¨ç¤ºä¸Šä¸‹å·¦å³ï¼‰ï¼Œæ¯æ ¹è‘±ä¸€ä¸ªæˆ˜æ–—åŠ›fã€‚æ¯éš”æ—¶é—´è‘±ä¼šå‘é¢æœæ–¹å‘èµ°ä¸€æ ¼ï¼Œ å¦‚æœé‡åˆ°æ£‹ç›˜è¾¹ç•Œï¼Œé‚£ä¹ˆä»–å°†æŠŠé¢æœæ–¹å‘è½¬180åº¦ï¼ˆæ­¤å›åˆè‘±ä¸ä¼šèµ°åŠ¨ï¼‰ï¼Œå¦‚æœæŸä¸ªæ—¶åˆ»æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„è‘±åœ¨åŒä¸€ä½ç½®ï¼Œé‚£ä¹ˆä»–ä»¬å°†å‘ç”Ÿ æˆ˜äº‰ï¼Œåªæœ‰æˆ˜æ–—åŠ›æœ€é«˜çš„è‘±å­˜æ´»ï¼Œå…¶ä»–çš„è‘±å…¨éƒ¨åŸåœ°æ¯èï¼Œä¸åœ¨èµ°åŠ¨ï¼Œæ±‚ç»è¿‡tæ—¶é—´åæ‰€æœ‰è‘±çš„ä½ç½®ã€‚ </p><ul><li>è¾“å…¥ï¼šç¬¬ä¸€è¡Œm n kï¼Œç„¶åæ¥ä¸‹æ¥kè¡Œæ¯æ ¹è‘±çš„ä¿¡æ¯x y d fï¼ˆåæ ‡ï¼Œæ–¹å‘ï¼Œæˆ˜æ–—åŠ›ï¼‰ï¼Œæœ€åä¸€è¡Œè¾“å…¥æ—¶é—´tã€‚  </li><li>è¾“å‡ºï¼škè¡Œï¼Œåˆ†åˆ«è¡¨ç¤ºæ¯ä¸ªè‘±çš„ä½ç½®ã€‚   </li><li>æ•°æ®èŒƒå›´ï¼šmå’Œnåœ¨100å†…ï¼Œkåœ¨1000å†…ï¼Œtåœ¨1000å†…ï¼Œfåœ¨1000å†…ï¼Œä¿è¯åˆå§‹æ¯é¢—è‘±ä½ç½®ä¸åŒï¼Œæˆ˜æ–—åŠ›ä¸åŒã€‚</li></ul><h4 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h4><ol><li><p>å»ºä¸€ä¸ªCongï¼ˆè‘±ï¼‰ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cong</span> </span>&#123;<span class="comment">// è‘±</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> d;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> f;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isLive = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Cong</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> d, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">        <span class="keyword">this</span>.d = d;</span><br><span class="line">        <span class="keyword">this</span>.f = f;</span><br><span class="line">        <span class="keyword">this</span>.isLive = <span class="keyword">true</span>;<span class="comment">// é»˜è®¤å­˜æ´»</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//   æ­¤å¤„çœç•¥ set å’Œget æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">()</span> </span>&#123;<span class="comment">// èµ°</span></span><br><span class="line">        <span class="keyword">if</span> (!isLive)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">switch</span> (d) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            y++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            y--;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            x--;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            x++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turn</span><span class="params">()</span> </span>&#123;<span class="comment">// è½¬å‘</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.isLive)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">switch</span> (d) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            d = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            d = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            d = <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            d = <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fight</span><span class="params">(Cong c)</span> </span>&#123;<span class="comment">// æ‰“æ¶</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.isLive || !c.isLive())<span class="comment">// æ­»äº†æ²¡ï¼Ÿ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.x == c.getX() &amp;&amp; <span class="keyword">this</span>.y == c.getY()) &#123;<span class="comment">// é‡è§æ²¡ï¼Ÿ</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.f &gt; c.getF()) &#123;</span><br><span class="line">                c.setLive(<span class="keyword">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.f &lt; c.getF()) &#123;</span><br><span class="line">                <span class="keyword">this</span>.setLive(<span class="keyword">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.setLive(<span class="keyword">false</span>);</span><br><span class="line">                c.setLive(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Panï¼ˆæ£‹ç›˜ï¼‰ç±»</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pan</span> </span>&#123;<span class="comment">// æ£‹ç›˜</span></span><br><span class="line">    <span class="keyword">private</span> int m;</span><br><span class="line">    <span class="keyword">private</span> int n;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">Cong</span>&gt; g;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">Pan</span>(int m, int n, <span class="type">List</span>&lt;<span class="type">Cong</span>&gt; g) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        this.m = m;</span><br><span class="line">        this.n = n;</span><br><span class="line">        this.g = g;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> void run() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">Cong</span> <span class="built_in">c</span> : g) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">c</span>.isLive())<span class="comment">// æ­»äº¡</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            war(<span class="built_in">c</span>);<span class="comment">// æˆ˜äº‰</span></span><br><span class="line">            <span class="keyword">if</span> (isTurn(<span class="built_in">c</span>)) &#123;<span class="comment">// è¡ŒåŠ¨</span></span><br><span class="line">                <span class="built_in">c</span>.turn();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">c</span>.go();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> boolean isTurn(<span class="type">Cong</span> <span class="built_in">c</span>) &#123;<span class="comment">// æ˜¯å¦è½¬å‘</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">c</span>.getX() == <span class="number">0</span> &amp;&amp; <span class="built_in">c</span>.getD() == <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">c</span>.getX() == m - <span class="number">1</span> &amp;&amp; <span class="built_in">c</span>.getD() == <span class="number">4</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">c</span>.getY() == <span class="number">0</span> &amp;&amp; <span class="built_in">c</span>.getD() == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">c</span>.getX() == n - <span class="number">1</span> &amp;&amp; <span class="built_in">c</span>.getD() == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> void war(<span class="type">Cong</span> <span class="built_in">c</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">Cong</span> c1 : g) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">c</span> != c1)<span class="comment">// ä¸è·Ÿè‡ªå·±æ‰“</span></span><br><span class="line">                <span class="built_in">c</span>.fight(c1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯ä»£ç </p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Client</span> &#123;<span class="comment">// å®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è¾“å…¥</span></span><br><span class="line">        Scanner can = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">        <span class="keyword">int</span> m = can.nextInt();</span><br><span class="line">        <span class="keyword">int</span> n = can.nextInt();</span><br><span class="line">        <span class="keyword">int</span> k = can.nextInt();</span><br><span class="line"></span><br><span class="line">        List&lt;Cong&gt; g = <span class="keyword">new</span> ArrayList&lt;Cong&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = can.nextInt();</span><br><span class="line">            <span class="keyword">int</span> y = can.nextInt();</span><br><span class="line">            <span class="keyword">int</span> d = can.nextInt();</span><br><span class="line">            <span class="keyword">int</span> f = can.nextInt();</span><br><span class="line">            Cong c = <span class="keyword">new</span> Cong(x, y, d, f);</span><br><span class="line">            g.<span class="keyword">add</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> t = can.nextInt();</span><br><span class="line">        can.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€»è¾‘æ“ä½œ</span></span><br><span class="line">        Pan p = <span class="keyword">new</span> Pan(m, n, g);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t; i++) &#123;<span class="comment">// æ‰§è¡Œtæ¬¡</span></span><br><span class="line">            p.run();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡º</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">            Cong c = g.<span class="keyword">get</span>(i);</span><br><span class="line">            System.<span class="keyword">out</span>.print(c.getX() + <span class="string">" "</span> + c.getY() + <span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="é™„é¡µ"><a href="#é™„é¡µ" class="headerlink" title="é™„é¡µ"></a>é™„é¡µ</h4><p>æºç åœ°å€ï¼š<a href="https://github.com/wzmyyj/CongWar" target="_blank" rel="noopener">https://github.com/wzmyyj/CongWar</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰æ®µæ—¶é—´ï¼ŒåŒå­¦ç»™çœ‹äº†ä¸€é“ï¼ŒæŸä¸ªå†å¹´çš„è€ƒç ”æœºè¯•ç®—æ³•é¢˜ã€‚æˆ‘æƒ³ç”¨é¢å‘å¯¹è±¡çš„æ–¹æ³•å»å®ç°ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://wzmyyj.top/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>å°æ•…äº‹ï¼šèš‚èšçš„æŠ‰æ‹©</title>
    <link href="https://wzmyyj.top/2018/07/01/story_1/"/>
    <id>https://wzmyyj.top/2018/07/01/story_1/</id>
    <published>2018-07-01T09:20:00.000Z</published>
    <updated>2020-04-08T08:13:21.624Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ•…äº‹"><a href="#æ•…äº‹" class="headerlink" title="æ•…äº‹"></a>æ•…äº‹</h4><p>ä¸€å¤©ï¼Œä¸€åªå°èš‚èšï¼Œæ¥åˆ°ä¸€ä¸ªä¸‰å‰è·¯å£ã€‚</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/3262738-89fe91028607c777.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æˆ‘åƒèš‚èšå—ï¼Ÿï¼Ÿï¼Ÿ"></p><p>å·¦è¾¹çš„è·¯è¿‡å»ï¼Œä¼šæœ‰ä¸€å—é¦™ç”œçš„å¥¶é…ªã€‚ä½†æ˜¯ï¼Œè·¯çš„å¦ä¸€ç«¯ï¼Œæœ‰ä¸€åªæ›´å¤§çš„èš‚èšæ­£åœ¨æ…¢æ…¢é è¿‘ï¼Œè™½ç„¶å®ƒçš„è·ç¦»æ›´è¿œäº›ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¿‡å»åƒå¥¶é…ªï¼Œåªèƒ½åƒä¸Šå‡ å£ï¼Œç„¶åéœ€è¦ä¸å¤§èš‚èšæ‰“ä¸€æ¶ï¼Œå†³å®šæ˜¯å¦å¾—åˆ°å‰©ä½™çš„å¤§åŠå¥¶é…ªã€‚</p><p>å³è¾¹çš„è·¯è¿‡å»ï¼Œåœ¨æ›´è¿œçš„ä¸€å¤„ï¼Œä¹Ÿæœ‰ä¸€å—ç±»ä¼¼çš„å¥¶é…ªã€‚ä½†æ˜¯ï¼Œæ²¡æ³•ç¡®å®šé‚£è¾¹æ˜¯å¦æœ‰å…¶ä»–èš‚èšã€‚å¦‚æœæœ‰ï¼Œä¹Ÿä¸ç¡®å®šæ˜¯å¦æ¯”è‡ªå·±å¤§ï¼Œæ˜¯å¦æ‰“å¾—è¿‡å®ƒã€‚</p><p>é‚£æ—¶ï¼Œâ€¦</p><p>å°èš‚èšæ²¡æœ‰è¿‡å»ï¼Œè€Œæ˜¯å›å¤´å»äº†åˆ«çš„åœ°æ–¹ã€‚åˆ°äº†åˆ«çš„åœ°æ–¹ï¼Œå°èš‚èšå‘ç°äº†ä¸€å—èƒ½åƒäº†å¯ä»¥æ…¢æ…¢å˜å›æ¥çš„å¥¶é…ªã€‚å°èš‚èšé«˜å…´çš„å“å°ç€è¿™ä»½ç”œèœœï¼Œåƒå¾—å·®ä¸å¤šäº†ï¼Œå…ˆæŠŠå‰©ä¸‹çš„ç•™ç€ï¼Œå®ƒä¼šè‡ªå·±æ…¢æ…¢å˜å›æ¥ã€‚æ­¤åï¼Œå°èš‚èšå¾€å¾€åªè¿‡ä¸€æ®µæ—¶é—´åƒå‡ å£ã€‚</p><p>æœ€åï¼Œâ€¦</p><p>æœ‰é‚£ä¹ˆä¸€å¤©ï¼Œå¥¶é…ªè¢«å‘½è¿å¤ºèµ°äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;æ•…äº‹&quot;&gt;&lt;a href=&quot;#æ•…äº‹&quot; class=&quot;headerlink&quot; title=&quot;æ•…äº‹&quot;&gt;&lt;/a&gt;æ•…äº‹&lt;/h4&gt;&lt;p&gt;ä¸€å¤©ï¼Œä¸€åªå°èš‚èšï¼Œæ¥åˆ°ä¸€ä¸ªä¸‰å‰è·¯å£ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ•…äº‹" scheme="https://wzmyyj.top/tags/%E6%95%85%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºHTTPåè®®ä½ éœ€è¦çŸ¥é“è¿™äº›</title>
    <link href="https://wzmyyj.top/2018/06/09/it_5/"/>
    <id>https://wzmyyj.top/2018/06/09/it_5/</id>
    <published>2018-06-09T03:45:50.000Z</published>
    <updated>2020-07-21T02:51:10.434Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p><strong>è¶…æ–‡æœ¬ä¼ è¾“åè®®</strong>ï¼ˆè‹±æ–‡ï¼š<strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocolï¼Œç¼©å†™ï¼š<strong>HTTP</strong>ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„<a href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82" title="åº”ç”¨å±‚" target="_blank" rel="noopener">åº”ç”¨å±‚åè®®</a><sup><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#cite_note-ietf2616-1" target="_blank" rel="noopener">[1]</a></sup>ã€‚HTTPæ˜¯<a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E7%90%83%E8%B3%87%E8%A8%8A%E7%B6%B2" title="ä¸‡ç»´ç½‘" target="_blank" rel="noopener">ä¸‡ç»´ç½‘</a>çš„æ•°æ®é€šä¿¡çš„åŸºç¡€ã€‚</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/3262738-968561d7567c78db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="HTTP"></p><p><strong>HTTP</strong>æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ç»ˆç«¯ï¼ˆç”¨æˆ·ï¼‰å’ŒæœåŠ¡å™¨ç«¯ï¼ˆç½‘ç«™ï¼‰è¯·æ±‚å’Œåº”ç­”çš„æ ‡å‡†ï¼ˆ<a href="https://zh.wikipedia.org/wiki/TCP" title="TCP" target="_blank" rel="noopener">TCP</a>ï¼‰ã€‚é€šè¿‡ä½¿ç”¨ç½‘é¡µæµè§ˆå™¨ã€ç½‘ç»œçˆ¬è™«æˆ–è€…å…¶å®ƒçš„å·¥å…·ï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æœåŠ¡å™¨ä¸ŠæŒ‡å®šç«¯å£ï¼ˆé»˜è®¤ç«¯å£ä¸º80ï¼‰ã€‚</p><blockquote><p>è®¾è®¡HTTPæœ€åˆçš„ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶<a href="https://zh.wikipedia.org/wiki/HTML" title="HTML" target="_blank" rel="noopener">HTML</a>é¡µé¢çš„æ–¹æ³•ã€‚é€šè¿‡HTTPæˆ–è€…HTTPSåè®®è¯·æ±‚çš„èµ„æºç”±ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiersï¼ŒURIï¼‰æ¥æ ‡è¯†ã€‚</p></blockquote><h4 id="ä¸»è¦ç‰¹å¾"><a href="#ä¸»è¦ç‰¹å¾" class="headerlink" title="ä¸»è¦ç‰¹å¾"></a>ä¸»è¦ç‰¹å¾</h4><ol><li><p>æ”¯æŒB/SåŠC/Sæ¨¡å¼ã€‚</p></li><li><p>ç®€å•å¿«é€Ÿï¼š<br>2.1 å®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚<br>2.2 è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰GETã€HEADã€POSTç­‰ï¼Œåˆ†åˆ«è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨ä¸åŒçš„è”ç³»ç±»å‹ã€‚<br>2.3 HTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œé€šä¿¡é€Ÿåº¦å¿«ã€‚</p></li><li><p>çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-TypeåŠ ä»¥æ ‡è®°ã€‚</p></li><li><p>æ— è¿æ¥ï¼šæ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚</p></li><li>æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚</li></ol><h4 id="è¯·æ±‚æ–¹æ³•"><a href="#è¯·æ±‚æ–¹æ³•" class="headerlink" title="è¯·æ±‚æ–¹æ³•"></a>è¯·æ±‚æ–¹æ³•</h4><p>ä¸€å…±æœ‰å…«ç§è¯·æ±‚æ–¹å¼ï¼š</p><ol><li><strong>GET</strong><br>å‘æŒ‡å®šçš„èµ„æºå‘å‡ºâ€œæ˜¾ç¤ºâ€è¯·æ±‚ã€‚ä½¿ç”¨GETæ–¹æ³•åº”è¯¥åªç”¨åœ¨è¯»å–æ•°æ®ï¼Œè€Œä¸åº”å½“è¢«ç”¨äºäº§ç”Ÿâ€œå‰¯ä½œç”¨â€çš„æ“ä½œä¸­ï¼Œä¾‹å¦‚åœ¨Web Applicationä¸­ã€‚å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯GETå¯èƒ½ä¼šè¢«ç½‘ç»œèœ˜è››ç­‰éšæ„è®¿é—®ã€‚</li><li><strong>HEAD</strong><br>ä¸GETæ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯å‘æœåŠ¡å™¨å‘å‡ºæŒ‡å®šèµ„æºçš„è¯·æ±‚ã€‚åªä¸è¿‡æœåŠ¡å™¨å°†ä¸ä¼ å›èµ„æºçš„æœ¬æ–‡éƒ¨åˆ†ã€‚å®ƒçš„å¥½å¤„åœ¨äºï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨ä¸å¿…ä¼ è¾“å…¨éƒ¨å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–å…¶ä¸­â€œå…³äºè¯¥èµ„æºçš„ä¿¡æ¯â€ï¼ˆå…ƒä¿¡æ¯æˆ–ç§°å…ƒæ•°æ®ï¼‰ã€‚</li><li><strong>POST</strong><br>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®ï¼Œè¯·æ±‚æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚æœ¬æ–‡ä¸­ã€‚è¿™ä¸ªè¯·æ±‚å¯èƒ½ä¼šåˆ›å»ºæ–°çš„èµ„æºæˆ–ä¿®æ”¹ç°æœ‰èµ„æºï¼Œæˆ–äºŒè€…çš†æœ‰ã€‚</li><li><strong>PUT</strong><br>å‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ã€‚</li><li><strong>DELETE</strong><br>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æºã€‚</li><li><strong>TRACE</strong><br>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</li><li><strong>OPTIONS</strong><br>è¿™ä¸ªæ–¹æ³•å¯ä½¿æœåŠ¡å™¨ä¼ å›è¯¥èµ„æºæ‰€æ”¯æŒçš„æ‰€æœ‰HTTPè¯·æ±‚æ–¹æ³•ã€‚ç”¨â€™*â€™æ¥ä»£æ›¿èµ„æºåç§°ï¼Œå‘WebæœåŠ¡å™¨å‘é€OPTIONSè¯·æ±‚ï¼Œå¯ä»¥æµ‹è¯•æœåŠ¡å™¨åŠŸèƒ½æ˜¯å¦æ­£å¸¸è¿ä½œã€‚</li><li><strong>CONNECT</strong><br>HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºSSLåŠ å¯†æœåŠ¡å™¨çš„é“¾æ¥ï¼ˆç»ç”±éåŠ å¯†çš„HTTPä»£ç†æœåŠ¡å™¨ï¼‰ã€‚</li></ol><h4 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h4><p><strong>HTTP</strong>å“åº”ä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š<strong>çŠ¶æ€è¡Œ</strong>ã€<strong>æ¶ˆæ¯æŠ¥å¤´</strong>ã€<strong>å“åº”æ­£æ–‡</strong></p><ol><li><strong>çŠ¶æ€è¡Œ</strong><br>HTTP-Version Status-Code Reason-Phrase CRLF<br>1.1 HTTP-Versionè¡¨ç¤ºæœåŠ¡å™¨HTTPåè®®çš„ç‰ˆæœ¬ï¼›<br>1.2 Status-Codeè¡¨ç¤ºæœåŠ¡å™¨å‘å›çš„å“åº”çŠ¶æ€ä»£ç ï¼›<br>1.3 Reason-Phraseè¡¨ç¤ºçŠ¶æ€ä»£ç çš„æ–‡æœ¬æè¿°ã€‚</li></ol><p>çŠ¶æ€ä»£ç æœ‰ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œä¸”æœ‰äº”ç§å¯èƒ½å–å€¼ï¼š<br>1xxï¼šæŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†<br>2xxï¼šæˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—<br>3xxï¼šé‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ<br>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°<br>5xxï¼šæœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚</p><p>å¸¸è§çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ã€è¯´æ˜ï¼š<br><code>200 OK</code>  //å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ<br><code>400 Bad Request</code> //å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£<br><code>401 Unauthorized</code> //è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨<br><code>403 Forbidden</code>  //æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡<br><code>404 Not Found</code>  //è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„URL<br><code>500 Internal Server Error</code> //æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯<br><code>503 Server Unavailable</code>  //æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸<br>å…¶ä»–ä»£ç è¯·å‚è€ƒ<a href="https://blog.csdn.net/qq_32671287/article/details/79447951" target="_blank" rel="noopener">è¿™ç¯‡</a></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼šHTTP/<span class="number">1.1</span> <span class="number">200</span> OK ï¼ˆCRLFï¼‰</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>æ¶ˆæ¯æŠ¥å¤´</strong><br>å†…å®¹è¾ƒé•¿ï¼Œè¯·å‚è€ƒ<a href="https://www.cnblogs.com/li0803/archive/2008/11/03/1324746.html" target="_blank" rel="noopener">HTTPåè®®è¯¦è§£ï¼ˆçœŸçš„å¾ˆç»å…¸ï¼‰</a></li><li><strong>å“åº”æ­£æ–‡</strong><br>å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å†…å®¹ã€‚</li></ol><h2 id="åè®®ä¾‹å­"><a href="#åè®®ä¾‹å­" class="headerlink" title="åè®®ä¾‹å­"></a>åè®®ä¾‹å­</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªHTTPå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼šè¯çš„ä¾‹å­ï¼Œè¿è¡Œäº<a href="http://www.google.comï¼Œç«¯å£80ã€‚" target="_blank" rel="noopener">www.google.comï¼Œç«¯å£80ã€‚</a></p><h4 id="è¯·æ±‚ä¿¡æ¯"><a href="#è¯·æ±‚ä¿¡æ¯" class="headerlink" title="è¯·æ±‚ä¿¡æ¯"></a>è¯·æ±‚ä¿¡æ¯</h4><p>å‘å‡ºçš„è¯·æ±‚ä¿¡æ¯ï¼ˆmessage requestï¼‰åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ª:</p><ol><li>è¯·æ±‚è¡Œï¼ˆä¾‹å¦‚GET /images/logo.gif HTTP/1.1ï¼Œè¡¨ç¤ºä»/imagesç›®å½•ä¸‹è¯·æ±‚logo.gifè¿™ä¸ªæ–‡ä»¶ï¼‰ã€‚</li><li>è¯·æ±‚å¤´ï¼ˆä¾‹å¦‚Accept-Language: enï¼‰ã€‚</li><li>ç©ºè¡Œã€‚</li><li>å…¶ä»–æ¶ˆæ¯ä½“ã€‚</li></ol><p>è¯·æ±‚è¡Œå’Œæ ‡é¢˜å¿…é¡»ä»¥<cr><lf>ä½œä¸ºç»“å°¾ã€‚ç©ºè¡Œå†…å¿…é¡»åªæœ‰<cr><lf>è€Œæ— å…¶ä»–ç©ºæ ¼ã€‚åœ¨HTTP/1.1åè®®ä¸­ï¼Œæ‰€æœ‰çš„è¯·æ±‚å¤´ï¼Œé™¤Hostå¤–ï¼Œéƒ½æ˜¯å¯é€‰çš„ã€‚</lf></cr></lf></cr></p><ul><li><strong>å®¢æˆ·ç«¯è¯·æ±‚</strong><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.google.com</span><br></pre></td></tr></table></figure></li></ul><p>ï¼ˆæœ«å°¾æœ‰ä¸€ä¸ªç©ºè¡Œã€‚ç¬¬ä¸€è¡ŒæŒ‡å®šæ–¹æ³•ã€èµ„æºè·¯å¾„ã€åè®®ç‰ˆæœ¬ï¼›ç¬¬äºŒè¡Œæ˜¯åœ¨1.1ç‰ˆé‡Œå¿…å¸¦çš„ä¸€ä¸ªheaderä½œç”¨æŒ‡å®šä¸»æœºï¼‰</p><ul><li><strong>æœåŠ¡å™¨åº”ç­”</strong><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Content-<span class="string">Length:</span> <span class="number">3059</span></span><br><span class="line"><span class="string">Server:</span> GWS/<span class="number">2.0</span></span><br><span class="line"><span class="string">Date:</span> Sat, <span class="number">11</span> Jan <span class="number">2003</span> <span class="number">02</span>:<span class="number">44</span>:<span class="number">04</span> GMT</span><br><span class="line">Content-<span class="string">Type:</span> text/html</span><br><span class="line">Cache-<span class="string">control:</span> <span class="keyword">private</span></span><br><span class="line">Set-<span class="string">Cookie:</span> PREF=ID=<span class="number">73</span><span class="string">d4aef52e57bae9:</span>TM=<span class="number">1042253044</span>:LM=<span class="number">1042253044</span>:S=SMCc_HRPCQiqy</span><br><span class="line">X9j; expires=Sun, <span class="number">17</span>-Jan<span class="number">-2038</span> <span class="number">19</span>:<span class="number">14</span>:<span class="number">07</span> GMT; path=/; domain=.google.com</span><br><span class="line"><span class="string">Connection:</span> keep-alive</span><br></pre></td></tr></table></figure></li></ul><p>ï¼ˆç´§è·Ÿç€ä¸€ä¸ªç©ºè¡Œï¼Œå¹¶ä¸”ç”±HTMLæ ¼å¼çš„æ–‡æœ¬ç»„æˆäº†Googleçš„ä¸»é¡µï¼‰</p><h2 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h2><p><strong>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰</strong>å·²ç»æ¼”åŒ–å‡ºäº†å¾ˆå¤šç‰ˆæœ¬ï¼Œå®ƒä»¬ä¸­çš„å¤§éƒ¨åˆ†éƒ½æ˜¯å‘ä¸‹å…¼å®¹çš„ã€‚åœ¨ RFC 2145 ä¸­æè¿°äº†HTTPç‰ˆæœ¬å·çš„ç”¨æ³•ã€‚å®¢æˆ·ç«¯åœ¨è¯·æ±‚çš„å¼€å§‹å‘Šè¯‰æœåŠ¡å™¨å®ƒé‡‡ç”¨çš„åè®®ç‰ˆæœ¬å·ï¼Œè€Œåè€…åˆ™åœ¨å“åº”ä¸­é‡‡ç”¨ç›¸åŒæˆ–è€…æ›´æ—©çš„åè®®ç‰ˆæœ¬ã€‚</p><h4 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP/0.9"></a>HTTP/0.9</h4><p>å·²è¿‡æ—¶ã€‚åªæ¥å—GETä¸€ç§è¯·æ±‚æ–¹æ³•ï¼Œæ²¡æœ‰åœ¨é€šè®¯ä¸­æŒ‡å®šç‰ˆæœ¬å·ï¼Œä¸”ä¸æ”¯æŒè¯·æ±‚å¤´ã€‚ç”±äºè¯¥ç‰ˆæœ¬ä¸æ”¯æŒPOSTæ–¹æ³•ï¼Œå› æ­¤å®¢æˆ·ç«¯æ— æ³•å‘æœåŠ¡å™¨ä¼ é€’å¤ªå¤šä¿¡æ¯ã€‚</p><h4 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP/1.0"></a>HTTP/1.0</h4><p>è¿™æ˜¯ç¬¬ä¸€ä¸ªåœ¨é€šè®¯ä¸­æŒ‡å®šç‰ˆæœ¬å·çš„HTTPåè®®ç‰ˆæœ¬ï¼Œè‡³ä»Šä»è¢«å¹¿æ³›é‡‡ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ä»£ç†æœåŠ¡å™¨ä¸­ã€‚</p><h4 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP/1.1"></a>HTTP/1.1</h4><p>æŒä¹…è¿æ¥è¢«é»˜è®¤é‡‡ç”¨ï¼Œå¹¶èƒ½å¾ˆå¥½åœ°é…åˆä»£ç†æœåŠ¡å™¨å·¥ä½œã€‚è¿˜æ”¯æŒä»¥ç®¡é“æ–¹å¼åœ¨åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»¥ä¾¿é™ä½çº¿è·¯è´Ÿè½½ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦ã€‚<br>HTTP/1.1ç›¸è¾ƒäºHTTP/1.0åè®®çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ï¼š</p><ul><li>ç¼“å­˜å¤„ç†</li><li>å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨</li><li>é”™è¯¯é€šçŸ¥çš„ç®¡ç†</li><li>æ¶ˆæ¯åœ¨ç½‘ç»œä¸­çš„å‘é€</li><li>äº’è”ç½‘åœ°å€çš„ç»´æŠ¤</li><li>å®‰å…¨æ€§åŠå®Œæ•´æ€§</li></ul><blockquote><p>åœ¨HTTP 0.9å’Œ1.0ä¸­ï¼Œ<a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE" title="ä¼ è¾“æ§åˆ¶åè®®" target="_blank" rel="noopener">TCPè¿æ¥</a>åœ¨æ¯ä¸€æ¬¡è¯·æ±‚/å›åº”å¯¹ä¹‹åå…³é—­ã€‚åœ¨HTTP 1.1ä¸­ï¼Œå¼•å…¥äº†ä¿æŒè¿æ¥çš„æœºåˆ¶ï¼Œä¸€ä¸ªè¿æ¥å¯ä»¥é‡å¤åœ¨å¤šä¸ªè¯·æ±‚/å›åº”ä½¿ç”¨ã€‚æŒç»­è¿æ¥çš„æ–¹å¼å¯ä»¥å¤§å¤§å‡å°‘ç­‰å¾…æ—¶é—´ï¼Œå› ä¸ºåœ¨å‘å‡ºç¬¬ä¸€ä¸ªè¯·æ±‚åï¼ŒåŒæ–¹ä¸éœ€è¦é‡æ–°è¿è¡ŒTCPäº¤æ¡ç¨‹åºã€‚</p></blockquote><h4 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h4><p>å½“å‰ç‰ˆæœ¬ï¼Œäº2015å¹´5æœˆä½œä¸ºäº’è”ç½‘æ ‡å‡†æ­£å¼å‘å¸ƒã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-18abea8f497619f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p><h2 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h2><p>å°½ç®¡<a href="https://zh.wikipedia.org/wiki/TCP/IP" title="TCP/IP" target="_blank" rel="noopener">TCP/IP</a>åè®®æ˜¯äº’è”ç½‘ä¸Šæœ€æµè¡Œçš„åº”ç”¨ï¼ŒHTTPåè®®ä¸­ï¼Œå¹¶æ²¡æœ‰è§„å®šå¿…é¡»ä½¿ç”¨å®ƒæˆ–å®ƒæ”¯æŒçš„å±‚ã€‚äº‹å®ä¸Šï¼ŒHTTPå¯ä»¥åœ¨ä»»ä½•äº’è”ç½‘åè®®ä¸Šï¼Œæˆ–å…¶ä»–ç½‘ç»œä¸Šå®ç°ã€‚HTTPå‡å®šå…¶ä¸‹å±‚åè®®æä¾›å¯é çš„ä¼ è¾“ã€‚å› æ­¤ï¼Œä»»ä½•èƒ½å¤Ÿæä¾›è¿™ç§ä¿è¯çš„åè®®éƒ½å¯ä»¥è¢«å…¶ä½¿ç”¨ã€‚å› æ­¤ä¹Ÿå°±æ˜¯å…¶åœ¨TCP/IPåè®®æ—ä½¿ç”¨TCPä½œä¸ºå…¶ä¼ è¾“å±‚ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;HTTP&quot;&gt;&lt;a href=&quot;#HTTP&quot; class=&quot;headerlink&quot; title=&quot;HTTP&quot;&gt;&lt;/a&gt;HTTP&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;è¶…æ–‡æœ¬ä¼ è¾“åè®®&lt;/strong&gt;ï¼ˆè‹±æ–‡ï¼š&lt;strong&gt;H&lt;/strong&gt;yper&lt;strong&gt;T&lt;/strong&gt;ext &lt;strong&gt;T&lt;/strong&gt;ransfer &lt;strong&gt;P&lt;/strong&gt;rotocolï¼Œç¼©å†™ï¼š&lt;strong&gt;HTTP&lt;/strong&gt;ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82&quot; title=&quot;åº”ç”¨å±‚&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åº”ç”¨å±‚åè®®&lt;/a&gt;&lt;sup&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#cite_note-ietf2616-1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;ã€‚HTTPæ˜¯&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%85%A8%E7%90%83%E8%B3%87%E8%A8%8A%E7%B6%B2&quot; title=&quot;ä¸‡ç»´ç½‘&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸‡ç»´ç½‘&lt;/a&gt;çš„æ•°æ®é€šä¿¡çš„åŸºç¡€ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="IT" scheme="https://wzmyyj.top/tags/IT/"/>
    
  </entry>
  
  <entry>
    <title>Javaè·å–ä¸­æ–‡é¦–å­—æ¯</title>
    <link href="https://wzmyyj.top/2018/06/08/java_2/"/>
    <id>https://wzmyyj.top/2018/06/08/java_2/</id>
    <published>2018-06-08T08:21:29.000Z</published>
    <updated>2020-04-08T03:09:05.373Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸­æ–‡é¦–å­—æ¯"><a href="#ä¸­æ–‡é¦–å­—æ¯" class="headerlink" title="ä¸­æ–‡é¦–å­—æ¯"></a>ä¸­æ–‡é¦–å­—æ¯</h2><p>æœ‰æ—¶å€™ï¼Œæ¯”å¦‚å¾®ä¿¡ä¸Šæ ¹æ®åå­—æ‹¼éŸ³é¦–å­—æ¯æ’åºå¹¶æ£€ç´¢ã€‚é‚£ä¹ˆç”¨Javaè·å–ä¸­æ–‡é¦–å­—æ¯æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p><a id="more"></a><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼šï¼ˆå†™ä¸ªå·¥å…·ç±»ï¼‰<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class FirstCharUtil &#123;</span><br><span class="line">    <span class="comment">// ç®€ä½“ä¸­æ–‡çš„ç¼–ç èŒƒå›´ä»B0A1ï¼ˆ45217ï¼‰ä¸€ç›´åˆ°F7FEï¼ˆ63486ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> BEGIN = <span class="number">45217</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> END = <span class="number">63486</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‰ç…§å£° æ¯è¡¨ç¤ºï¼Œè¿™ä¸ªè¡¨æ˜¯åœ¨GB2312ä¸­çš„å‡ºç°çš„ç¬¬ä¸€ä¸ªæ±‰å­—ï¼Œ</span></span><br><span class="line">    <span class="comment">//ä¹Ÿå°±æ˜¯è¯´â€œå•Šâ€æ˜¯ä»£è¡¨é¦–å­—æ¯açš„ç¬¬ä¸€ä¸ªæ±‰å­—ã€‚</span></span><br><span class="line">    <span class="comment">// i, u, véƒ½ä¸åšå£°æ¯, è‡ªå®šè§„åˆ™è·Ÿéšå‰é¢çš„å­—æ¯</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">char</span>[] charTable = &#123; <span class="string">'å•Š'</span>, <span class="string">'èŠ­'</span>, <span class="string">'æ“¦'</span>, <span class="string">'æ­'</span>, <span class="string">'è›¾'</span>, <span class="string">'å‘'</span>, <span class="string">'å™¶'</span>, <span class="string">'å“ˆ'</span>,</span><br><span class="line">            <span class="string">'å“ˆ'</span>, <span class="string">'å‡»'</span>, <span class="string">'å–€'</span>, <span class="string">'åƒ'</span>, <span class="string">'å¦ˆ'</span>, <span class="string">'æ‹¿'</span>, <span class="string">'å“¦'</span>, <span class="string">'å•ª'</span>, <span class="string">'æœŸ'</span>, <span class="string">'ç„¶'</span>, <span class="string">'æ’’'</span>, <span class="string">'å¡Œ'</span>, <span class="string">'å¡Œ'</span>,</span><br><span class="line">            <span class="string">'å¡Œ'</span>, <span class="string">'æŒ–'</span>, <span class="string">'æ˜”'</span>, <span class="string">'å‹'</span>, <span class="string">'åŒ'</span>, &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äºŒåå…­ä¸ªå­—æ¯åŒºé—´å¯¹åº”äºŒåä¸ƒä¸ªç«¯ç‚¹</span></span><br><span class="line">    <span class="comment">// GB2312ç æ±‰å­—åŒºé—´åè¿›åˆ¶è¡¨ç¤º</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span>[] table = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">27</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹åº”é¦–å­—æ¯åŒºé—´è¡¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">char</span>[] initialTable = &#123; <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>,</span><br><span class="line">            <span class="string">'H'</span>, <span class="string">'H'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>,</span><br><span class="line">            <span class="string">'T'</span>, <span class="string">'T'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>, &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// å¾—åˆ°GB2312ç çš„é¦–å­—æ¯åŒºé—´ç«¯ç‚¹è¡¨ï¼Œåè¿›åˆ¶ã€‚</span></span><br><span class="line">            table[i] = gbValue(charTable[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        table[<span class="number">26</span>] = END;<span class="comment">// åŒºé—´è¡¨ç»“å°¾</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ------------------------publicæ–¹æ³•åŒº------------------------</span></span><br><span class="line">    <span class="comment">// æ ¹æ®ä¸€ä¸ªåŒ…å«æ±‰å­—çš„å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªæ±‰å­—æ‹¼éŸ³é¦–å­—æ¯çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> first(<span class="keyword">String</span> S) &#123;</span><br><span class="line">        <span class="keyword">String</span> Result = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span> (S == <span class="keyword">null</span> || S.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"#"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">char</span> cs = S.charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            Result += Char2Initial(cs);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            Result = <span class="string">"%"</span>;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ------------------------privateæ–¹æ³•åŒº------------------------</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å…¥å­—ç¬¦,å¾—åˆ°ä»–çš„å£°æ¯,è‹±æ–‡å­—æ¯è¿”å›å¯¹åº”çš„å¤§å†™å­—æ¯,å…¶ä»–éç®€ä½“æ±‰å­—è¿”å› '#'ã€€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">char</span> Char2Initial(<span class="built_in">char</span> ch) &#123;</span><br><span class="line">        <span class="comment">// å¯¹è‹±æ–‡å­—æ¯çš„å¤„ç†ï¼šå°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™ï¼Œå¤§å†™çš„ç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (ch &gt;= <span class="string">'a'</span> &amp;&amp; ch &lt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="built_in">char</span>) (ch - <span class="string">'a'</span> + <span class="string">'A'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ch &gt;= <span class="string">'A'</span> &amp;&amp; ch &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯¹éè‹±æ–‡å­—æ¯çš„å¤„ç†ï¼šè½¬åŒ–ä¸ºé¦–å­—æ¯ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦åœ¨ç è¡¨èŒƒå›´å†…ï¼Œ</span></span><br><span class="line">        <span class="comment">// è‹¥ä¸æ˜¯ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">        <span class="comment">// è‹¥æ˜¯ï¼Œåˆ™åœ¨ç è¡¨å†…çš„è¿›è¡Œåˆ¤æ–­ã€‚</span></span><br><span class="line">        <span class="built_in">int</span> gb = gbValue(ch);<span class="comment">// æ±‰å­—è½¬æ¢é¦–å­—æ¯</span></span><br><span class="line">        <span class="keyword">if</span> ((gb &lt; BEGIN) || (gb &gt; END))<span class="comment">// åœ¨ç è¡¨åŒºé—´ä¹‹å‰ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'#'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­åŒ¹é…ç è¡¨åŒºé—´ï¼ŒåŒ¹é…åˆ°å°±break,åˆ¤æ–­åŒºé—´å½¢å¦‚â€œ[,)â€</span></span><br><span class="line">            <span class="keyword">if</span> ((gb &gt;= table[i]) &amp;&amp; (gb &lt; table[i + <span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (gb == END) &#123;<span class="comment">// è¡¥ä¸ŠGB2312åŒºé—´æœ€å³ç«¯</span></span><br><span class="line">            i = <span class="number">25</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> initialTable[i]; <span class="comment">// åœ¨ç è¡¨åŒºé—´ä¸­ï¼Œè¿”å›é¦–å­—æ¯</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å–å‡ºæ±‰å­—çš„ç¼–ç  cn æ±‰å­— ã€€ã€€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> gbValue(<span class="built_in">char</span> ch) &#123;<span class="comment">// å°†ä¸€ä¸ªæ±‰å­—ï¼ˆGB2312ï¼‰è½¬æ¢ä¸ºåè¿›åˆ¶è¡¨ç¤ºã€‚</span></span><br><span class="line">        <span class="keyword">String</span> <span class="built_in">str</span> = <span class="keyword">new</span> <span class="keyword">String</span>();</span><br><span class="line">        <span class="built_in">str</span> += ch;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] bytes = <span class="built_in">str</span>.getBytes(<span class="string">"GB2312"</span>);</span><br><span class="line">            <span class="keyword">if</span> (bytes.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> (bytes[<span class="number">0</span>] &lt;&lt; <span class="number">8</span> &amp; <span class="number">0xff00</span>) + (bytes[<span class="number">1</span>] &amp; <span class="number">0xff</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨æ–¹å¼ï¼š<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String <span class="keyword">first</span> = FirstCharUtil.<span class="keyword">first</span>(<span class="string">"åŠ å“‡"</span>);</span><br></pre></td></tr></table></figure></p><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><ul><li><p>åŸç†ï¼š GB2312ç¼–ç ä¸­çš„ä¸­æ–‡æ˜¯æŒ‰ç…§æ‹¼éŸ³æ’åºçš„ã€‚</p></li><li><p>æ³¨æ„ï¼šä¸€äº›ç”Ÿåƒ»çš„å­—æ— æ³•è·å¾—æ­£ç¡®çš„é¦–å­—æ¯ï¼ŒåŸå› æ˜¯è¿™äº›å­—éƒ½æ˜¯ååŠ å…¥çš„ã€‚ï¼ˆæ‰€ä»¥æœ‰äº›åå­—åœ¨é€šè®¯å½•çš„æ’åºä¸å¤ªä¸€æ ·ã€‚ï¼‰</p></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/3262738-84bc2fab75a4b5d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt="é…ä¸€å¼ å›¾"></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>æ¯”è¾ƒå¥½ç”¨çš„ç¬¬ä¸‰æ–¹åº“ï¼šæ±‰è¯­æ‹¼éŸ³åº“ã€‚<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">implementation</span> <span class="string">'com.belerweb:pinyin4j:2.5.1'</span></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ï¼š<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@NonNull</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> first(@Nullable <span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">str</span> == <span class="keyword">null</span> || <span class="built_in">str</span>.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"#"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">char</span> ch = <span class="built_in">str</span>.charAt(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch &gt;= <span class="string">'a'</span> &amp;&amp; ch &lt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">char</span>) (ch - <span class="string">'a'</span> + <span class="string">'A'</span>) + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ch &gt;= <span class="string">'A'</span> &amp;&amp; ch &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> ch + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        HanyuPinyinOutputFormat defaultFormat = <span class="keyword">new</span> HanyuPinyinOutputFormat();</span><br><span class="line">        <span class="comment">// è®¾ç½®å¤§å°å†™æ ¼å¼</span></span><br><span class="line">        defaultFormat.setCaseType(HanyuPinyinCaseType.UPPERCASE);</span><br><span class="line">        <span class="comment">// è®¾ç½®å£°è°ƒæ ¼å¼ï¼š</span></span><br><span class="line">        defaultFormat.setToneType(HanyuPinyinToneType.WITHOUT_TONE);</span><br><span class="line">        <span class="keyword">if</span> (Character.toString(ch).matches(<span class="string">"[\\u4E00-\\u9FA5]+"</span>)) &#123;</span><br><span class="line">            <span class="keyword">String</span>[] array = PinyinHelper.toHanyuPinyinStringArray(ch, defaultFormat);</span><br><span class="line">            <span class="keyword">if</span> (array != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> array[<span class="number">0</span>].charAt(<span class="number">0</span>) + <span class="string">""</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"#"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>HanyuPinyinï¼ˆæ±‰è¯­æ‹¼éŸ³ï¼‰ï¼Œå¤ªçœŸå®äº†ğŸ˜‚ğŸ¤£ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä¸­æ–‡é¦–å­—æ¯&quot;&gt;&lt;a href=&quot;#ä¸­æ–‡é¦–å­—æ¯&quot; class=&quot;headerlink&quot; title=&quot;ä¸­æ–‡é¦–å­—æ¯&quot;&gt;&lt;/a&gt;ä¸­æ–‡é¦–å­—æ¯&lt;/h2&gt;&lt;p&gt;æœ‰æ—¶å€™ï¼Œæ¯”å¦‚å¾®ä¿¡ä¸Šæ ¹æ®åå­—æ‹¼éŸ³é¦–å­—æ¯æ’åºå¹¶æ£€ç´¢ã€‚é‚£ä¹ˆç”¨Javaè·å–ä¸­æ–‡é¦–å­—æ¯æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://wzmyyj.top/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>Hexo+GitHubæ­å»ºä¸ªäººåšå®¢ç½‘ç«™</title>
    <link href="https://wzmyyj.top/2018/06/06/it_4/"/>
    <id>https://wzmyyj.top/2018/06/06/it_4/</id>
    <published>2018-06-06T08:44:28.000Z</published>
    <updated>2020-04-08T02:56:11.603Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»Šå¤©ï¼Œå¸¦å¤§å®¶åˆ©ç”¨Hexoå’ŒGitHubæ­å»ºå±äºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/3262738-1f1bcd714aa0813c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p><h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><p><strong>Hexo</strong> æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ <a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="noopener">Markdown</a>ï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆ<strong>é™æ€ç½‘é¡µ</strong>ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3262738-3ee0ba3dbdf8b14d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="HEXO"><br>ä¼ é€é—¨ï¼š<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexoå®˜ç½‘ä¸­æ–‡æ–‡æ¡£</a></p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><h4 id="1-å®‰è£…-amp-é…ç½®git"><a href="#1-å®‰è£…-amp-é…ç½®git" class="headerlink" title="1. å®‰è£…&amp;é…ç½®git"></a>1. å®‰è£…&amp;é…ç½®git</h4><ol><li><p>è®¿é—®<a href="https://link.jianshu.com?t=https%3A%2F%2Fgit-scm.com%2Fdownload%2F" target="_blank" rel="noopener">gitå®˜ç½‘</a>ï¼Œä¸‹è½½gitã€‚</p></li><li><p>åŒå‡»exeæ–‡ä»¶å®‰è£…ï¼Œä¸€è·¯nextå³å¯ã€‚</p></li><li><p>å®‰è£…å¥½gitä¹‹åï¼Œé…ç½®ç”¨æˆ·åå’Œé‚®ç®±ã€‚æ‰“å¼€git-bashï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å…¨å±€ç”¨æˆ·å</span></span><br><span class="line">git<span class="built_in"> config </span>--global user.name <span class="string">"yourname"</span></span><br><span class="line"><span class="comment"># é…ç½®å…¨å±€é‚®ç®±</span></span><br><span class="line">git<span class="built_in"> config </span>--global user.email <span class="string">"youremail@qq.com"</span></span><br></pre></td></tr></table></figure></li></ol><p>ç”¨æˆ·åå’Œé‚®ç®±åŒä½ çš„GitHubï¼ˆå¦‚æœæ²¡æœ‰ï¼Œå»<a href="https://github.com/" target="_blank" rel="noopener">GitHubå®˜ç½‘</a>æ³¨å†Œä¸€ä¸ªï¼Œæ³¨å†Œå¥½åè®°å¾—é‚®ç®±éªŒè¯æ‰èƒ½ä½¿ç”¨ã€‚ï¼‰</p><ol start="4"><li>é…ç½®sshã€‚æ‰“å¼€git-bashï¼š<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">è¾“å…¥ï¼Œå›è½¦</span></span><br><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-74fc02a4f120db42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="git-bash"></p><p>å¤åˆ¶ï¼ˆå³é”®+å¤åˆ¶ï¼Œä¸èƒ½ctrl+cï¼Œè¿™é‡Œctrl+cæ˜¯ç»“æŸå‘½ä»¤çš„æ„æ€ï¼‰å›¾ä¸­çš„<code>/c/Users/Administrator/.ssh/id_rsa</code>ï¼Œç„¶åæŠŠå®ƒç²˜è´´ï¼ˆå³é”®+ç²˜è´´ï¼‰åˆ°å†’å·åé¢ï¼Œç„¶åå›è½¦ï¼Œå›è½¦ï¼Œå›è½¦ã€‚ã€‚ã€‚ç›´åˆ°ç»“æŸï¼ˆä¸­é—´çš„å†’å·ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªä¸ç”¨ç®¡åªç®¡å›è½¦ï¼‰ã€‚</p><ol start="5"><li>githubä¸Šç”Ÿæˆssh keyï¼Œæ˜¯æœ¬åœ°Gitç»‘å®šGitHubã€‚<br>ç½‘é¡µä¸Šæ‰“å¼€github -&gt; ç‚¹å‡»å¤´åƒ -&gt; Settings -&gt; å·¦è¾¹èœå•æ‰¾åˆ° SSH and GPG keys -&gt; New SSH keyï¼ˆç»¿è‰²æŒ‰é’®ï¼‰-&gt; titleéšä¾¿å¡«ï¼ˆç”¨è‹±æ–‡ï¼‰-&gt; keyå€¼ï¼ˆæ‰“å¼€<code>/c/Users/Administrator/.ssh/id_rsa</code>æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°<code>id_rsa.pub</code>ï¼Œæ³¨æ„æ˜¯<code>pub</code>åç¼€é‚£ä¸ªæ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ï¼Œç²˜è´´åˆ°keyå€¼ã€‚ï¼‰ -&gt; ç‚¹å‡»ä¸‹é¢çš„Add SSH key -&gt; å®Œæˆã€‚</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-c00abd250a8c646b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ ssh key"></p><h4 id="2-ä¸‹è½½å®‰è£…Node-js"><a href="#2-ä¸‹è½½å®‰è£…Node-js" class="headerlink" title="2. ä¸‹è½½å®‰è£…Node.js"></a>2. ä¸‹è½½å®‰è£…Node.js</h4><ol><li><a href="https://nodejs.org/en/" target="_blank" rel="noopener">node.jsä¸‹è½½åœ°å€</a></li></ol><p><img src="http://upload-images.jianshu.io/upload_images/3262738-f6e51a1168c37de9?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Node.js"></p><ol start="2"><li>å®‰è£…æ­¥éª¤ï¼šä¸€è·¯é»˜è®¤å°±è¡Œï¼ˆå®‰è£…è·¯å¾„æ ¹æ®è‡ªå·±éœ€è¦æ›´æ”¹ï¼‰</li></ol><h2 id="å®‰è£…-amp-ä½¿ç”¨Hexo"><a href="#å®‰è£…-amp-ä½¿ç”¨Hexo" class="headerlink" title="å®‰è£…&amp;ä½¿ç”¨Hexo"></a>å®‰è£…&amp;ä½¿ç”¨Hexo</h2><ol><li><p>åœ¨Dç›˜ä¸‹ï¼ˆå…¶ä»–åœ°æ–¹ä¹Ÿå¯ä»¥ï¼‰åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼ˆå‘½åä¸ºä½ ä¸»é¡µçš„åå­—æˆ–è€…HEXOï¼Œéšä¾¿å•¦ï¼Œè¿™é‡Œä»¥åä¸ºMyBlogä¸ºä¾‹ï¼‰</p></li><li><p>æ‰“å¼€cmdå‘½ä»¤çª—å£ï¼ˆæ¡Œé¢ä»»åŠ¡æ æœ€å·¦è¾¹é‚£ä¸ªwinså›¾æ ‡-&gt; æœç´¢ -&gt; è¾“å…¥cmd ï¼Œå›è½¦ï¼‰ã€‚åˆ‡æ¢åˆ°Dç›˜ï¼šï¼ˆè¾“å…¥ï¼Œå›è½¦ï¼‰<code>D:</code> -&gt; åˆ‡æ¢åˆ°åˆšæ‰å»ºçš„ç©ºæ–‡ä»¶å¤¹ï¼šï¼ˆè¾“å…¥ï¼Œå›è½¦ï¼‰<code>cd MyBlog</code>ã€‚</p></li><li><p>å®‰è£…Hexo</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢å›½å†…æº</span></span><br><span class="line">npm<span class="built_in"> config </span><span class="builtin-name">set</span> <span class="attribute">registry</span>=<span class="string">"http://registry.cnpmjs.org"</span></span><br><span class="line"><span class="comment"># å®‰è£…hexo</span></span><br><span class="line">npm install -g hexo</span><br></pre></td></tr></table></figure></li></ol><p>ç­‰å¾…å®‰è£…å®Œæˆã€‚</p><ol start="4"><li>åˆå§‹åŒ–Hexoï¼š<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆå§‹åŒ–Hexo</span></span><br><span class="line">hexo init</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…å¿…è¦æ¨¡å—</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></li></ol><p>è¿™æ—¶ï¼ŒMyBlogæ–‡ä»¶å¤¹ä¸‹å°±ç”Ÿæˆäº†ä¸€äº›æ–‡ä»¶ã€‚æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š<br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ <span class="variable">_config</span>.yml</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ scaffolds</span><br><span class="line">â”œâ”€â”€ source</span><br><span class="line">|   â”œâ”€â”€ <span class="variable">_drafts</span></span><br><span class="line">|   â””â”€â”€ <span class="variable">_posts</span></span><br><span class="line">â””â”€â”€ themes</span><br></pre></td></tr></table></figure></p><p>åˆ°æ­¤åšå®¢å·²ç»é…ç½®å¥½äº†ï¼ˆè™½ç„¶æ˜¯é»˜è®¤çš„æ ·å­ï¼‰</p><ol start="4"><li>æµ‹è¯•ä¸€ä¸‹ï¼š<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">hexo g <span class="comment">// æˆ– hexo generate</span></span><br><span class="line"><span class="meta"># æœ¬åœ°æµ‹è¯•</span></span><br><span class="line">hexo s <span class="comment">// æˆ– hexo server</span></span><br></pre></td></tr></table></figure></li></ol><p>ç„¶åæµè§ˆå™¨ä¸ŠæŸ¥çœ‹ <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a></p><p>æ˜¯ä¸æ˜¯å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç®€å•çš„ç½‘é¡µï¼ˆå¦‚æœä¸èƒ½ï¼Œæœ‰å¯èƒ½æ˜¯4000ç«¯å£è¢«åˆ«çš„ç¨‹åºå ç”¨äº†ï¼Œè‡ªè¡Œç™¾åº¦è§£å†³æ–¹æ¡ˆï¼‰ã€‚</p><h2 id="ä¸ªæ€§åŒ–"><a href="#ä¸ªæ€§åŒ–" class="headerlink" title="ä¸ªæ€§åŒ–"></a>ä¸ªæ€§åŒ–</h2><h4 id="1-config-ymlæ–‡ä»¶"><a href="#1-config-ymlæ–‡ä»¶" class="headerlink" title="1. _config.ymlæ–‡ä»¶"></a>1. _config.ymlæ–‡ä»¶</h4><p>æ‰“å¼€è¯¥ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ã€‚ï¼ˆç”¨ä»€ä¹ˆè½¯ä»¶æ‰“å¼€ï¼Ÿä½ å¯ä»¥ç”¨editplusæˆ–è€…vs ç­‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨è®°äº‹æœ¬ï¼Œå°±æ˜¯æ¯”è¾ƒéš¾çœ‹ï¼Œå»ºè®®ä¸‹ä¸ªeditpluså§ã€‚ï¼‰</p><p>ä¿®æ”¹æˆä½ æƒ³è¦çš„å†…å®¹ã€‚<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: http://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">æ¢æˆä½ çš„ä¸»é¡µæ ‡é¢˜</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">ä¸»é¡µå‰¯æ ‡é¢˜</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">ä¸»é¡µä»‹ç»çš„ä¸€å¥è¯</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">ä½ çš„åå­—</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span> <span class="comment">#è¯­è¨€</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span> <span class="comment">#æ—¶åŒº</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, </span></span><br><span class="line"><span class="comment">##set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="attr">http://voidking.com</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  line_number:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  auto_detect:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  tab_replace:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="attr">HH:mm:ss</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line"><span class="attr">  per_page:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">archive_generator:</span></span><br><span class="line"><span class="attr">  per_page:</span> <span class="number">500</span></span><br><span class="line"><span class="attr">  yearly:</span> <span class="literal">true</span>  </span><br><span class="line"><span class="attr">  monthly:</span> <span class="literal">true</span> </span><br><span class="line"></span><br><span class="line"><span class="attr">tag_generator:</span></span><br><span class="line"><span class="attr">  per_page:</span> <span class="number">100</span> </span><br><span class="line"></span><br><span class="line"><span class="attr">category_generator:</span> </span><br><span class="line"><span class="attr">  per_page:</span> <span class="number">100</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: http://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: http://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">ä½ ç”¨çš„ä¸»é¢˜æ–‡ä»¶å¤¹åå­—</span> <span class="comment"># themesä¸‹çš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: http://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">GitHubä»“åº“åœ°å€</span></span><br><span class="line"><span class="attr">    branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></p><h4 id="2-ä¿®æ”¹ä¸»é¢˜"><a href="#2-ä¿®æ”¹ä¸»é¢˜" class="headerlink" title="2. ä¿®æ”¹ä¸»é¢˜"></a>2. ä¿®æ”¹ä¸»é¢˜</h4><p>åœ¨<a href="https://hexo.io/themes/" target="_blank" rel="noopener">hexoå®˜ç½‘ä¸»é¢˜</a>ä¸­æ‰¾ä¸€ä¸ªå–œæ¬¢çš„ä¸»é¢˜ã€‚</p><blockquote><p>æ‰¾åˆ°åï¼Œä¸€èˆ¬éƒ½æœ‰ä»‹ç»æ€ä¹ˆä½¿ç”¨è¯¥ä¸»é¢˜çš„æ–‡ç« ï¼Œå¦‚æœæ²¡æœ‰ï¼ŒæŠŠç½‘é¡µæ‹‰åˆ°æœ€ä¸‹é¢ã€‚çœ‹åˆ°ï¼š2018 | Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath" target="_blank" rel="noopener">Aath</a><br>ç‚¹å‡»Theme by åé¢çš„è¿æ¥ï¼Œä¸€èˆ¬ä¼šç®€ä»‹åˆ°æœ¬ä¸»é¢˜åœ¨GitHubä¸Šçš„ä»“åº“åœ°å€ã€‚</p></blockquote><p>æ ¹æ®è¯´æ˜ï¼Œä¸‹è½½é…ç½®ä¸»é¢˜ã€‚</p><ol><li>ä¸‹è½½ä¸»é¢˜ã€‚æ¯”å¦‚ï¼š<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°MyBlogæ–‡ä»¶ä¸‹ï¼Œcmdæ‰§è¡Œ</span></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">-b</span> <span class="keyword">master</span> <span class="title">https</span>://github.com/lewis-geek/hexo-theme-Aath.git themes/aath</span><br></pre></td></tr></table></figure></li></ol><p>ä¸€èˆ¬ï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½åˆ°themesæ–‡ä»¶å¤¹ä¸‹ã€‚</p><ol start="2"><li><p>è·Ÿæ¢åšå®¢çš„ä¸»é¢˜ï¼š<br>ä¸‹è½½å¥½åï¼Œä½ åœ¨_config.ymlï¼ˆä¸»é¢˜æ˜¯MyBlogæ–‡ä»¶å¤¹ä¸‹çš„ï¼‰ä¸­çš„themeï¼šå¤„é…ç½®æˆä½ ä¸‹åœ¨çš„ä¸»é¢˜åå­—ï¼ˆå°±æ˜¯ä¸‹è½½çš„ä¸»é¢˜æ–‡ä»¶å¤¹åå­— ï¼‰</p></li><li><p>é…ç½®ä¸»é¢˜ï¼š<br>æ ¹æ®GitHubä¸Šçš„è¯´æ˜é…ç½®<code>themes/ä¸»é¢˜å</code>ç›®å½•ä¸‹çš„_config.ymlï¼ˆä¸è¦ä¸MyBlogçš„_config.ymlææ··ï¼‰ã€‚ä¸åŒä¸»é¢˜ï¼Œé…ç½®èµ·æ¥ä¸ä¸€æ ·ï¼Œæ‰€ä»¥åœ¨æ­¤ä¸è¯¦è§£äº†ã€‚</p></li></ol><h2 id="å‘å¸ƒåˆ°GitHub"><a href="#å‘å¸ƒåˆ°GitHub" class="headerlink" title="å‘å¸ƒåˆ°GitHub"></a>å‘å¸ƒåˆ°GitHub</h2><ol><li>Githubä¸Šæ–°å»ºä»“åº“ï¼š<br>æ‰“å¼€GitHubç½‘é¡µï¼Œç‚¹å‡»å¤´åƒæ—è¾¹çš„â€œ+â€å· -&gt; New repository -&gt; å¡«å†™åå­—ï¼ˆå¿…é¡»æ˜¯ï¼š<code>ä½ GitHubçš„åå­—.github.io</code>ï¼‰</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/3262738-82fb37c43746cde5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¦‚å›¾"></p><ol start="2"><li><p>æœ¬åœ°é…ç½®Gitï¼š<br>åœ¨MyBlogæ–‡ä»¶å¤¹ä¸‹çš„_config.ymlé…ç½®ï¼ˆå¤§çº¦åœ¨åº•éƒ¨ä½ç½®ï¼‰ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Deployment</span></span><br><span class="line"><span class="meta">## Docs: http:<span class="comment">//hexo.io/docs/deployment.html</span></span></span><br><span class="line"><span class="symbol">deploy:</span></span><br><span class="line"><span class="symbol">    type:</span> git</span><br><span class="line"><span class="symbol">    repository:</span> https:<span class="comment">//github.com/wzmyyj/wzmyyj.github.io.git</span></span><br><span class="line"><span class="symbol">    branch:</span> master</span><br></pre></td></tr></table></figure></li><li><p>ä¸Šä¼ ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœæƒ³æŠŠåŸæ¥çš„æ¸…é™¤</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">hexo g</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šä¼ åˆ°æäº¤æ–‡ä»¶</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>ç¬¬ä¸€æ¬¡æäº¤éœ€è¦GitHubç™»å½•è´¦å·å’Œå¯†ç ã€‚</p></blockquote><p>ä¸Šä¼ å®Œæˆåï¼Œæµè§ˆå™¨æ‰“å¼€ï¼š<code>https://ä½ çš„GitHubåå­—.github.io</code> å°±æ˜¯ä½ çš„åšå®¢ä¸»é¡µåœ°å€äº†ã€‚ï¼ˆGitHubå“åº”æ¯”è¾ƒæ…¢ï¼Œåˆšä¸Šä¼ éœ€è¦ç­‰ä¸€å°ä¼šæ‰èƒ½æ‰“å¼€æœ€æ–°çš„ã€‚ï¼‰</p><h2 id="å†™æ–‡ç« "><a href="#å†™æ–‡ç« " class="headerlink" title="å†™æ–‡ç« "></a>å†™æ–‡ç« </h2><ol><li>æ–°å»ºä¸€ç¯‡æ–‡ç« ï¼š<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># æ–°å»º</span></span><br><span class="line">hexo <span class="keyword">new</span> <span class="type">post</span> æ–‡ç« å</span><br></pre></td></tr></table></figure></li></ol><p>åœ¨<code>Myblog\source\_posts</code>ç›®å½•ä¸‹ä½ å°†çœ‹åˆ°ä¸€ä¸ªæ–°å»ºçš„<code>æ–‡ç« å.md</code>æ–‡ä»¶ã€‚</p><ol start="2"><li>ç¼–è¾‘æ–‡ç« ï¼š<br>ç”¨editplusæ‰“å¼€ç¼–è¾‘ï¼Œç”¨Markdownæ ¼å¼ä¹¦å†™ã€‚<blockquote><p>ä¿å­˜æ—¶ï¼Œè®°å¾—æŠŠç¼–ç æ–¹å¼æ”¹æˆ<code>utf-8</code>ã€‚Document -&gt; File Encoding -&gt; Convert Encodingâ€¦</p></blockquote></li></ol><p>å»ºè®®ç”¨<a href="https://www.jianshu.com/" target="_blank" rel="noopener">ç®€ä¹¦</a>å†™ï¼ˆç®€ä¹¦è®¾ç½®é‡ŒæŠŠç¼–è¾‘å™¨æ”¹æˆMarkdownï¼‰ï¼Œç„¶åå¤åˆ¶è¿‡å»ã€‚å¥½å¤„æ˜¯å›¾ç‰‡å­˜åœ¨ç®€ä¹¦ä¸Šï¼Œè®¿é—®èµ·æ¥å¿«äº›ã€‚</p><ol start="3"><li>ä¸Šä¼ ï¼šï¼ˆå’Œå‰é¢ä¸€æ ·ï¼‰<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœæƒ³æŠŠåŸæ¥çš„æ¸…é™¤</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">hexo g</span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ¬åœ°æµ‹è¯•</span></span><br><span class="line">hexo s</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šä¼ åˆ°æäº¤æ–‡ä»¶</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure></li></ol><p>åˆ°æ­¤ï¼Œä½ çš„åšå®¢ä¸»é¡µå·²ç»å®Œæˆã€‚</p><hr><h2 id="è·Ÿæ¢åŸŸå"><a href="#è·Ÿæ¢åŸŸå" class="headerlink" title="è·Ÿæ¢åŸŸå"></a>è·Ÿæ¢åŸŸå</h2><ol><li><p>è´­ä¹°ä¸€ä¸ªåŸŸåã€‚ï¼ˆé˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘ï¼Œä¸‡ç½‘å‡å¯æ³¨å†Œè´­ä¹°åŸŸåï¼‰</p></li><li><p>ä¿®æ”¹ä½ åŸŸåçš„DNSåœ°å€ä¸º <code>dns22.hichina.com</code>, <code>dns21.hichina.com</code></p></li><li><p>åŸŸåè§£æä¸Šï¼ŒCNAMEåˆ°<code>ä½ çš„GitHubåå­—.github.io</code><br><img src="https://upload-images.jianshu.io/upload_images/3262738-8c3ac04dc82dd47e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŸŸåè§£æ"></p></li><li><p>ç„¶ååœ¨ä½ çš„æœ¬åœ°ç«™ç‚¹ç›®å½•é‡Œçš„sourceç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªCNAMEæ–‡ä»¶ã€‚ä»¥æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€CNAMEï¼Œé‡Œé¢æ·»åŠ ä½ çš„åŸŸåï¼ˆä¸åŠ http://ï¼‰ã€‚</p></li><li><p>åœ¨MyBlogæ–‡ä»¶å¤¹ä¸‹çš„_config.ymlé…ç½®urlï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># URL</span><br><span class="line">## If your site is put <span class="keyword">in</span> a subdirectory, </span><br><span class="line">## set url <span class="keyword">as</span> <span class="string">'http://yoursite.com/child'</span> and root <span class="keyword">as</span> <span class="string">'/child/'</span></span><br><span class="line">url: http:<span class="comment">//wzmyyj.top   //ä½ çš„åŸŸå</span></span><br></pre></td></tr></table></figure></li><li><p>é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶å’Œä¸Šä¼ åˆ°GitHubã€‚</p></li></ol><h2 id="é™„ä»¶"><a href="#é™„ä»¶" class="headerlink" title="é™„ä»¶"></a>é™„ä»¶</h2><h4 id="1-å‚è€ƒæ–‡çŒ®ï¼š"><a href="#1-å‚è€ƒæ–‡çŒ®ï¼š" class="headerlink" title="1. å‚è€ƒæ–‡çŒ®ï¼š"></a>1. å‚è€ƒæ–‡çŒ®ï¼š</h4><p><a href="https://www.jianshu.com/p/75efaba08a34" target="_blank" rel="noopener">Hexoç¯å¢ƒæ­å»º2018å¹´5æœˆç‰ˆ</a><br><a href="https://www.jianshu.com/p/189fd945f38f" target="_blank" rel="noopener">æ­å»ºä¸ªäººåšå®¢-hexo+githubè¯¦ç»†å®Œæ•´æ­¥éª¤</a><br><a href="https://www.jianshu.com/p/834d7cc0668d" target="_blank" rel="noopener">æˆ‘çš„åšå®¢æ˜¯å¦‚ä½•æ­å»ºçš„ï¼ˆgithub pages + HEXO + åŸŸåç»‘å®šï¼‰</a><br><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexoä¸­æ–‡æ–‡æ¡£</a></p><h4 id="2-æˆ‘çš„ä¸»é¡µï¼š"><a href="#2-æˆ‘çš„ä¸»é¡µï¼š" class="headerlink" title="2. æˆ‘çš„ä¸»é¡µï¼š"></a>2. æˆ‘çš„ä¸»é¡µï¼š</h4><p> æ¬¢è¿å¤§å®¶æµè§ˆæˆ‘çš„ä¸»é¡µï¼š<a href="http://wzmyyj.top/">http://wzmyyj.top/</a></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-afbda65c187b9cd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="wzmyyjçš„ä¸»é¡µ"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ä»Šå¤©ï¼Œå¸¦å¤§å®¶åˆ©ç”¨Hexoå’ŒGitHubæ­å»ºå±äºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="IT" scheme="https://wzmyyj.top/tags/IT/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæé—®çš„æ™ºæ…§ã€‹</title>
    <link href="https://wzmyyj.top/2018/06/04/it_3/"/>
    <id>https://wzmyyj.top/2018/06/04/it_3/</id>
    <published>2018-06-04T12:08:19.000Z</published>
    <updated>2020-04-08T02:54:49.884Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æé—®çš„æ™ºæ…§"><a href="#æé—®çš„æ™ºæ…§" class="headerlink" title="æé—®çš„æ™ºæ…§"></a>æé—®çš„æ™ºæ…§</h2><p><strong>è‰¾ç‘å…‹.å²è’‚æ–‡.é›·è’™å¾·ï¼ˆEric Steven Raymondï¼‰</strong>Thyrsus Enterprises <a href="mailto:&#101;&#x73;&#x72;&#64;&#116;&#104;&#x79;&#114;&#115;&#x75;&#x73;&#x2e;&#x63;&#111;&#x6d;" target="_blank" rel="noopener">&#101;&#x73;&#x72;&#64;&#116;&#104;&#x79;&#114;&#115;&#x75;&#x73;&#x2e;&#x63;&#111;&#x6d;</a><br><strong>ç‘å…‹.è«æ©ï¼ˆRick Moenï¼‰</strong> <a href="mailto:&#114;&#101;&#x73;&#112;&#111;&#110;&#x64;&#45;&#97;&#x75;&#x74;&#x6f;&#x40;&#108;&#x69;&#x6e;&#x75;&#x78;&#109;&#97;&#x66;&#x69;&#x61;&#46;&#99;&#x6f;&#x6d;" target="_blank" rel="noopener">&#114;&#101;&#x73;&#112;&#111;&#110;&#x64;&#45;&#97;&#x75;&#x74;&#x6f;&#x40;&#108;&#x69;&#x6e;&#x75;&#x78;&#109;&#97;&#x66;&#x69;&#x61;&#46;&#99;&#x6f;&#x6d;</a><br>ç‰ˆæƒÂ©2001, 2006 Eric S. Raymond, Rick Moen<br><a id="more"></a></p><h2 id="ä¼ é€é—¨"><a href="#ä¼ é€é—¨" class="headerlink" title="ä¼ é€é—¨"></a>ä¼ é€é—¨</h2><p><a href="https://github.com/tvvocold/How-To-Ask-Questions-The-Smart-Way/blob/master/README.md" target="_blank" rel="noopener">ä¸­æ–‡ï¼šã€Šæé—®çš„æ™ºæ…§ã€‹</a>   </p><p><a href="http://www.catb.org/~esr/faqs/smart-questions.html" target="_blank" rel="noopener">åŸæ–‡ï¼šã€ŠHow To Ask Questions The Smart Wayã€‹</a></p><p>è¦æ±‚å£°æ˜ï¼šï¼ˆæˆ‘ä»¬ä¸æä¾›è¯¥é¡¹ç›®çš„æœåŠ¡æ”¯æŒï¼ï¼‰</p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-4ab43d3ebaf85698.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ä¸€å¼ å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æé—®çš„æ™ºæ…§&quot;&gt;&lt;a href=&quot;#æé—®çš„æ™ºæ…§&quot; class=&quot;headerlink&quot; title=&quot;æé—®çš„æ™ºæ…§&quot;&gt;&lt;/a&gt;æé—®çš„æ™ºæ…§&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;è‰¾ç‘å…‹.å²è’‚æ–‡.é›·è’™å¾·ï¼ˆEric Steven Raymondï¼‰&lt;/strong&gt;Thyrsus Enterprises &lt;a href=&quot;mailto:&amp;#101;&amp;#x73;&amp;#x72;&amp;#64;&amp;#116;&amp;#104;&amp;#x79;&amp;#114;&amp;#115;&amp;#x75;&amp;#x73;&amp;#x2e;&amp;#x63;&amp;#111;&amp;#x6d;&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&amp;#101;&amp;#x73;&amp;#x72;&amp;#64;&amp;#116;&amp;#104;&amp;#x79;&amp;#114;&amp;#115;&amp;#x75;&amp;#x73;&amp;#x2e;&amp;#x63;&amp;#111;&amp;#x6d;&lt;/a&gt;&lt;br&gt;&lt;strong&gt;ç‘å…‹.è«æ©ï¼ˆRick Moenï¼‰&lt;/strong&gt; &lt;a href=&quot;mailto:&amp;#114;&amp;#101;&amp;#x73;&amp;#112;&amp;#111;&amp;#110;&amp;#x64;&amp;#45;&amp;#97;&amp;#x75;&amp;#x74;&amp;#x6f;&amp;#x40;&amp;#108;&amp;#x69;&amp;#x6e;&amp;#x75;&amp;#x78;&amp;#109;&amp;#97;&amp;#x66;&amp;#x69;&amp;#x61;&amp;#46;&amp;#99;&amp;#x6f;&amp;#x6d;&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&amp;#114;&amp;#101;&amp;#x73;&amp;#112;&amp;#111;&amp;#110;&amp;#x64;&amp;#45;&amp;#97;&amp;#x75;&amp;#x74;&amp;#x6f;&amp;#x40;&amp;#108;&amp;#x69;&amp;#x6e;&amp;#x75;&amp;#x78;&amp;#109;&amp;#97;&amp;#x66;&amp;#x69;&amp;#x61;&amp;#46;&amp;#99;&amp;#x6f;&amp;#x6d;&lt;/a&gt;&lt;br&gt;ç‰ˆæƒÂ©2001, 2006 Eric S. Raymond, Rick Moen&lt;br&gt;
    
    </summary>
    
    
      <category term="IT" scheme="https://wzmyyj.top/tags/IT/"/>
    
  </entry>
  
  <entry>
    <title>ä»…ä»…æ˜¯å‡ å¼ å›¾è€Œå·²å“¦^_^</title>
    <link href="https://wzmyyj.top/2018/06/01/pic_1/"/>
    <id>https://wzmyyj.top/2018/06/01/pic_1/</id>
    <published>2018-06-01T13:20:06.000Z</published>
    <updated>2020-04-08T09:22:19.070Z</updated>
    
    <content type="html"><![CDATA[<p>ä»…ä»…æ˜¯å‡ å¼ å›¾è€Œå·²å“¦^_^ã€‚ã€‚ã€‚å•¦å•¦å•¦å•¦å•¦ã€‚ã€‚ã€‚ã€‚</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/3262738-0a5b030907019fd8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="gnnsss.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-1f1bcd714aa0813c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="mobile.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-a3c676432cc233b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="top.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-ead0b680c718d0f0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="asvj.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-a352875140dd6e56.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="timhjjjg.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-470a155a7e646aa9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="efth"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-88b2dbf8325fe9c1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="15029432"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-9fb08e3a3c7f56fb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="14965"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-5adb08044438699f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="pixi"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-3136460bca8a06e8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1467996192"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-ada962ff5b01c7a8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="12546e7.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-3cd7e10ae7b522d6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="kgy.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-ead0b680c718d0f0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="asvj.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-c0beadca93f5962e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="assdf.jpg"></p><p><img src="https://upload-images.jianshu.io/upload_images/3262738-52a9711439ee133d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="wzm.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»…ä»…æ˜¯å‡ å¼ å›¾è€Œå·²å“¦^_^ã€‚ã€‚ã€‚å•¦å•¦å•¦å•¦å•¦ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="å›¾ç‰‡" scheme="https://wzmyyj.top/tags/%E5%9B%BE%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>Androidæ—¥å¿—å·¥å…·Logç±»</title>
    <link href="https://wzmyyj.top/2018/05/22/android_1/"/>
    <id>https://wzmyyj.top/2018/05/22/android_1/</id>
    <published>2018-05-22T12:43:30.000Z</published>
    <updated>2020-07-21T02:58:13.581Z</updated>
    
    <content type="html"><![CDATA[<h2 id="android-util-Logç±»"><a href="#android-util-Logç±»" class="headerlink" title="android.util.Logç±»"></a>android.util.Logç±»</h2><p><code>android.util.Log</code>å¸¸ç”¨çš„æ–¹æ³•æœ‰ä»¥ä¸‹5ä¸ªï¼š<code>Log.v()</code>ï¼Œ <code>Log.d()</code> ï¼Œ<code>Log.i()</code> ï¼Œ<code>Log.w()</code> ä»¥åŠ <code>Log.e()</code> ã€‚æ ¹æ®é¦–å­—æ¯å¯¹åº”VERBOSEï¼ŒDEBUGï¼ŒINFOï¼Œ WARNï¼ŒERRORã€‚</p><a id="more"></a><ul><li><p><code>Log.v</code> çš„è¾“å‡ºé¢œè‰²ä¸º<strong>é»‘è‰²</strong>çš„ï¼Œä»»ä½•æ¶ˆæ¯éƒ½ä¼šè¾“å‡ºï¼Œè¿™é‡Œçš„vä»£è¡¨verboseå•°å—¦çš„æ„æ€ã€‚</p></li><li><p><code>Log.d</code>çš„è¾“å‡ºé¢œè‰²ä¸º<strong>è“è‰²</strong>çš„ï¼Œä»…è¾“å‡ºdebugè°ƒè¯•çš„æ„æ€ï¼Œä½†ä»–ä¼šè¾“å‡ºä¸Šå±‚çš„ä¿¡æ¯ï¼Œè¿‡æ»¤èµ·æ¥å¯ä»¥é€šè¿‡DDMSçš„Logcatæ ‡ç­¾æ¥é€‰æ‹©ã€‚</p></li><li><p><code>Log.i</code>çš„è¾“å‡ºé¢œè‰²ä¸º<strong>ç»¿è‰²</strong>ï¼Œä¸€èˆ¬æç¤ºæ€§çš„æ¶ˆæ¯informationï¼Œå®ƒä¸ä¼šè¾“å‡º<code>Log.v</code>å’Œ<code>Log.d</code>çš„ä¿¡æ¯ï¼Œä½†ä¼šæ˜¾ç¤º<code>i</code>ã€<code>w</code>å’Œ<code>e</code>çš„ä¿¡æ¯ã€‚</p></li><li><p><code>Log.w</code>çš„è¾“å‡ºé¢œè‰²ä¸º<strong>æ©™è‰²</strong>ï¼Œå¯ä»¥çœ‹ä½œä¸ºwarningè­¦å‘Šï¼Œä¸€èˆ¬éœ€è¦æˆ‘ä»¬æ³¨æ„ä¼˜åŒ–Androidä»£ç ï¼ŒåŒæ—¶é€‰æ‹©å®ƒåè¿˜ä¼šè¾“å‡º<code>Log.e</code>çš„ä¿¡æ¯ã€‚</p></li><li><p><code>Log.e</code>çš„è¾“å‡ºé¢œè‰²ä¸º<strong>çº¢è‰²</strong>ï¼Œå¯ä»¥æƒ³åˆ°erroré”™è¯¯ï¼Œè¿™é‡Œä»…æ˜¾ç¤ºçº¢è‰²çš„é”™è¯¯ä¿¡æ¯ï¼Œè¿™äº›é”™è¯¯å°±éœ€è¦æˆ‘ä»¬è®¤çœŸçš„åˆ†æï¼ŒæŸ¥çœ‹æ ˆçš„ä¿¡æ¯äº†ã€‚</p></li></ul><h4 id="1-å¸¸è§„ç”¨æ³•"><a href="#1-å¸¸è§„ç”¨æ³•" class="headerlink" title="1,å¸¸è§„ç”¨æ³•"></a>1,å¸¸è§„ç”¨æ³•</h4><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Log</span>.v(<span class="built_in">TAG</span>,<span class="string">"ä¸€æ¡å•°å—¦æ—¥å¿—"</span>);</span><br><span class="line"><span class="keyword">Log</span>.d(<span class="built_in">TAG</span>,<span class="string">"ä¸€æ¡è°ƒè¯•æ—¥å¿—"</span>);</span><br><span class="line"><span class="keyword">Log</span>.i(<span class="built_in">TAG</span>,<span class="string">"ä¸€æ¡æç¤ºæ—¥å¿—"</span>);</span><br><span class="line"><span class="keyword">Log</span>.w(<span class="built_in">TAG</span>,<span class="string">"ä¸€æ¡è­¦å‘Šæ—¥å¿—"</span>);</span><br><span class="line"><span class="keyword">Log</span>.e(<span class="built_in">TAG</span>,<span class="string">"ä¸€æ¡é”™è¯¯æ—¥å¿—"</span>);</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>TAG</code>ä¸ºå­—ç¬¦ä¸²ã€‚ç”¨äºæ ‡è®°ã€‚åŒä¸€ä¸ªåº”ç”¨<code>TAG</code>åŸºæœ¬å¯ä»¥æˆä¸€æ ·ã€‚å¹¶ä¸”ï¼Œåº”ç”¨æ‰“åŒ…å‘å¸ƒæ—¶ï¼Œæœ€å¥½æŠŠå…¨éƒ¨<code>Log</code>æ³¨é‡Šæ‰ï¼Œå¦åˆ™å°†äº§ç”Ÿä¸å¿…è¦çš„èµ„æºæ¶ˆè€—ï¼ˆè™½ç„¶å¾ˆå°ï¼‰ã€‚</p><h4 id="2-åˆ†è£…Log"><a href="#2-åˆ†è£…Log" class="headerlink" title="2,åˆ†è£…Log"></a>2,åˆ†è£…Log</h4><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class L &#123;</span><br><span class="line">    <span class="keyword">private</span> static <span class="built_in">String</span> <span class="built_in">TAG</span> = <span class="string">"WZM"</span>;</span><br><span class="line">    <span class="comment">// å¼€å…³</span></span><br><span class="line">    <span class="keyword">private</span> static <span class="built_in">boolean</span> debug = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> L() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> setTAG(<span class="built_in">String</span> <span class="built_in">TAG</span>) &#123;</span><br><span class="line">        L.<span class="built_in">TAG</span> = <span class="built_in">TAG</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> setDebug(<span class="built_in">boolean</span> debug) &#123;</span><br><span class="line">        L.debug = debug;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> v(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug)</span><br><span class="line">            <span class="keyword">Log</span>.v(<span class="built_in">TAG</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> d(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug)</span><br><span class="line">            <span class="keyword">Log</span>.d(<span class="built_in">TAG</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> i(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug)</span><br><span class="line">            <span class="keyword">Log</span>.i(<span class="built_in">TAG</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> w(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug)</span><br><span class="line">            <span class="keyword">Log</span>.w(<span class="built_in">TAG</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="literal">void</span> e(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug)</span><br><span class="line">            <span class="keyword">Log</span>.e(<span class="built_in">TAG</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶ï¼š<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">L.v(<span class="string">"ä¸€æ¡å•°å—¦æ—¥å¿—"</span>)<span class="comment">;</span></span><br><span class="line">L.d(<span class="string">"ä¸€æ¡è°ƒè¯•æ—¥å¿—"</span>)<span class="comment">;</span></span><br><span class="line">L.i(<span class="string">"ä¸€æ¡æç¤ºæ—¥å¿—"</span>)<span class="comment">;</span></span><br><span class="line">L.w(<span class="string">"ä¸€æ¡è­¦å‘Šæ—¥å¿—"</span>)<span class="comment">;</span></span><br><span class="line">L.e(<span class="string">"ä¸€æ¡é”™è¯¯æ—¥å¿—"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>å¹¶ä¸”ï¼Œå¯åœ¨<code>Application</code>ä¸­è®¾ç½®å¼€å…³ï¼ˆæ˜¯å¦è¾“å‡ºæ—¥å¿—ï¼‰æˆ–<code>TAG</code>ï¼ˆé»˜è®¤<code>WZM</code>ï¼‰<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        <span class="type">L</span>.setTAG(<span class="string">"TAG"</span>);</span><br><span class="line">        <span class="type">L</span>.setDebug(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰“åŒ…å‘å¸ƒæ—¶ï¼Œ<code>debug</code>è®¾ä¸º<code>false</code>å³å¯ã€‚</p><hr><p><img src="https://upload-images.jianshu.io/upload_images/3262738-76f7c9e6fdc24a2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ— å…³é…å›¾"></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>è¿˜æœ‰å¯¹<code>Toast</code>çš„ç®€å•å°è£…ï¼š<a href="https://www.jianshu.com/p/7e51a0cc6c44" target="_blank" rel="noopener">Android å°è£…Toast</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;android-util-Logç±»&quot;&gt;&lt;a href=&quot;#android-util-Logç±»&quot; class=&quot;headerlink&quot; title=&quot;android.util.Logç±»&quot;&gt;&lt;/a&gt;android.util.Logç±»&lt;/h2&gt;&lt;p&gt;&lt;code&gt;android.util.Log&lt;/code&gt;å¸¸ç”¨çš„æ–¹æ³•æœ‰ä»¥ä¸‹5ä¸ªï¼š&lt;code&gt;Log.v()&lt;/code&gt;ï¼Œ &lt;code&gt;Log.d()&lt;/code&gt; ï¼Œ&lt;code&gt;Log.i()&lt;/code&gt; ï¼Œ&lt;code&gt;Log.w()&lt;/code&gt; ä»¥åŠ &lt;code&gt;Log.e()&lt;/code&gt; ã€‚æ ¹æ®é¦–å­—æ¯å¯¹åº”VERBOSEï¼ŒDEBUGï¼ŒINFOï¼Œ WARNï¼ŒERRORã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="android" scheme="https://wzmyyj.top/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘æŠ½è±¡å·¥å‚æ¨¡å¼</title>
    <link href="https://wzmyyj.top/2018/05/19/design_4/"/>
    <id>https://wzmyyj.top/2018/05/19/design_4/</id>
    <published>2018-05-19T09:50:00.000Z</published>
    <updated>2020-04-08T07:18:41.423Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h2><p> <strong>æŠ½è±¡å·¥å‚æ¨¡å¼</strong>ï¼ˆAbstract Factory Patternï¼‰æ˜¯æ‰€æœ‰å½¢æ€çš„<a href="https://www.jianshu.com/p/539975502ad1" target="_blank" rel="noopener">å·¥å‚æ¨¡å¼</a>ä¸­æœ€ä¸ºæŠ½è±¡å’Œæœ€å…·ä¸€èˆ¬æ€§çš„ä¸€ç§å½¢æ€ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯æŒ‡å½“æœ‰å¤šä¸ªæŠ½è±¡è§’è‰²æ—¶ï¼Œä½¿ç”¨çš„ä¸€ç§å·¥å‚æ¨¡å¼ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å‘å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œä½¿å®¢æˆ·ç«¯åœ¨ä¸å¿…æŒ‡å®šäº§å“çš„å…·ä½“çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºå¤šä¸ª<a href="https://baike.sogou.com/v10638486.htm" target="_blank" rel="noopener">äº§å“æ—</a>ä¸­çš„äº§å“å¯¹è±¡ã€‚<br><a id="more"></a></p><ul><li>å¦‚æœè¯»è€…ä¸äº†è§£<strong>å·¥å‚æ¨¡å¼</strong>ï¼Œè¯·çœ‹ä¸Šç¯‡<a href="https://www.jianshu.com/p/539975502ad1" target="_blank" rel="noopener">ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼</a>ã€‚</li></ul><h4 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h4><p><img src="https://upload-images.jianshu.io/upload_images/3262738-6c0756dcdf876de8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŠ½è±¡å·¥å‚æ¨¡å¼"></p><ol><li>æŠ½è±¡äº§å“ç±»ï¼ˆAbstractProductXï¼‰ï¼š<strong>å¤šä¸ªç³»åˆ—</strong>æŠ½è±¡äº§å“ï¼ˆX=A,B,Câ€¦ï¼‰ã€‚</li><li>å…·ä½“äº§å“ç±»ï¼ˆProductXï¼‰ï¼šå®ç°åŸºç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼ˆå¤šä¸ªä¸åŒçš„å…·ä½“äº§å“ï¼ŒX=1,2,3..ï¼‰ã€‚</li><li>æŠ½è±¡å·¥å‚ç±»æˆ–æ¥å£ï¼ˆAbstractFactoryï¼‰ï¼šå®šä¹‰å…·ä½“å·¥å‚çš„<strong>å¤šä¸ª</strong>å…¬å…±æ¥å£ï¼ˆæ‹¥æœ‰<strong>å„ç³»åˆ—</strong>äº§å“åˆ›å»ºçš„æ¥å£ï¼‰ã€‚</li><li>å…·ä½“å·¥å‚ç±»ï¼ˆFactoryXï¼‰ï¼šå®šä¹‰åˆ›å»º<strong>å„ç³»åˆ—</strong>å…·ä½“äº§å“å®ä¾‹çš„æ–¹æ³•ã€‚ï¼ˆæ¯ä¸ªå·¥å‚å¯¹åº”ä¸€ç§å…·ä½“äº§å“ï¼ŒX=1,2,3â€¦ï¼‰ã€‚</li></ol><h4 id="ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«"><a href="#ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«"></a>ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«</h4><blockquote><ol><li><strong>å·¥å‚æ¨¡å¼</strong>çš„å·¥å‚åªèƒ½ç”Ÿäº§ä¸€ä¸ªç³»åˆ—çš„äº§å“ã€‚è€Œ<strong>æŠ½è±¡å·¥å‚æ¨¡å¼</strong>çš„å·¥å‚å¯ä»¥ç”Ÿäº§ä¸€ä¸ªæˆ–å¤šä¸ªç³»åˆ—çš„äº§å“ã€‚</li><li><strong>å·¥å‚æ¨¡å¼</strong>å…³æ³¨çš„æ˜¯ä¸€ä¸ªç³»åˆ—çš„ä¸åŒç§äº§å“ã€‚è€Œ<strong>æŠ½è±¡å·¥å‚æ¨¡å¼</strong>å…³æ³¨çš„æ˜¯ä¸åŒç³»åˆ—äº§å“ã€‚</li></ol></blockquote><h2 id="æ¡ˆä¾‹åˆ†æ"><a href="#æ¡ˆä¾‹åˆ†æ" class="headerlink" title="æ¡ˆä¾‹åˆ†æ"></a>æ¡ˆä¾‹åˆ†æ</h2><p>æ¥ç€ä¸Šç¯‡<a href="https://www.jianshu.com/p/539975502ad1" target="_blank" rel="noopener">ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼</a>çš„è¯é¢˜ã€‚</p><p>åœºæ™¯ï¼šç©ã€Šè‹±é›„è”ç›Ÿã€‹ï¼ˆ5v5 mobaç«¯æ¸¸ï¼‰æ–°å¼€ä¸€å±€æ¸¸æˆï¼Œæ¸¸æˆå¼€å§‹æ¯ä¸ªç©å®¶éœ€è¦é€‰ä¸€ä¸ªè‹±é›„ä¹‹å¤–ï¼Œè¿˜éœ€è¦é€‰æ‹©å¤©èµ‹ï¼Œå¬å”¤å¸ˆæŠ€èƒ½ã€‚ä¹Ÿå°±æ˜¯éœ€è¦åˆ›å»ºä¸‰ç§äº§å“ã€‚å¹¶ä¸”ï¼Œåœ¨ä¸åŒç©æ³•ä¸‹ï¼Œæ¯”å¦‚å¬å”¤å¸ˆå³¡è°·ï¼ˆè‡ªé€‰æˆ–æ’ä½ç­‰ï¼‰ä¸å“­åšæ·±æ¸Šï¼ˆå¤§ä¹±æ–—ï¼‰ï¼Œåˆ›å»ºçš„äº§å“ä¹Ÿç•¥å¾®æœ‰æ‰€å·®å¼‚ï¼Œæ¯”å¦‚å¤§ä¹±æ–—ä¸‹è‹±é›„ä¸€å¼€å§‹å°±3çº§ï¼Œå¬å”¤å¸ˆæŠ€èƒ½æ²¡æœ‰ä¼ é€ï¼Œæœ‰é›ªçƒã€‚ç»“æ„ä¸Šï¼š</p><ol><li>äº§å“ï¼ˆä¸‰ä¸ªç³»åˆ—ï¼‰ï¼šè‹±é›„ï¼Œå¤©èµ‹ï¼Œå¬å”¤å¸ˆæŠ€èƒ½ã€‚</li><li>å·¥å‚ï¼ˆä¸¤ä¸ªï¼‰ï¼šå¬å”¤å¸ˆå³¡è°·å·¥å‚ï¼Œå“­åšæ·±æ¸Šå·¥å‚ã€‚</li></ol><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><p>è‹±é›„åŸºç±»ï¼ˆæ–°å¢<code>lv</code>æˆå‘˜å˜é‡å’Œ<code>print()</code>æ–¹æ³•ï¼‰<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Hero</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> lv;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">say</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"name:"</span> + name);</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"lv:"</span> + lv);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åªè€ƒè™‘ä¸€ç§è‹±é›„ï¼Œæ¯”å¦‚å¯’å†°å°„æ‰‹-è‰¾å¸Œã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3262738-01365eddc5e014f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è‰¾å¸Œ"></p><p>è‰¾å¸Œç±»ï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Ashe</span> <span class="keyword">extends</span> <span class="title">Hero</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç®€åŒ–æ„é€ æ–¹æ³•ï¼Œåªå¼„ä¸ªåå­—ã€‚</span></span><br><span class="line">    public <span class="type">Ashe</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"å¯’å†°å°„æ‰‹-è‰¾å¸Œ"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è‰¾å¸Œå°è¯ï¼ˆä¸é‡è¦ï¼‰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void say() &#123;</span><br><span class="line">        <span class="type">System</span>.out.println(name + <span class="string">"ï¼š"</span> + <span class="string">"ä¸–é—´ä¸‡ç‰©çš†ç³»äºä¸€ç®­ä¹‹ä¸Šã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¬å”¤å¸ˆå³¡è°·ä¸­çš„è‰¾å¸Œï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Ashe_XiaGu</span> <span class="keyword">extends</span> <span class="title">Ashe</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨å¬å”¤å¸ˆå³¡è°·ä¸­åˆå§‹ç­‰çº§1çº§ã€‚</span></span><br><span class="line">    public <span class="type">Ashe_XiaGu</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.lv = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å“­åšæ·±æ¸Šä¸­çš„è‰¾å¸Œï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Ashe_ShenYuan</span> <span class="keyword">extends</span> <span class="title">Ashe</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨å“­åšæ·±æ¸Šä¸­åˆå§‹ç­‰çº§3çº§ã€‚</span></span><br><span class="line">    public <span class="type">Ashe_ShenYuan</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.lv = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¤©èµ‹åŸºç±»ï¼šï¼ˆå°±ç®€å•ç‚¹åªç”¨æ‰“å°ä¿¡æ¯åŒºåˆ†ä¸‹å¥½äº†ï¼‰<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Talent</span> &#123;</span><br><span class="line">    <span class="comment">// åªæ‰“å°ä¸€ä¸‹ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸¤ä¸ªå¤©èµ‹å®ç°ç±»ï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Talent_XiaGu</span> <span class="keyword">extends</span> <span class="title">Talent</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void print() &#123;</span><br><span class="line">        <span class="type">System</span>.out.println(<span class="string">"å¬å”¤å¸ˆå³¡è°·ä¸­çš„å¤©èµ‹"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Talent_ShenYuan</span> <span class="keyword">extends</span> <span class="title">Talent</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void print() &#123;</span><br><span class="line">        <span class="type">System</span>.out.println(<span class="string">"å“­åšæ·±æ¸Šä¸­çš„å¤©èµ‹"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¬å”¤å¸ˆæŠ€èƒ½åŸºç±»ï¼š<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Skill</span> &#123;</span><br><span class="line">    <span class="comment">// å¬å”¤å¸ˆæŠ€èƒ½ç§ç±»</span></span><br><span class="line">    <span class="keyword">protected</span> String[] skill_type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€‰æ‹©ä¸¤ç§å¬å”¤å¸ˆæŠ€èƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">choose</span>(<span class="params"><span class="keyword">int</span> i, <span class="keyword">int</span> j</span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"ä½ é€‰æ‹©äº†"</span> + skill_type[i] + <span class="string">"å’Œ"</span> + skill_type[j]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸¤ä¸ªå¬å”¤å¸ˆæŠ€èƒ½å®ç°ç±»ï¼š<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Skill_XiaGu</span> <span class="keyword">extends</span> <span class="title">Skill</span> </span>&#123;</span><br><span class="line">    public <span class="type">Skill_XiaGu</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.skill_type = <span class="keyword">new</span> <span class="type">String</span>[] &#123; <span class="string">"é—ªç°"</span>, <span class="string">"æ²»ç–—"</span>, <span class="string">"ä¼ é€"</span>, <span class="string">"å‡€åŒ–"</span>, <span class="string">"å…‰ç›¾"</span>, <span class="string">"è™›å¼±"</span>,</span><br><span class="line">                <span class="string">"æƒ©æˆ’"</span>, <span class="string">"ç–¾èµ°"</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Skill_ShenYuan</span> <span class="keyword">extends</span> <span class="title">Skill</span> </span>&#123;</span><br><span class="line">    public <span class="type">Skill_ShenYuan</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.skill_type = <span class="keyword">new</span> <span class="type">String</span>[] &#123; <span class="string">"é—ªç°"</span>, <span class="string">"æ²»ç–—"</span>, <span class="string">"é›ªçƒ"</span>, <span class="string">"å‡€åŒ–"</span>, <span class="string">"å…‰ç›¾"</span>, <span class="string">"è™›å¼±"</span>,</span><br><span class="line">                <span class="string">"å›è“"</span>, <span class="string">"ç–¾èµ°"</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡†å¤‡å·¥ä½œå®Œæ¯•ï¼Œæ¥ä¸‹æ¥å°±æ˜¯é‡ç‚¹äº†ã€‚</p><p>æŠ½è±¡å·¥å‚ç±»æˆ–æ¥å£ï¼š<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">AbstractFactory</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºè‹±é›„</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Hero <span class="title">createHero</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="comment">//åˆ›å»ºå¤©èµ‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Talent <span class="title">createTalent</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="comment">//åˆ›å»ºå¬å”¤å¸ˆæŠ€èƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Skill <span class="title">createSkill</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¬å”¤å¸ˆå³¡è°·å·¥å‚ç±»ï¼š<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory_XiaGu</span> <span class="keyword"><span class="keyword">implements</span> <span class="type">AbstractFactory</span></span> </span>&#123;</span><br><span class="line">    <span class="comment">//å‡è®¾æˆ‘é€‰è‰¾å¸Œ</span></span><br><span class="line">    <span class="keyword">public</span> Hero createHero() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Ashe_XiaGu</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Talent createTalent() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Talent_XiaGu</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Skill createSkill() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Skill_XiaGu</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å“­åšæ·±æ¸Šå·¥å‚ç±»ï¼š<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory_ShenYuan</span> <span class="keyword"><span class="keyword">implements</span> <span class="type">AbstractFactory</span></span> </span>&#123;</span><br><span class="line">    <span class="comment">//å‡è®¾æˆ‘é€‰è‰¾å¸Œ</span></span><br><span class="line">    <span class="keyword">public</span> Hero createHero() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Ashe_ShenYuan</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Talent createTalent() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Talent_ShenYuan</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Skill createSkill() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">Skill_ShenYuan</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åæ˜¯å®¢æˆ·ç«¯ä»£ç ï¼š<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">        System.out.println(<span class="string">"è¯·é€‰æ‹©æ¸¸æˆæ¨¡å¼"</span>);</span><br><span class="line">        System.out.println(<span class="string">"1,å¬å”¤å¸ˆå³¡è°·   2,å“­åšæ·±æ¸Š"</span>);</span><br><span class="line">        Scanner can = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">        <span class="built_in">int</span> w = can.nextInt();</span><br><span class="line">        can.close();</span><br><span class="line">        AbstractFactory <span class="keyword">factory</span> = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (w) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="comment">// å¬å”¤å¸ˆå³¡è°·</span></span><br><span class="line">            <span class="keyword">factory</span> = <span class="keyword">new</span> Factory_XiaGu();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="comment">// å“­åšæ·±æ¸Š</span></span><br><span class="line">            <span class="keyword">factory</span> = <span class="keyword">new</span> Factory_ShenYuan();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è‹±é›„ï¼ˆé€‰æ‹©çš„æ˜¯è‰¾å¸Œï¼‰</span></span><br><span class="line">        Hero hero = <span class="keyword">factory</span>.createHero();</span><br><span class="line">        hero.<span class="built_in">print</span>();</span><br><span class="line">        hero.say();</span><br><span class="line">        <span class="comment">// å¤©èµ‹</span></span><br><span class="line">        Talent talent = <span class="keyword">factory</span>.createTalent();</span><br><span class="line">        talent.<span class="built_in">print</span>();</span><br><span class="line">        <span class="comment">// å¬å”¤å¸ˆæŠ€èƒ½</span></span><br><span class="line">        Skill skill = <span class="keyword">factory</span>.createSkill();</span><br><span class="line">        skill.choose(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®¢æˆ·ç«¯é€‰æ‹©æ¸¸æˆæ¨¡å¼ï¼Œå°±ç›¸å½“äºé€‰æ‹©äº†ä¸åŒçš„å·¥å‚å»ç”Ÿäº§æ¸¸æˆå…ƒç´ ï¼ˆè‹±é›„ï¼Œå¤©èµ‹ï¼Œå¬å”¤å¸ˆæŠ€èƒ½ï¼‰ã€‚</p><p>ä¹Ÿå¯ä»¥ç»“åˆ<strong>å·¥å‚æ¨¡å¼</strong>ä½¿ç”¨ï¼Œæ¯”å¦‚é€‰æ‹©æ¸¸æˆç±»å‹åï¼Œåˆ©ç”¨å·¥å‚æ¨¡å¼é€‰æ‹©è‹±é›„ç­‰ç­‰ã€‚</p><blockquote><p>åŒ<strong>å·¥å‚æ¨¡å¼</strong>ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“äº§å“çš„åˆ›å»ºè¿‡ç¨‹ã€‚å¹¶ä¸”ï¼Œå®¢æˆ·ç«¯åªéœ€è¦é€‰æ‹©æ¸¸æˆæ¨¡å¼ï¼Œå°±å¯ä»¥ç”¨å·¥å‚åˆ›å»ºå¤šä¸ªç³»åˆ—çš„äº§å“ï¼ˆè‹±é›„ï¼Œå¤©èµ‹ï¼Œå¬å”¤å¸ˆæŠ€èƒ½ï¼‰ã€‚ä¸»è¦ç‰¹ç‚¹å°±æ˜¯ä¸€ä¸ªå·¥å‚å¤šç³»åˆ—äº§å“ã€‚</p></blockquote><h4 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h4><p>ç©å±€åŒ¹é…ï¼Œé€‰å¬å”¤å¸ˆå³¡è°·ï¼š<br><img src="https://upload-images.jianshu.io/upload_images/3262738-a2e4762e21f5fcd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ§åˆ¶å°"></p><p>æºè®¡åˆ’çš®è‚¤çš„å¯’å†°å°„æ‰‹ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3262738-9a32cb36ad0073ab.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æºè®¡åˆ’-è‰¾å¸Œ"></p><h2 id="å®é™…åº”ç”¨"><a href="#å®é™…åº”ç”¨" class="headerlink" title="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨</h2><p>å¸¸è§çš„æ¡ˆä¾‹å°±æ˜¯ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“ï¼Œæ•°æ®åº“èƒ½å¤„ç†ç”¨æˆ·ï¼Œä¹Ÿèƒ½å¤„ç†å…³ç³»ã€‚ä½†æ˜¯ï¼Œæ•°æ®åº“åˆ†MySQLï¼ŒOricalç­‰ã€‚å¤„ç†åŒæ ·æˆ–ç±»ä¼¼çš„äº‹æƒ…ï¼Œä»–ä»¬çš„å…·ä½“å®ç°å­˜åœ¨å·®å¼‚ã€‚é‚£å°±å¯ä»¥æŠ½å‡ºä¸€ä¸ªå·¥å‚åŸºç±»ï¼Œå†åˆ†åˆ«å†™ä¸¤ä¸ªä¸åŒçš„å·¥å‚å»å¤„ç†ã€‚è¿™æ ·çš„è¯ï¼ŒæŸäº›ä¸œè¥¿å°±å¯ä»¥åšåˆ°<strong>å¯è¿ç§»</strong>çš„ç›®çš„ã€‚</p><h2 id="é™„ä»¶"><a href="#é™„ä»¶" class="headerlink" title="é™„ä»¶"></a>é™„ä»¶</h2><p>è®¾è®¡æ¨¡å¼Demo<br>GitHubæºç ï¼š<a href="https://github.com/wzmyyj/Design-Pattern" target="_blank" rel="noopener">https://github.com/wzmyyj/Design-Pattern</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å·¥å‚æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å·¥å‚æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å·¥å‚æ¨¡å¼&quot;&gt;&lt;/a&gt;å·¥å‚æ¨¡å¼&lt;/h2&gt;&lt;p&gt; &lt;strong&gt;æŠ½è±¡å·¥å‚æ¨¡å¼&lt;/strong&gt;ï¼ˆAbstract Factory Patternï¼‰æ˜¯æ‰€æœ‰å½¢æ€çš„&lt;a href=&quot;https://www.jianshu.com/p/539975502ad1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å·¥å‚æ¨¡å¼&lt;/a&gt;ä¸­æœ€ä¸ºæŠ½è±¡å’Œæœ€å…·ä¸€èˆ¬æ€§çš„ä¸€ç§å½¢æ€ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯æŒ‡å½“æœ‰å¤šä¸ªæŠ½è±¡è§’è‰²æ—¶ï¼Œä½¿ç”¨çš„ä¸€ç§å·¥å‚æ¨¡å¼ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å‘å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œä½¿å®¢æˆ·ç«¯åœ¨ä¸å¿…æŒ‡å®šäº§å“çš„å…·ä½“çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºå¤šä¸ª&lt;a href=&quot;https://baike.sogou.com/v10638486.htm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;äº§å“æ—&lt;/a&gt;ä¸­çš„äº§å“å¯¹è±¡ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://wzmyyj.top/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
</feed>
